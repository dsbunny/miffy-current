{"version":3,"file":"brightsign.bundle.js","sources":["../node_modules/@lit/reactive-element/src/decorators/custom-element.ts","../node_modules/@lit/reactive-element/src/css-tag.ts","../node_modules/@lit/reactive-element/src/reactive-element.ts","../node_modules/@lit/reactive-element/src/decorators/property.ts","../node_modules/@lit/reactive-element/src/decorators/base.ts","../node_modules/@lit/reactive-element/src/decorators/query.ts","../node_modules/comlink/src/comlink.ts","../node_modules/@ungap/event-target/esm/index.js","../src/lib/null-renderer.ts","../node_modules/@dsbunny/app/src/app-manifest.ts","../src/lib/htmlimageelement-decode-polyfill.ts","../src/lib/web-media.ts","../src/lib/web-renderer-asset.ts","../src/lib/web-renderer.ts","../node_modules/@dsbunny/rtcmesh/src/rtcmesh.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/utils/int.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/utils/utf8.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/ExtData.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/DecodeError.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/timestamp.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/ExtensionCodec.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/utils/typedArrays.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/Encoder.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/encode.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/utils/prettyByte.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/CachedKeyDecoder.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/Decoder.ts","../node_modules/@dsbunny/raft/node_modules/@msgpack/msgpack/src/decode.ts","../node_modules/@dsbunny/raft/raft.js","../src/lib/raft-cluster.ts","../src/lib/service-worker-prefetch.ts","../node_modules/requestidlecallback-polyfill/index.js","../src/elements/web-play-list.ts","../src/lib/brightsign-prefetch.ts","../src/elements/brightsign-play-list.ts","../src/lib/shader.ts","../src/lib/three-media.ts","../src/lib/webgl-renderer-asset.ts","../src/lib/webgl-renderer.ts","../src/elements/webgl-play-list.ts","../src/elements/brightsign-webgl-play-list.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport type {Constructor} from './base.js';\n\n/**\n * Allow for custom element classes with private constructors\n */\ntype CustomElementClass = Omit<typeof HTMLElement, 'new'>;\n\nexport type CustomElementDecorator = {\n  // legacy\n  (cls: CustomElementClass): void;\n\n  // standard\n  (\n    target: CustomElementClass,\n    context: ClassDecoratorContext<Constructor<HTMLElement>>\n  ): void;\n};\n\n/**\n * Class decorator factory that defines the decorated class as a custom element.\n *\n * ```js\n * @customElement('my-element')\n * class MyElement extends LitElement {\n *   render() {\n *     return html``;\n *   }\n * }\n * ```\n * @category Decorator\n * @param tagName The tag name of the custom element to define.\n */\nexport const customElement =\n  (tagName: string): CustomElementDecorator =>\n  (\n    classOrTarget: CustomElementClass | Constructor<HTMLElement>,\n    context?: ClassDecoratorContext<Constructor<HTMLElement>>\n  ) => {\n    if (context !== undefined) {\n      context.addInitializer(() => {\n        customElements.define(\n          tagName,\n          classOrTarget as CustomElementConstructor\n        );\n      });\n    } else {\n      customElements.define(tagName, classOrTarget as CustomElementConstructor);\n    }\n  };\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nconst NODE_MODE = false;\n\n// Allows minifiers to rename references to globalThis\nconst global = globalThis;\n\n/**\n * Whether the current browser supports `adoptedStyleSheets`.\n */\nexport const supportsAdoptingStyleSheets: boolean =\n  global.ShadowRoot &&\n  (global.ShadyCSS === undefined || global.ShadyCSS.nativeShadow) &&\n  'adoptedStyleSheets' in Document.prototype &&\n  'replace' in CSSStyleSheet.prototype;\n\n/**\n * A CSSResult or native CSSStyleSheet.\n *\n * In browsers that support constructible CSS style sheets, CSSStyleSheet\n * object can be used for styling along side CSSResult from the `css`\n * template tag.\n */\nexport type CSSResultOrNative = CSSResult | CSSStyleSheet;\n\nexport type CSSResultArray = Array<CSSResultOrNative | CSSResultArray>;\n\n/**\n * A single CSSResult, CSSStyleSheet, or an array or nested arrays of those.\n */\nexport type CSSResultGroup = CSSResultOrNative | CSSResultArray;\n\nconst constructionToken = Symbol();\n\nconst cssTagCache = new WeakMap<TemplateStringsArray, CSSStyleSheet>();\n\n/**\n * A container for a string of CSS text, that may be used to create a CSSStyleSheet.\n *\n * CSSResult is the return value of `css`-tagged template literals and\n * `unsafeCSS()`. In order to ensure that CSSResults are only created via the\n * `css` tag and `unsafeCSS()`, CSSResult cannot be constructed directly.\n */\nexport class CSSResult {\n  // This property needs to remain unminified.\n  ['_$cssResult$'] = true;\n  readonly cssText: string;\n  private _styleSheet?: CSSStyleSheet;\n  private _strings: TemplateStringsArray | undefined;\n\n  private constructor(\n    cssText: string,\n    strings: TemplateStringsArray | undefined,\n    safeToken: symbol\n  ) {\n    if (safeToken !== constructionToken) {\n      throw new Error(\n        'CSSResult is not constructable. Use `unsafeCSS` or `css` instead.'\n      );\n    }\n    this.cssText = cssText;\n    this._strings = strings;\n  }\n\n  // This is a getter so that it's lazy. In practice, this means stylesheets\n  // are not created until the first element instance is made.\n  get styleSheet(): CSSStyleSheet | undefined {\n    // If `supportsAdoptingStyleSheets` is true then we assume CSSStyleSheet is\n    // constructable.\n    let styleSheet = this._styleSheet;\n    const strings = this._strings;\n    if (supportsAdoptingStyleSheets && styleSheet === undefined) {\n      const cacheable = strings !== undefined && strings.length === 1;\n      if (cacheable) {\n        styleSheet = cssTagCache.get(strings);\n      }\n      if (styleSheet === undefined) {\n        (this._styleSheet = styleSheet = new CSSStyleSheet()).replaceSync(\n          this.cssText\n        );\n        if (cacheable) {\n          cssTagCache.set(strings, styleSheet);\n        }\n      }\n    }\n    return styleSheet;\n  }\n\n  toString(): string {\n    return this.cssText;\n  }\n}\n\ntype ConstructableCSSResult = CSSResult & {\n  new (\n    cssText: string,\n    strings: TemplateStringsArray | undefined,\n    safeToken: symbol\n  ): CSSResult;\n};\n\nconst textFromCSSResult = (value: CSSResultGroup | number) => {\n  // This property needs to remain unminified.\n  if ((value as CSSResult)['_$cssResult$'] === true) {\n    return (value as CSSResult).cssText;\n  } else if (typeof value === 'number') {\n    return value;\n  } else {\n    throw new Error(\n      `Value passed to 'css' function must be a 'css' function result: ` +\n        `${value}. Use 'unsafeCSS' to pass non-literal values, but take care ` +\n        `to ensure page security.`\n    );\n  }\n};\n\n/**\n * Wrap a value for interpolation in a {@linkcode css} tagged template literal.\n *\n * This is unsafe because untrusted CSS text can be used to phone home\n * or exfiltrate data to an attacker controlled site. Take care to only use\n * this with trusted input.\n */\nexport const unsafeCSS = (value: unknown) =>\n  new (CSSResult as ConstructableCSSResult)(\n    typeof value === 'string' ? value : String(value),\n    undefined,\n    constructionToken\n  );\n\n/**\n * A template literal tag which can be used with LitElement's\n * {@linkcode LitElement.styles} property to set element styles.\n *\n * For security reasons, only literal string values and number may be used in\n * embedded expressions. To incorporate non-literal values {@linkcode unsafeCSS}\n * may be used inside an expression.\n */\nexport const css = (\n  strings: TemplateStringsArray,\n  ...values: (CSSResultGroup | number)[]\n): CSSResult => {\n  const cssText =\n    strings.length === 1\n      ? strings[0]\n      : values.reduce(\n          (acc, v, idx) => acc + textFromCSSResult(v) + strings[idx + 1],\n          strings[0]\n        );\n  return new (CSSResult as ConstructableCSSResult)(\n    cssText,\n    strings,\n    constructionToken\n  );\n};\n\n/**\n * Applies the given styles to a `shadowRoot`. When Shadow DOM is\n * available but `adoptedStyleSheets` is not, styles are appended to the\n * `shadowRoot` to [mimic the native feature](https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot/adoptedStyleSheets).\n * Note, when shimming is used, any styles that are subsequently placed into\n * the shadowRoot should be placed *before* any shimmed adopted styles. This\n * will match spec behavior that gives adopted sheets precedence over styles in\n * shadowRoot.\n */\nexport const adoptStyles = (\n  renderRoot: ShadowRoot,\n  styles: Array<CSSResultOrNative>\n) => {\n  if (supportsAdoptingStyleSheets) {\n    (renderRoot as ShadowRoot).adoptedStyleSheets = styles.map((s) =>\n      s instanceof CSSStyleSheet ? s : s.styleSheet!\n    );\n  } else {\n    for (const s of styles) {\n      const style = document.createElement('style');\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const nonce = (global as any)['litNonce'];\n      if (nonce !== undefined) {\n        style.setAttribute('nonce', nonce);\n      }\n      style.textContent = (s as CSSResult).cssText;\n      renderRoot.appendChild(style);\n    }\n  }\n};\n\nconst cssResultFromStyleSheet = (sheet: CSSStyleSheet) => {\n  let cssText = '';\n  for (const rule of sheet.cssRules) {\n    cssText += rule.cssText;\n  }\n  return unsafeCSS(cssText);\n};\n\nexport const getCompatibleStyle =\n  supportsAdoptingStyleSheets ||\n  (NODE_MODE && global.CSSStyleSheet === undefined)\n    ? (s: CSSResultOrNative) => s\n    : (s: CSSResultOrNative) =>\n        s instanceof CSSStyleSheet ? cssResultFromStyleSheet(s) : s;\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * Use this module if you want to create your own base class extending\n * {@link ReactiveElement}.\n * @packageDocumentation\n */\n\nimport {\n  getCompatibleStyle,\n  adoptStyles,\n  CSSResultGroup,\n  CSSResultOrNative,\n} from './css-tag.js';\nimport type {\n  ReactiveController,\n  ReactiveControllerHost,\n} from './reactive-controller.js';\n\n// In the Node build, this import will be injected by Rollup:\n// import {HTMLElement, customElements} from '@lit-labs/ssr-dom-shim';\n\nexport * from './css-tag.js';\nexport type {\n  ReactiveController,\n  ReactiveControllerHost,\n} from './reactive-controller.js';\n\n/**\n * Removes the `readonly` modifier from properties in the union K.\n *\n * This is a safer way to cast a value to a type with a mutable version of a\n * readonly field, than casting to an interface with the field re-declared\n * because it preserves the type of all the fields and warns on typos.\n */\ntype Mutable<T, K extends keyof T> = Omit<T, K> & {\n  -readonly [P in keyof Pick<T, K>]: P extends K ? T[P] : never;\n};\n\n// TODO (justinfagnani): Add `hasOwn` here when we ship ES2022\nconst {\n  is,\n  defineProperty,\n  getOwnPropertyDescriptor,\n  getOwnPropertyNames,\n  getOwnPropertySymbols,\n  getPrototypeOf,\n} = Object;\n\nconst NODE_MODE = false;\n\n// Lets a minifier replace globalThis references with a minified name\nconst global = globalThis;\n\nif (NODE_MODE) {\n  global.customElements ??= customElements;\n}\n\nconst DEV_MODE = true;\n\nlet issueWarning: (code: string, warning: string) => void;\n\nconst trustedTypes = (global as unknown as {trustedTypes?: {emptyScript: ''}})\n  .trustedTypes;\n\n// Temporary workaround for https://crbug.com/993268\n// Currently, any attribute starting with \"on\" is considered to be a\n// TrustedScript source. Such boolean attributes must be set to the equivalent\n// trusted emptyScript value.\nconst emptyStringForBooleanAttribute = trustedTypes\n  ? (trustedTypes.emptyScript as unknown as '')\n  : '';\n\nconst polyfillSupport = DEV_MODE\n  ? global.reactiveElementPolyfillSupportDevMode\n  : global.reactiveElementPolyfillSupport;\n\nif (DEV_MODE) {\n  // Ensure warnings are issued only 1x, even if multiple versions of Lit\n  // are loaded.\n  global.litIssuedWarnings ??= new Set();\n\n  /**\n   * Issue a warning if we haven't already, based either on `code` or `warning`.\n   * Warnings are disabled automatically only by `warning`; disabling via `code`\n   * can be done by users.\n   */\n  issueWarning = (code: string, warning: string) => {\n    warning += ` See https://lit.dev/msg/${code} for more information.`;\n    if (\n      !global.litIssuedWarnings!.has(warning) &&\n      !global.litIssuedWarnings!.has(code)\n    ) {\n      console.warn(warning);\n      global.litIssuedWarnings!.add(warning);\n    }\n  };\n\n  queueMicrotask(() => {\n    issueWarning(\n      'dev-mode',\n      `Lit is in dev mode. Not recommended for production!`\n    );\n\n    // Issue polyfill support warning.\n    if (global.ShadyDOM?.inUse && polyfillSupport === undefined) {\n      issueWarning(\n        'polyfill-support-missing',\n        `Shadow DOM is being polyfilled via \\`ShadyDOM\\` but ` +\n          `the \\`polyfill-support\\` module has not been loaded.`\n      );\n    }\n  });\n}\n\n/**\n * Contains types that are part of the unstable debug API.\n *\n * Everything in this API is not stable and may change or be removed in the future,\n * even on patch releases.\n */\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ReactiveUnstable {\n  /**\n   * When Lit is running in dev mode and `window.emitLitDebugLogEvents` is true,\n   * we will emit 'lit-debug' events to window, with live details about the update and render\n   * lifecycle. These can be useful for writing debug tooling and visualizations.\n   *\n   * Please be aware that running with window.emitLitDebugLogEvents has performance overhead,\n   * making certain operations that are normally very cheap (like a no-op render) much slower,\n   * because we must copy data and dispatch events.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  export namespace DebugLog {\n    export type Entry = Update;\n    export interface Update {\n      kind: 'update';\n    }\n  }\n}\n\ninterface DebugLoggingWindow {\n  // Even in dev mode, we generally don't want to emit these events, as that's\n  // another level of cost, so only emit them when DEV_MODE is true _and_ when\n  // window.emitLitDebugEvents is true.\n  emitLitDebugLogEvents?: boolean;\n}\n\n/**\n * Useful for visualizing and logging insights into what the Lit template system is doing.\n *\n * Compiled out of prod mode builds.\n */\nconst debugLogEvent = DEV_MODE\n  ? (event: ReactiveUnstable.DebugLog.Entry) => {\n      const shouldEmit = (global as unknown as DebugLoggingWindow)\n        .emitLitDebugLogEvents;\n      if (!shouldEmit) {\n        return;\n      }\n      global.dispatchEvent(\n        new CustomEvent<ReactiveUnstable.DebugLog.Entry>('lit-debug', {\n          detail: event,\n        })\n      );\n    }\n  : undefined;\n\n/*\n * When using Closure Compiler, JSCompiler_renameProperty(property, object) is\n * replaced at compile time by the munged name for object[property]. We cannot\n * alias this function, so we have to use a small shim that has the same\n * behavior when not compiling.\n */\n/*@__INLINE__*/\nconst JSCompiler_renameProperty = <P extends PropertyKey>(\n  prop: P,\n  _obj: unknown\n): P => prop;\n\n/**\n * Converts property values to and from attribute values.\n */\nexport interface ComplexAttributeConverter<Type = unknown, TypeHint = unknown> {\n  /**\n   * Called to convert an attribute value to a property\n   * value.\n   */\n  fromAttribute?(value: string | null, type?: TypeHint): Type;\n\n  /**\n   * Called to convert a property value to an attribute\n   * value.\n   *\n   * It returns unknown instead of string, to be compatible with\n   * https://github.com/WICG/trusted-types (and similar efforts).\n   */\n  toAttribute?(value: Type, type?: TypeHint): unknown;\n}\n\ntype AttributeConverter<Type = unknown, TypeHint = unknown> =\n  | ComplexAttributeConverter<Type>\n  | ((value: string | null, type?: TypeHint) => Type);\n\n/**\n * Defines options for a property accessor.\n */\nexport interface PropertyDeclaration<Type = unknown, TypeHint = unknown> {\n  /**\n   * When set to `true`, indicates the property is internal private state. The\n   * property should not be set by users. When using TypeScript, this property\n   * should be marked as `private` or `protected`, and it is also a common\n   * practice to use a leading `_` in the name. The property is not added to\n   * `observedAttributes`.\n   */\n  readonly state?: boolean;\n\n  /**\n   * Indicates how and whether the property becomes an observed attribute.\n   * If the value is `false`, the property is not added to `observedAttributes`.\n   * If true or absent, the lowercased property name is observed (e.g. `fooBar`\n   * becomes `foobar`). If a string, the string value is observed (e.g\n   * `attribute: 'foo-bar'`).\n   */\n  readonly attribute?: boolean | string;\n\n  /**\n   * Indicates the type of the property. This is used only as a hint for the\n   * `converter` to determine how to convert the attribute\n   * to/from a property.\n   */\n  readonly type?: TypeHint;\n\n  /**\n   * Indicates how to convert the attribute to/from a property. If this value\n   * is a function, it is used to convert the attribute value a the property\n   * value. If it's an object, it can have keys for `fromAttribute` and\n   * `toAttribute`. If no `toAttribute` function is provided and\n   * `reflect` is set to `true`, the property value is set directly to the\n   * attribute. A default `converter` is used if none is provided; it supports\n   * `Boolean`, `String`, `Number`, `Object`, and `Array`. Note,\n   * when a property changes and the converter is used to update the attribute,\n   * the property is never updated again as a result of the attribute changing,\n   * and vice versa.\n   */\n  readonly converter?: AttributeConverter<Type, TypeHint>;\n\n  /**\n   * Indicates if the property should reflect to an attribute.\n   * If `true`, when the property is set, the attribute is set using the\n   * attribute name determined according to the rules for the `attribute`\n   * property option and the value of the property converted using the rules\n   * from the `converter` property option.\n   */\n  readonly reflect?: boolean;\n\n  /**\n   * A function that indicates if a property should be considered changed when\n   * it is set. The function should take the `newValue` and `oldValue` and\n   * return `true` if an update should be requested.\n   */\n  hasChanged?(value: Type, oldValue: Type): boolean;\n\n  /**\n   * Indicates whether an accessor will be created for this property. By\n   * default, an accessor will be generated for this property that requests an\n   * update when set. If this flag is `true`, no accessor will be created, and\n   * it will be the user's responsibility to call\n   * `this.requestUpdate(propertyName, oldValue)` to request an update when\n   * the property changes.\n   */\n  readonly noAccessor?: boolean;\n\n  /**\n   * Whether this property is wrapping accessors. This is set by `@property`\n   * to control the initial value change and reflection logic.\n   *\n   * @internal\n   */\n  wrapped?: boolean;\n\n  /**\n   * When `true`, uses the initial value of the property as the default value,\n   * which changes how attributes are handled:\n   *  - The initial value does *not* reflect, even if the `reflect` option is `true`.\n   *    Subsequent changes to the property will reflect, even if they are equal to the\n   *     default value.\n   *  - When the attribute is removed, the property is set to the default value\n   *  - The initial value will not trigger an old value in the `changedProperties` map\n   *    argument to update lifecycle methods.\n   *\n   * When set, properties must be initialized, either with a field initializer, or an\n   * assignment in the constructor. Not initializing the property may lead to\n   * improper handling of subsequent property assignments.\n   *\n   * While this behavior is opt-in, most properties that reflect to attributes should\n   * use `useDefault: true` so that their initial values do not reflect.\n   */\n  useDefault?: boolean;\n}\n\n/**\n * Map of properties to PropertyDeclaration options. For each property an\n * accessor is made, and the property is processed according to the\n * PropertyDeclaration options.\n */\nexport interface PropertyDeclarations {\n  readonly [key: string]: PropertyDeclaration;\n}\n\ntype PropertyDeclarationMap = Map<PropertyKey, PropertyDeclaration>;\n\ntype AttributeMap = Map<string, PropertyKey>;\n\n/**\n * A Map of property keys to values.\n *\n * Takes an optional type parameter T, which when specified as a non-any,\n * non-unknown type, will make the Map more strongly-typed, associating the map\n * keys with their corresponding value type on T.\n *\n * Use `PropertyValues<this>` when overriding ReactiveElement.update() and\n * other lifecycle methods in order to get stronger type-checking on keys\n * and values.\n */\n// This type is conditional so that if the parameter T is not specified, or\n// is `any`, the type will include `Map<PropertyKey, unknown>`. Since T is not\n// given in the uses of PropertyValues in this file, all uses here fallback to\n// meaning `Map<PropertyKey, unknown>`, but if a developer uses\n// `PropertyValues<this>` (or any other value for T) they will get a\n// strongly-typed Map type.\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type PropertyValues<T = any> = T extends object\n  ? PropertyValueMap<T>\n  : Map<PropertyKey, unknown>;\n\n/**\n * Do not use, instead prefer {@linkcode PropertyValues}.\n */\n// This type must be exported such that JavaScript generated by the Google\n// Closure Compiler can import a type reference.\nexport interface PropertyValueMap<T> extends Map<PropertyKey, unknown> {\n  get<K extends keyof T>(k: K): T[K] | undefined;\n  set<K extends keyof T>(key: K, value: T[K]): this;\n  has<K extends keyof T>(k: K): boolean;\n  delete<K extends keyof T>(k: K): boolean;\n}\n\nexport const defaultConverter: ComplexAttributeConverter = {\n  toAttribute(value: unknown, type?: unknown): unknown {\n    switch (type) {\n      case Boolean:\n        value = value ? emptyStringForBooleanAttribute : null;\n        break;\n      case Object:\n      case Array:\n        // if the value is `null` or `undefined` pass this through\n        // to allow removing/no change behavior.\n        value = value == null ? value : JSON.stringify(value);\n        break;\n    }\n    return value;\n  },\n\n  fromAttribute(value: string | null, type?: unknown) {\n    let fromValue: unknown = value;\n    switch (type) {\n      case Boolean:\n        fromValue = value !== null;\n        break;\n      case Number:\n        fromValue = value === null ? null : Number(value);\n        break;\n      case Object:\n      case Array:\n        // Do *not* generate exception when invalid JSON is set as elements\n        // don't normally complain on being mis-configured.\n        // TODO(sorvell): Do generate exception in *dev mode*.\n        try {\n          // Assert to adhere to Bazel's \"must type assert JSON parse\" rule.\n          fromValue = JSON.parse(value!) as unknown;\n        } catch (e) {\n          fromValue = null;\n        }\n        break;\n    }\n    return fromValue;\n  },\n};\n\nexport interface HasChanged {\n  (value: unknown, old: unknown): boolean;\n}\n\n/**\n * Change function that returns true if `value` is different from `oldValue`.\n * This method is used as the default for a property's `hasChanged` function.\n */\nexport const notEqual: HasChanged = (value: unknown, old: unknown): boolean =>\n  !is(value, old);\n\nconst defaultPropertyDeclaration: PropertyDeclaration = {\n  attribute: true,\n  type: String,\n  converter: defaultConverter,\n  reflect: false,\n  useDefault: false,\n  hasChanged: notEqual,\n};\n\n/**\n * A string representing one of the supported dev mode warning categories.\n */\nexport type WarningKind =\n  | 'change-in-update'\n  | 'migration'\n  | 'async-perform-update';\n\nexport type Initializer = (element: ReactiveElement) => void;\n\n// Temporary, until google3 is on TypeScript 5.2\ndeclare global {\n  interface SymbolConstructor {\n    readonly metadata: unique symbol;\n  }\n}\n\n// Ensure metadata is enabled. TypeScript does not polyfill\n// Symbol.metadata, so we must ensure that it exists.\n(Symbol as {metadata: symbol}).metadata ??= Symbol('metadata');\n\ndeclare global {\n  // This is public global API, do not change!\n  // eslint-disable-next-line no-var\n  var litPropertyMetadata: WeakMap<\n    object,\n    Map<PropertyKey, PropertyDeclaration>\n  >;\n}\n\n// Map from a class's metadata object to property options\n// Note that we must use nullish-coalescing assignment so that we only use one\n// map even if we load multiple version of this module.\nglobal.litPropertyMetadata ??= new WeakMap<\n  object,\n  Map<PropertyKey, PropertyDeclaration>\n>();\n\n/**\n * Base element class which manages element properties and attributes. When\n * properties change, the `update` method is asynchronously called. This method\n * should be supplied by subclasses to render updates as desired.\n * @noInheritDoc\n */\nexport abstract class ReactiveElement\n  // In the Node build, this `extends` clause will be substituted with\n  // `(globalThis.HTMLElement ?? HTMLElement)`.\n  //\n  // This way, we will first prefer any global `HTMLElement` polyfill that the\n  // user has assigned, and then fall back to the `HTMLElement` shim which has\n  // been imported (see note at the top of this file about how this import is\n  // generated by Rollup). Note that the `HTMLElement` variable has been\n  // shadowed by this import, so it no longer refers to the global.\n  extends HTMLElement\n  implements ReactiveControllerHost\n{\n  // Note: these are patched in only in DEV_MODE.\n  /**\n   * Read or set all the enabled warning categories for this class.\n   *\n   * This property is only used in development builds.\n   *\n   * @nocollapse\n   * @category dev-mode\n   */\n  static enabledWarnings?: WarningKind[];\n\n  /**\n   * Enable the given warning category for this class.\n   *\n   * This method only exists in development builds, so it should be accessed\n   * with a guard like:\n   *\n   * ```ts\n   * // Enable for all ReactiveElement subclasses\n   * ReactiveElement.enableWarning?.('migration');\n   *\n   * // Enable for only MyElement and subclasses\n   * MyElement.enableWarning?.('migration');\n   * ```\n   *\n   * @nocollapse\n   * @category dev-mode\n   */\n  static enableWarning?: (warningKind: WarningKind) => void;\n\n  /**\n   * Disable the given warning category for this class.\n   *\n   * This method only exists in development builds, so it should be accessed\n   * with a guard like:\n   *\n   * ```ts\n   * // Disable for all ReactiveElement subclasses\n   * ReactiveElement.disableWarning?.('migration');\n   *\n   * // Disable for only MyElement and subclasses\n   * MyElement.disableWarning?.('migration');\n   * ```\n   *\n   * @nocollapse\n   * @category dev-mode\n   */\n  static disableWarning?: (warningKind: WarningKind) => void;\n\n  /**\n   * Adds an initializer function to the class that is called during instance\n   * construction.\n   *\n   * This is useful for code that runs against a `ReactiveElement`\n   * subclass, such as a decorator, that needs to do work for each\n   * instance, such as setting up a `ReactiveController`.\n   *\n   * ```ts\n   * const myDecorator = (target: typeof ReactiveElement, key: string) => {\n   *   target.addInitializer((instance: ReactiveElement) => {\n   *     // This is run during construction of the element\n   *     new MyController(instance);\n   *   });\n   * }\n   * ```\n   *\n   * Decorating a field will then cause each instance to run an initializer\n   * that adds a controller:\n   *\n   * ```ts\n   * class MyElement extends LitElement {\n   *   @myDecorator foo;\n   * }\n   * ```\n   *\n   * Initializers are stored per-constructor. Adding an initializer to a\n   * subclass does not add it to a superclass. Since initializers are run in\n   * constructors, initializers will run in order of the class hierarchy,\n   * starting with superclasses and progressing to the instance's class.\n   *\n   * @nocollapse\n   */\n  static addInitializer(initializer: Initializer) {\n    this.__prepare();\n    (this._initializers ??= []).push(initializer);\n  }\n\n  static _initializers?: Initializer[];\n\n  /*\n   * Due to closure compiler ES6 compilation bugs, @nocollapse is required on\n   * all static methods and properties with initializers.  Reference:\n   * - https://github.com/google/closure-compiler/issues/1776\n   */\n\n  /**\n   * Maps attribute names to properties; for example `foobar` attribute to\n   * `fooBar` property. Created lazily on user subclasses when finalizing the\n   * class.\n   * @nocollapse\n   */\n  private static __attributeToPropertyMap: AttributeMap;\n\n  /**\n   * Marks class as having been finalized, which includes creating properties\n   * from `static properties`, but does *not* include all properties created\n   * from decorators.\n   * @nocollapse\n   */\n  protected static finalized: true | undefined;\n\n  /**\n   * Memoized list of all element properties, including any superclass\n   * properties. Created lazily on user subclasses when finalizing the class.\n   *\n   * @nocollapse\n   * @category properties\n   */\n  static elementProperties: PropertyDeclarationMap;\n\n  /**\n   * User-supplied object that maps property names to `PropertyDeclaration`\n   * objects containing options for configuring reactive properties. When\n   * a reactive property is set the element will update and render.\n   *\n   * By default properties are public fields, and as such, they should be\n   * considered as primarily settable by element users, either via attribute or\n   * the property itself.\n   *\n   * Generally, properties that are changed by the element should be private or\n   * protected fields and should use the `state: true` option. Properties\n   * marked as `state` do not reflect from the corresponding attribute\n   *\n   * However, sometimes element code does need to set a public property. This\n   * should typically only be done in response to user interaction, and an event\n   * should be fired informing the user; for example, a checkbox sets its\n   * `checked` property when clicked and fires a `changed` event. Mutating\n   * public properties should typically not be done for non-primitive (object or\n   * array) properties. In other cases when an element needs to manage state, a\n   * private property set with the `state: true` option should be used. When\n   * needed, state properties can be initialized via public properties to\n   * facilitate complex interactions.\n   * @nocollapse\n   * @category properties\n   */\n  static properties: PropertyDeclarations;\n\n  /**\n   * Memoized list of all element styles.\n   * Created lazily on user subclasses when finalizing the class.\n   * @nocollapse\n   * @category styles\n   */\n  static elementStyles: Array<CSSResultOrNative> = [];\n\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the {@linkcode css} tag function, via constructible stylesheets, or\n   * imported from native CSS module scripts.\n   *\n   * Note on Content Security Policy:\n   *\n   * Element styles are implemented with `<style>` tags when the browser doesn't\n   * support adopted StyleSheets. To use such `<style>` tags with the style-src\n   * CSP directive, the style-src value must either include 'unsafe-inline' or\n   * `nonce-<base64-value>` with `<base64-value>` replaced be a server-generated\n   * nonce.\n   *\n   * To provide a nonce to use on generated `<style>` elements, set\n   * `window.litNonce` to a server-generated nonce in your page's HTML, before\n   * loading application code:\n   *\n   * ```html\n   * <script>\n   *   // Generated and unique per request:\n   *   window.litNonce = 'a1b2c3d4';\n   * </script>\n   * ```\n   * @nocollapse\n   * @category styles\n   */\n  static styles?: CSSResultGroup;\n\n  /**\n   * Returns a list of attributes corresponding to the registered properties.\n   * @nocollapse\n   * @category attributes\n   */\n  static get observedAttributes() {\n    // Ensure we've created all properties\n    this.finalize();\n    // this.__attributeToPropertyMap is only undefined after finalize() in\n    // ReactiveElement itself. ReactiveElement.observedAttributes is only\n    // accessed with ReactiveElement as the receiver when a subclass or mixin\n    // calls super.observedAttributes\n    return (\n      this.__attributeToPropertyMap && [...this.__attributeToPropertyMap.keys()]\n    );\n  }\n\n  private __instanceProperties?: PropertyValues = undefined;\n\n  /**\n   * Creates a property accessor on the element prototype if one does not exist\n   * and stores a {@linkcode PropertyDeclaration} for the property with the\n   * given options. The property setter calls the property's `hasChanged`\n   * property option or uses a strict identity check to determine whether or not\n   * to request an update.\n   *\n   * This method may be overridden to customize properties; however,\n   * when doing so, it's important to call `super.createProperty` to ensure\n   * the property is setup correctly. This method calls\n   * `getPropertyDescriptor` internally to get a descriptor to install.\n   * To customize what properties do when they are get or set, override\n   * `getPropertyDescriptor`. To customize the options for a property,\n   * implement `createProperty` like this:\n   *\n   * ```ts\n   * static createProperty(name, options) {\n   *   options = Object.assign(options, {myOption: true});\n   *   super.createProperty(name, options);\n   * }\n   * ```\n   *\n   * @nocollapse\n   * @category properties\n   */\n  static createProperty(\n    name: PropertyKey,\n    options: PropertyDeclaration = defaultPropertyDeclaration\n  ) {\n    // If this is a state property, force the attribute to false.\n    if (options.state) {\n      (options as Mutable<PropertyDeclaration, 'attribute'>).attribute = false;\n    }\n    this.__prepare();\n    // Whether this property is wrapping accessors.\n    // Helps control the initial value change and reflection logic.\n    if (this.prototype.hasOwnProperty(name)) {\n      options = Object.create(options);\n      options.wrapped = true;\n    }\n    this.elementProperties.set(name, options);\n    if (!options.noAccessor) {\n      const key = DEV_MODE\n        ? // Use Symbol.for in dev mode to make it easier to maintain state\n          // when doing HMR.\n          Symbol.for(`${String(name)} (@property() cache)`)\n        : Symbol();\n      const descriptor = this.getPropertyDescriptor(name, key, options);\n      if (descriptor !== undefined) {\n        defineProperty(this.prototype, name, descriptor);\n      }\n    }\n  }\n\n  /**\n   * Returns a property descriptor to be defined on the given named property.\n   * If no descriptor is returned, the property will not become an accessor.\n   * For example,\n   *\n   * ```ts\n   * class MyElement extends LitElement {\n   *   static getPropertyDescriptor(name, key, options) {\n   *     const defaultDescriptor =\n   *         super.getPropertyDescriptor(name, key, options);\n   *     const setter = defaultDescriptor.set;\n   *     return {\n   *       get: defaultDescriptor.get,\n   *       set(value) {\n   *         setter.call(this, value);\n   *         // custom action.\n   *       },\n   *       configurable: true,\n   *       enumerable: true\n   *     }\n   *   }\n   * }\n   * ```\n   *\n   * @nocollapse\n   * @category properties\n   */\n  protected static getPropertyDescriptor(\n    name: PropertyKey,\n    key: string | symbol,\n    options: PropertyDeclaration\n  ): PropertyDescriptor | undefined {\n    const {get, set} = getOwnPropertyDescriptor(this.prototype, name) ?? {\n      get(this: ReactiveElement) {\n        return this[key as keyof typeof this];\n      },\n      set(this: ReactiveElement, v: unknown) {\n        (this as unknown as Record<string | symbol, unknown>)[key] = v;\n      },\n    };\n    if (DEV_MODE && get == null) {\n      if ('value' in (getOwnPropertyDescriptor(this.prototype, name) ?? {})) {\n        throw new Error(\n          `Field ${JSON.stringify(String(name))} on ` +\n            `${this.name} was declared as a reactive property ` +\n            `but it's actually declared as a value on the prototype. ` +\n            `Usually this is due to using @property or @state on a method.`\n        );\n      }\n      issueWarning(\n        'reactive-property-without-getter',\n        `Field ${JSON.stringify(String(name))} on ` +\n          `${this.name} was declared as a reactive property ` +\n          `but it does not have a getter. This will be an error in a ` +\n          `future version of Lit.`\n      );\n    }\n    return {\n      get,\n      set(this: ReactiveElement, value: unknown) {\n        const oldValue = get?.call(this);\n        set?.call(this, value);\n        this.requestUpdate(name, oldValue, options);\n      },\n      configurable: true,\n      enumerable: true,\n    };\n  }\n\n  /**\n   * Returns the property options associated with the given property.\n   * These options are defined with a `PropertyDeclaration` via the `properties`\n   * object or the `@property` decorator and are registered in\n   * `createProperty(...)`.\n   *\n   * Note, this method should be considered \"final\" and not overridden. To\n   * customize the options for a given property, override\n   * {@linkcode createProperty}.\n   *\n   * @nocollapse\n   * @final\n   * @category properties\n   */\n  static getPropertyOptions(name: PropertyKey) {\n    return this.elementProperties.get(name) ?? defaultPropertyDeclaration;\n  }\n\n  // Temporary, until google3 is on TypeScript 5.2\n  declare static [Symbol.metadata]: object & Record<PropertyKey, unknown>;\n\n  /**\n   * Initializes static own properties of the class used in bookkeeping\n   * for element properties, initializers, etc.\n   *\n   * Can be called multiple times by code that needs to ensure these\n   * properties exist before using them.\n   *\n   * This method ensures the superclass is finalized so that inherited\n   * property metadata can be copied down.\n   * @nocollapse\n   */\n  private static __prepare() {\n    if (\n      this.hasOwnProperty(JSCompiler_renameProperty('elementProperties', this))\n    ) {\n      // Already prepared\n      return;\n    }\n    // Finalize any superclasses\n    const superCtor = getPrototypeOf(this) as typeof ReactiveElement;\n    superCtor.finalize();\n\n    // Create own set of initializers for this class if any exist on the\n    // superclass and copy them down. Note, for a small perf boost, avoid\n    // creating initializers unless needed.\n    if (superCtor._initializers !== undefined) {\n      this._initializers = [...superCtor._initializers];\n    }\n    // Initialize elementProperties from the superclass\n    this.elementProperties = new Map(superCtor.elementProperties);\n  }\n\n  /**\n   * Finishes setting up the class so that it's ready to be registered\n   * as a custom element and instantiated.\n   *\n   * This method is called by the ReactiveElement.observedAttributes getter.\n   * If you override the observedAttributes getter, you must either call\n   * super.observedAttributes to trigger finalization, or call finalize()\n   * yourself.\n   *\n   * @nocollapse\n   */\n  protected static finalize() {\n    if (this.hasOwnProperty(JSCompiler_renameProperty('finalized', this))) {\n      return;\n    }\n    this.finalized = true;\n    this.__prepare();\n\n    // Create properties from the static properties block:\n    if (this.hasOwnProperty(JSCompiler_renameProperty('properties', this))) {\n      const props = this.properties;\n      const propKeys = [\n        ...getOwnPropertyNames(props),\n        ...getOwnPropertySymbols(props),\n      ] as Array<keyof typeof props>;\n      for (const p of propKeys) {\n        this.createProperty(p, props[p]);\n      }\n    }\n\n    // Create properties from standard decorator metadata:\n    const metadata = this[Symbol.metadata];\n    if (metadata !== null) {\n      const properties = litPropertyMetadata.get(metadata);\n      if (properties !== undefined) {\n        for (const [p, options] of properties) {\n          this.elementProperties.set(p, options);\n        }\n      }\n    }\n\n    // Create the attribute-to-property map\n    this.__attributeToPropertyMap = new Map();\n    for (const [p, options] of this.elementProperties) {\n      const attr = this.__attributeNameForProperty(p, options);\n      if (attr !== undefined) {\n        this.__attributeToPropertyMap.set(attr, p);\n      }\n    }\n\n    this.elementStyles = this.finalizeStyles(this.styles);\n\n    if (DEV_MODE) {\n      if (this.hasOwnProperty('createProperty')) {\n        issueWarning(\n          'no-override-create-property',\n          'Overriding ReactiveElement.createProperty() is deprecated. ' +\n            'The override will not be called with standard decorators'\n        );\n      }\n      if (this.hasOwnProperty('getPropertyDescriptor')) {\n        issueWarning(\n          'no-override-get-property-descriptor',\n          'Overriding ReactiveElement.getPropertyDescriptor() is deprecated. ' +\n            'The override will not be called with standard decorators'\n        );\n      }\n    }\n  }\n\n  /**\n   * Options used when calling `attachShadow`. Set this property to customize\n   * the options for the shadowRoot; for example, to create a closed\n   * shadowRoot: `{mode: 'closed'}`.\n   *\n   * Note, these options are used in `createRenderRoot`. If this method\n   * is customized, options should be respected if possible.\n   * @nocollapse\n   * @category rendering\n   */\n  static shadowRootOptions: ShadowRootInit = {mode: 'open'};\n\n  /**\n   * Takes the styles the user supplied via the `static styles` property and\n   * returns the array of styles to apply to the element.\n   * Override this method to integrate into a style management system.\n   *\n   * Styles are deduplicated preserving the _last_ instance in the list. This\n   * is a performance optimization to avoid duplicated styles that can occur\n   * especially when composing via subclassing. The last item is kept to try\n   * to preserve the cascade order with the assumption that it's most important\n   * that last added styles override previous styles.\n   *\n   * @nocollapse\n   * @category styles\n   */\n  protected static finalizeStyles(\n    styles?: CSSResultGroup\n  ): Array<CSSResultOrNative> {\n    const elementStyles = [];\n    if (Array.isArray(styles)) {\n      // Dedupe the flattened array in reverse order to preserve the last items.\n      // Casting to Array<unknown> works around TS error that\n      // appears to come from trying to flatten a type CSSResultArray.\n      const set = new Set((styles as Array<unknown>).flat(Infinity).reverse());\n      // Then preserve original order by adding the set items in reverse order.\n      for (const s of set) {\n        elementStyles.unshift(getCompatibleStyle(s as CSSResultOrNative));\n      }\n    } else if (styles !== undefined) {\n      elementStyles.push(getCompatibleStyle(styles));\n    }\n    return elementStyles;\n  }\n\n  /**\n   * Node or ShadowRoot into which element DOM should be rendered. Defaults\n   * to an open shadowRoot.\n   * @category rendering\n   */\n  readonly renderRoot!: HTMLElement | DocumentFragment;\n\n  /**\n   * Returns the property name for the given attribute `name`.\n   * @nocollapse\n   */\n  private static __attributeNameForProperty(\n    name: PropertyKey,\n    options: PropertyDeclaration\n  ) {\n    const attribute = options.attribute;\n    return attribute === false\n      ? undefined\n      : typeof attribute === 'string'\n        ? attribute\n        : typeof name === 'string'\n          ? name.toLowerCase()\n          : undefined;\n  }\n\n  // Initialize to an unresolved Promise so we can make sure the element has\n  // connected before first update.\n  private __updatePromise!: Promise<boolean>;\n\n  /**\n   * True if there is a pending update as a result of calling `requestUpdate()`.\n   * Should only be read.\n   * @category updates\n   */\n  isUpdatePending = false;\n\n  /**\n   * Is set to `true` after the first update. The element code cannot assume\n   * that `renderRoot` exists before the element `hasUpdated`.\n   * @category updates\n   */\n  hasUpdated = false;\n\n  /**\n   * Map with keys for any properties that have changed since the last\n   * update cycle with previous values.\n   *\n   * @internal\n   */\n  _$changedProperties!: PropertyValues;\n\n  /**\n   * Records property default values when the\n   * `useDefault` option is used.\n   */\n  private __defaultValues?: Map<PropertyKey, unknown>;\n\n  /**\n   * Properties that should be reflected when updated.\n   */\n  private __reflectingProperties?: Set<PropertyKey>;\n\n  /**\n   * Name of currently reflecting property\n   */\n  private __reflectingProperty: PropertyKey | null = null;\n\n  /**\n   * Set of controllers.\n   */\n  private __controllers?: Set<ReactiveController>;\n\n  constructor() {\n    super();\n    this.__initialize();\n  }\n\n  /**\n   * Internal only override point for customizing work done when elements\n   * are constructed.\n   */\n  private __initialize() {\n    this.__updatePromise = new Promise<boolean>(\n      (res) => (this.enableUpdating = res)\n    );\n    this._$changedProperties = new Map();\n    // This enqueues a microtask that must run before the first update, so it\n    // must be called before requestUpdate()\n    this.__saveInstanceProperties();\n    // ensures first update will be caught by an early access of\n    // `updateComplete`\n    this.requestUpdate();\n    (this.constructor as typeof ReactiveElement)._initializers?.forEach((i) =>\n      i(this)\n    );\n  }\n\n  /**\n   * Registers a `ReactiveController` to participate in the element's reactive\n   * update cycle. The element automatically calls into any registered\n   * controllers during its lifecycle callbacks.\n   *\n   * If the element is connected when `addController()` is called, the\n   * controller's `hostConnected()` callback will be immediately called.\n   * @category controllers\n   */\n  addController(controller: ReactiveController) {\n    (this.__controllers ??= new Set()).add(controller);\n    // If a controller is added after the element has been connected,\n    // call hostConnected. Note, re-using existence of `renderRoot` here\n    // (which is set in connectedCallback) to avoid the need to track a\n    // first connected state.\n    if (this.renderRoot !== undefined && this.isConnected) {\n      controller.hostConnected?.();\n    }\n  }\n\n  /**\n   * Removes a `ReactiveController` from the element.\n   * @category controllers\n   */\n  removeController(controller: ReactiveController) {\n    this.__controllers?.delete(controller);\n  }\n\n  /**\n   * Fixes any properties set on the instance before upgrade time.\n   * Otherwise these would shadow the accessor and break these properties.\n   * The properties are stored in a Map which is played back after the\n   * constructor runs.\n   */\n  private __saveInstanceProperties() {\n    const instanceProperties = new Map<PropertyKey, unknown>();\n    const elementProperties = (this.constructor as typeof ReactiveElement)\n      .elementProperties;\n    for (const p of elementProperties.keys() as IterableIterator<keyof this>) {\n      if (this.hasOwnProperty(p)) {\n        instanceProperties.set(p, this[p]);\n        delete this[p];\n      }\n    }\n    if (instanceProperties.size > 0) {\n      this.__instanceProperties = instanceProperties;\n    }\n  }\n\n  /**\n   * Returns the node into which the element should render and by default\n   * creates and returns an open shadowRoot. Implement to customize where the\n   * element's DOM is rendered. For example, to render into the element's\n   * childNodes, return `this`.\n   *\n   * @return Returns a node into which to render.\n   * @category rendering\n   */\n  protected createRenderRoot(): HTMLElement | DocumentFragment {\n    const renderRoot =\n      this.shadowRoot ??\n      this.attachShadow(\n        (this.constructor as typeof ReactiveElement).shadowRootOptions\n      );\n    adoptStyles(\n      renderRoot,\n      (this.constructor as typeof ReactiveElement).elementStyles\n    );\n    return renderRoot;\n  }\n\n  /**\n   * On first connection, creates the element's renderRoot, sets up\n   * element styling, and enables updating.\n   * @category lifecycle\n   */\n  connectedCallback() {\n    // Create renderRoot before controllers `hostConnected`\n    (this as Mutable<typeof this, 'renderRoot'>).renderRoot ??=\n      this.createRenderRoot();\n    this.enableUpdating(true);\n    this.__controllers?.forEach((c) => c.hostConnected?.());\n  }\n\n  /**\n   * Note, this method should be considered final and not overridden. It is\n   * overridden on the element instance with a function that triggers the first\n   * update.\n   * @category updates\n   */\n  protected enableUpdating(_requestedUpdate: boolean) {}\n\n  /**\n   * Allows for `super.disconnectedCallback()` in extensions while\n   * reserving the possibility of making non-breaking feature additions\n   * when disconnecting at some point in the future.\n   * @category lifecycle\n   */\n  disconnectedCallback() {\n    this.__controllers?.forEach((c) => c.hostDisconnected?.());\n  }\n\n  /**\n   * Synchronizes property values when attributes change.\n   *\n   * Specifically, when an attribute is set, the corresponding property is set.\n   * You should rarely need to implement this callback. If this method is\n   * overridden, `super.attributeChangedCallback(name, _old, value)` must be\n   * called.\n   *\n   * See [responding to attribute changes](https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements#responding_to_attribute_changes)\n   * on MDN for more information about the `attributeChangedCallback`.\n   * @category attributes\n   */\n  attributeChangedCallback(\n    name: string,\n    _old: string | null,\n    value: string | null\n  ) {\n    this._$attributeToProperty(name, value);\n  }\n\n  private __propertyToAttribute(name: PropertyKey, value: unknown) {\n    const elemProperties: PropertyDeclarationMap = (\n      this.constructor as typeof ReactiveElement\n    ).elementProperties;\n    const options = elemProperties.get(name)!;\n    const attr = (\n      this.constructor as typeof ReactiveElement\n    ).__attributeNameForProperty(name, options);\n    if (attr !== undefined && options.reflect === true) {\n      const converter =\n        (options.converter as ComplexAttributeConverter)?.toAttribute !==\n        undefined\n          ? (options.converter as ComplexAttributeConverter)\n          : defaultConverter;\n      const attrValue = converter.toAttribute!(value, options.type);\n      if (\n        DEV_MODE &&\n        (this.constructor as typeof ReactiveElement).enabledWarnings!.includes(\n          'migration'\n        ) &&\n        attrValue === undefined\n      ) {\n        issueWarning(\n          'undefined-attribute-value',\n          `The attribute value for the ${name as string} property is ` +\n            `undefined on element ${this.localName}. The attribute will be ` +\n            `removed, but in the previous version of \\`ReactiveElement\\`, ` +\n            `the attribute would not have changed.`\n        );\n      }\n      // Track if the property is being reflected to avoid\n      // setting the property again via `attributeChangedCallback`. Note:\n      // 1. this takes advantage of the fact that the callback is synchronous.\n      // 2. will behave incorrectly if multiple attributes are in the reaction\n      // stack at time of calling. However, since we process attributes\n      // in `update` this should not be possible (or an extreme corner case\n      // that we'd like to discover).\n      // mark state reflecting\n      this.__reflectingProperty = name;\n      if (attrValue == null) {\n        this.removeAttribute(attr);\n      } else {\n        this.setAttribute(attr, attrValue as string);\n      }\n      // mark state not reflecting\n      this.__reflectingProperty = null;\n    }\n  }\n\n  /** @internal */\n  _$attributeToProperty(name: string, value: string | null) {\n    const ctor = this.constructor as typeof ReactiveElement;\n    // Note, hint this as an `AttributeMap` so closure clearly understands\n    // the type; it has issues with tracking types through statics\n    const propName = (ctor.__attributeToPropertyMap as AttributeMap).get(name);\n    // Use tracking info to avoid reflecting a property value to an attribute\n    // if it was just set because the attribute changed.\n    if (propName !== undefined && this.__reflectingProperty !== propName) {\n      const options = ctor.getPropertyOptions(propName);\n      const converter =\n        typeof options.converter === 'function'\n          ? {fromAttribute: options.converter}\n          : options.converter?.fromAttribute !== undefined\n            ? options.converter\n            : defaultConverter;\n      // mark state reflecting\n      this.__reflectingProperty = propName;\n      this[propName as keyof this] =\n        converter.fromAttribute!(value, options.type) ??\n        this.__defaultValues?.get(propName) ??\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (null as any);\n      // mark state not reflecting\n      this.__reflectingProperty = null;\n    }\n  }\n\n  /**\n   * Requests an update which is processed asynchronously. This should be called\n   * when an element should update based on some state not triggered by setting\n   * a reactive property. In this case, pass no arguments. It should also be\n   * called when manually implementing a property setter. In this case, pass the\n   * property `name` and `oldValue` to ensure that any configured property\n   * options are honored.\n   *\n   * @param name name of requesting property\n   * @param oldValue old value of requesting property\n   * @param options property options to use instead of the previously\n   *     configured options\n   * @category updates\n   */\n  requestUpdate(\n    name?: PropertyKey,\n    oldValue?: unknown,\n    options?: PropertyDeclaration\n  ): void {\n    // If we have a property key, perform property update steps.\n    if (name !== undefined) {\n      if (DEV_MODE && (name as unknown) instanceof Event) {\n        issueWarning(\n          ``,\n          `The requestUpdate() method was called with an Event as the property name. This is probably a mistake caused by binding this.requestUpdate as an event listener. Instead bind a function that will call it with no arguments: () => this.requestUpdate()`\n        );\n      }\n      const ctor = this.constructor as typeof ReactiveElement;\n      const newValue = this[name as keyof this];\n      options ??= ctor.getPropertyOptions(name);\n      const changed =\n        (options.hasChanged ?? notEqual)(newValue, oldValue) ||\n        // When there is no change, check a corner case that can occur when\n        // 1. there's a initial value which was not reflected\n        // 2. the property is subsequently set to this value.\n        // For example, `prop: {useDefault: true, reflect: true}`\n        // and el.prop = 'foo'. This should be considered a change if the\n        // attribute is not set because we will now reflect the property to the attribute.\n        (options.useDefault &&\n          options.reflect &&\n          newValue === this.__defaultValues?.get(name) &&\n          !this.hasAttribute(ctor.__attributeNameForProperty(name, options)!));\n      if (changed) {\n        this._$changeProperty(name, oldValue, options);\n      } else {\n        // Abort the request if the property should not be considered changed.\n        return;\n      }\n    }\n    if (this.isUpdatePending === false) {\n      this.__updatePromise = this.__enqueueUpdate();\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _$changeProperty(\n    name: PropertyKey,\n    oldValue: unknown,\n    {useDefault, reflect, wrapped}: PropertyDeclaration,\n    initializeValue?: unknown\n  ) {\n    // Record default value when useDefault is used. This allows us to\n    // restore this value when the attribute is removed.\n    if (useDefault && !(this.__defaultValues ??= new Map()).has(name)) {\n      this.__defaultValues.set(\n        name,\n        initializeValue ?? oldValue ?? this[name as keyof this]\n      );\n      // if this is not wrapping an accessor, it must be an initial setting\n      // and in this case we do not want to record the change or reflect.\n      if (wrapped !== true || initializeValue !== undefined) {\n        return;\n      }\n    }\n    // TODO (justinfagnani): Create a benchmark of Map.has() + Map.set(\n    // vs just Map.set()\n    if (!this._$changedProperties.has(name)) {\n      // On the initial change, the old value should be `undefined`, except\n      // with `useDefault`\n      if (!this.hasUpdated && !useDefault) {\n        oldValue = undefined;\n      }\n      this._$changedProperties.set(name, oldValue);\n    }\n    // Add to reflecting properties set.\n    // Note, it's important that every change has a chance to add the\n    // property to `__reflectingProperties`. This ensures setting\n    // attribute + property reflects correctly.\n    if (reflect === true && this.__reflectingProperty !== name) {\n      (this.__reflectingProperties ??= new Set<PropertyKey>()).add(name);\n    }\n  }\n\n  /**\n   * Sets up the element to asynchronously update.\n   */\n  private async __enqueueUpdate() {\n    this.isUpdatePending = true;\n    try {\n      // Ensure any previous update has resolved before updating.\n      // This `await` also ensures that property changes are batched.\n      await this.__updatePromise;\n    } catch (e) {\n      // Refire any previous errors async so they do not disrupt the update\n      // cycle. Errors are refired so developers have a chance to observe\n      // them, and this can be done by implementing\n      // `window.onunhandledrejection`.\n      Promise.reject(e);\n    }\n    const result = this.scheduleUpdate();\n    // If `scheduleUpdate` returns a Promise, we await it. This is done to\n    // enable coordinating updates with a scheduler. Note, the result is\n    // checked to avoid delaying an additional microtask unless we need to.\n    if (result != null) {\n      await result;\n    }\n    return !this.isUpdatePending;\n  }\n\n  /**\n   * Schedules an element update. You can override this method to change the\n   * timing of updates by returning a Promise. The update will await the\n   * returned Promise, and you should resolve the Promise to allow the update\n   * to proceed. If this method is overridden, `super.scheduleUpdate()`\n   * must be called.\n   *\n   * For instance, to schedule updates to occur just before the next frame:\n   *\n   * ```ts\n   * override protected async scheduleUpdate(): Promise<unknown> {\n   *   await new Promise((resolve) => requestAnimationFrame(() => resolve()));\n   *   super.scheduleUpdate();\n   * }\n   * ```\n   * @category updates\n   */\n  protected scheduleUpdate(): void | Promise<unknown> {\n    const result = this.performUpdate();\n    if (\n      DEV_MODE &&\n      (this.constructor as typeof ReactiveElement).enabledWarnings!.includes(\n        'async-perform-update'\n      ) &&\n      typeof (result as unknown as Promise<unknown> | undefined)?.then ===\n        'function'\n    ) {\n      issueWarning(\n        'async-perform-update',\n        `Element ${this.localName} returned a Promise from performUpdate(). ` +\n          `This behavior is deprecated and will be removed in a future ` +\n          `version of ReactiveElement.`\n      );\n    }\n    return result;\n  }\n\n  /**\n   * Performs an element update. Note, if an exception is thrown during the\n   * update, `firstUpdated` and `updated` will not be called.\n   *\n   * Call `performUpdate()` to immediately process a pending update. This should\n   * generally not be needed, but it can be done in rare cases when you need to\n   * update synchronously.\n   *\n   * @category updates\n   */\n  protected performUpdate(): void {\n    // Abort any update if one is not pending when this is called.\n    // This can happen if `performUpdate` is called early to \"flush\"\n    // the update.\n    if (!this.isUpdatePending) {\n      return;\n    }\n    debugLogEvent?.({kind: 'update'});\n    if (!this.hasUpdated) {\n      // Create renderRoot before first update. This occurs in `connectedCallback`\n      // but is done here to support out of tree calls to `enableUpdating`/`performUpdate`.\n      (this as Mutable<typeof this, 'renderRoot'>).renderRoot ??=\n        this.createRenderRoot();\n      if (DEV_MODE) {\n        // Produce warning if any reactive properties on the prototype are\n        // shadowed by class fields. Instance fields set before upgrade are\n        // deleted by this point, so any own property is caused by class field\n        // initialization in the constructor.\n        const ctor = this.constructor as typeof ReactiveElement;\n        const shadowedProperties = [...ctor.elementProperties.keys()].filter(\n          (p) => this.hasOwnProperty(p) && p in getPrototypeOf(this)\n        );\n        if (shadowedProperties.length) {\n          throw new Error(\n            `The following properties on element ${this.localName} will not ` +\n              `trigger updates as expected because they are set using class ` +\n              `fields: ${shadowedProperties.join(', ')}. ` +\n              `Native class fields and some compiled output will overwrite ` +\n              `accessors used for detecting changes. See ` +\n              `https://lit.dev/msg/class-field-shadowing ` +\n              `for more information.`\n          );\n        }\n      }\n      // Mixin instance properties once, if they exist.\n      if (this.__instanceProperties) {\n        // TODO (justinfagnani): should we use the stored value? Could a new value\n        // have been set since we stored the own property value?\n        for (const [p, value] of this.__instanceProperties) {\n          this[p as keyof this] = value as this[keyof this];\n        }\n        this.__instanceProperties = undefined;\n      }\n      // Trigger initial value reflection and populate the initial\n      // `changedProperties` map, but only for the case of properties created\n      // via `createProperty` on accessors, which will not have already\n      // populated the `changedProperties` map since they are not set.\n      // We can't know if these accessors had initializers, so we just set\n      // them anyway - a difference from experimental decorators on fields and\n      // standard decorators on auto-accessors.\n      // For context see:\n      // https://github.com/lit/lit/pull/4183#issuecomment-1711959635\n      const elementProperties = (this.constructor as typeof ReactiveElement)\n        .elementProperties;\n      if (elementProperties.size > 0) {\n        for (const [p, options] of elementProperties) {\n          const {wrapped} = options;\n          const value = this[p as keyof this];\n          if (\n            wrapped === true &&\n            !this._$changedProperties.has(p) &&\n            value !== undefined\n          ) {\n            this._$changeProperty(p, undefined, options, value);\n          }\n        }\n      }\n    }\n    let shouldUpdate = false;\n    const changedProperties = this._$changedProperties;\n    try {\n      shouldUpdate = this.shouldUpdate(changedProperties);\n      if (shouldUpdate) {\n        this.willUpdate(changedProperties);\n        this.__controllers?.forEach((c) => c.hostUpdate?.());\n        this.update(changedProperties);\n      } else {\n        this.__markUpdated();\n      }\n    } catch (e) {\n      // Prevent `firstUpdated` and `updated` from running when there's an\n      // update exception.\n      shouldUpdate = false;\n      // Ensure element can accept additional updates after an exception.\n      this.__markUpdated();\n      throw e;\n    }\n    // The update is no longer considered pending and further updates are now allowed.\n    if (shouldUpdate) {\n      this._$didUpdate(changedProperties);\n    }\n  }\n\n  /**\n   * Invoked before `update()` to compute values needed during the update.\n   *\n   * Implement `willUpdate` to compute property values that depend on other\n   * properties and are used in the rest of the update process.\n   *\n   * ```ts\n   * willUpdate(changedProperties) {\n   *   // only need to check changed properties for an expensive computation.\n   *   if (changedProperties.has('firstName') || changedProperties.has('lastName')) {\n   *     this.sha = computeSHA(`${this.firstName} ${this.lastName}`);\n   *   }\n   * }\n   *\n   * render() {\n   *   return html`SHA: ${this.sha}`;\n   * }\n   * ```\n   *\n   * @category updates\n   */\n  protected willUpdate(_changedProperties: PropertyValues): void {}\n\n  // Note, this is an override point for polyfill-support.\n  // @internal\n  _$didUpdate(changedProperties: PropertyValues) {\n    this.__controllers?.forEach((c) => c.hostUpdated?.());\n    if (!this.hasUpdated) {\n      this.hasUpdated = true;\n      this.firstUpdated(changedProperties);\n    }\n    this.updated(changedProperties);\n    if (\n      DEV_MODE &&\n      this.isUpdatePending &&\n      (this.constructor as typeof ReactiveElement).enabledWarnings!.includes(\n        'change-in-update'\n      )\n    ) {\n      issueWarning(\n        'change-in-update',\n        `Element ${this.localName} scheduled an update ` +\n          `(generally because a property was set) ` +\n          `after an update completed, causing a new update to be scheduled. ` +\n          `This is inefficient and should be avoided unless the next update ` +\n          `can only be scheduled as a side effect of the previous update.`\n      );\n    }\n  }\n\n  private __markUpdated() {\n    this._$changedProperties = new Map();\n    this.isUpdatePending = false;\n  }\n\n  /**\n   * Returns a Promise that resolves when the element has completed updating.\n   * The Promise value is a boolean that is `true` if the element completed the\n   * update without triggering another update. The Promise result is `false` if\n   * a property was set inside `updated()`. If the Promise is rejected, an\n   * exception was thrown during the update.\n   *\n   * To await additional asynchronous work, override the `getUpdateComplete`\n   * method. For example, it is sometimes useful to await a rendered element\n   * before fulfilling this Promise. To do this, first await\n   * `super.getUpdateComplete()`, then any subsequent state.\n   *\n   * @return A promise of a boolean that resolves to true if the update completed\n   *     without triggering another update.\n   * @category updates\n   */\n  get updateComplete(): Promise<boolean> {\n    return this.getUpdateComplete();\n  }\n\n  /**\n   * Override point for the `updateComplete` promise.\n   *\n   * It is not safe to override the `updateComplete` getter directly due to a\n   * limitation in TypeScript which means it is not possible to call a\n   * superclass getter (e.g. `super.updateComplete.then(...)`) when the target\n   * language is ES5 (https://github.com/microsoft/TypeScript/issues/338).\n   * This method should be overridden instead. For example:\n   *\n   * ```ts\n   * class MyElement extends LitElement {\n   *   override async getUpdateComplete() {\n   *     const result = await super.getUpdateComplete();\n   *     await this._myChild.updateComplete;\n   *     return result;\n   *   }\n   * }\n   * ```\n   *\n   * @return A promise of a boolean that resolves to true if the update completed\n   *     without triggering another update.\n   * @category updates\n   */\n  protected getUpdateComplete(): Promise<boolean> {\n    return this.__updatePromise;\n  }\n\n  /**\n   * Controls whether or not `update()` should be called when the element requests\n   * an update. By default, this method always returns `true`, but this can be\n   * customized to control when to update.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected shouldUpdate(_changedProperties: PropertyValues): boolean {\n    return true;\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes.\n   * It can be overridden to render and keep updated element DOM.\n   * Setting properties inside this method will *not* trigger\n   * another update.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected update(_changedProperties: PropertyValues) {\n    // The forEach() expression will only run when __reflectingProperties is\n    // defined, and it returns undefined, setting __reflectingProperties to\n    // undefined\n    this.__reflectingProperties &&= this.__reflectingProperties.forEach((p) =>\n      this.__propertyToAttribute(p, this[p as keyof this])\n    ) as undefined;\n    this.__markUpdated();\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected updated(_changedProperties: PropertyValues) {}\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * ```ts\n   * firstUpdated() {\n   *   this.renderRoot.getElementById('my-text-area').focus();\n   * }\n   * ```\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   * @category updates\n   */\n  protected firstUpdated(_changedProperties: PropertyValues) {}\n}\n// Assigned here to work around a jscompiler bug with static fields\n// when compiling to ES5.\n// https://github.com/google/closure-compiler/issues/3177\n(ReactiveElement as unknown as Record<string, unknown>)[\n  JSCompiler_renameProperty('elementProperties', ReactiveElement)\n] = new Map();\n(ReactiveElement as unknown as Record<string, unknown>)[\n  JSCompiler_renameProperty('finalized', ReactiveElement)\n] = new Map();\n\n// Apply polyfills if available\npolyfillSupport?.({ReactiveElement});\n\n// Dev mode warnings...\nif (DEV_MODE) {\n  // Default warning set.\n  ReactiveElement.enabledWarnings = [\n    'change-in-update',\n    'async-perform-update',\n  ];\n  const ensureOwnWarnings = function (ctor: typeof ReactiveElement) {\n    if (\n      !ctor.hasOwnProperty(JSCompiler_renameProperty('enabledWarnings', ctor))\n    ) {\n      ctor.enabledWarnings = ctor.enabledWarnings!.slice();\n    }\n  };\n  ReactiveElement.enableWarning = function (\n    this: typeof ReactiveElement,\n    warning: WarningKind\n  ) {\n    ensureOwnWarnings(this);\n    if (!this.enabledWarnings!.includes(warning)) {\n      this.enabledWarnings!.push(warning);\n    }\n  };\n  ReactiveElement.disableWarning = function (\n    this: typeof ReactiveElement,\n    warning: WarningKind\n  ) {\n    ensureOwnWarnings(this);\n    const i = this.enabledWarnings!.indexOf(warning);\n    if (i >= 0) {\n      this.enabledWarnings!.splice(i, 1);\n    }\n  };\n}\n\n// IMPORTANT: do not change the property name or the assignment expression.\n// This line will be used in regexes to search for ReactiveElement usage.\n(global.reactiveElementVersions ??= []).push('2.1.0');\nif (DEV_MODE && global.reactiveElementVersions.length > 1) {\n  queueMicrotask(() => {\n    issueWarning!(\n      'multiple-versions',\n      `Multiple versions of Lit loaded. Loading multiple versions ` +\n        `is not recommended.`\n    );\n  });\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\n\nimport {\n  type PropertyDeclaration,\n  type ReactiveElement,\n  defaultConverter,\n  notEqual,\n} from '../reactive-element.js';\nimport type {Interface} from './base.js';\n\nconst DEV_MODE = true;\n\nlet issueWarning: (code: string, warning: string) => void;\n\nif (DEV_MODE) {\n  // Ensure warnings are issued only 1x, even if multiple versions of Lit\n  // are loaded.\n  globalThis.litIssuedWarnings ??= new Set();\n\n  /**\n   * Issue a warning if we haven't already, based either on `code` or `warning`.\n   * Warnings are disabled automatically only by `warning`; disabling via `code`\n   * can be done by users.\n   */\n  issueWarning = (code: string, warning: string) => {\n    warning += ` See https://lit.dev/msg/${code} for more information.`;\n    if (\n      !globalThis.litIssuedWarnings!.has(warning) &&\n      !globalThis.litIssuedWarnings!.has(code)\n    ) {\n      console.warn(warning);\n      globalThis.litIssuedWarnings!.add(warning);\n    }\n  };\n}\n\n// Overloads for property decorator so that TypeScript can infer the correct\n// return type when a decorator is used as an accessor decorator or a setter\n// decorator.\nexport type PropertyDecorator = {\n  // accessor decorator signature\n  <C extends Interface<ReactiveElement>, V>(\n    target: ClassAccessorDecoratorTarget<C, V>,\n    context: ClassAccessorDecoratorContext<C, V>\n  ): ClassAccessorDecoratorResult<C, V>;\n\n  // setter decorator signature\n  <C extends Interface<ReactiveElement>, V>(\n    target: (value: V) => void,\n    context: ClassSetterDecoratorContext<C, V>\n  ): (this: C, value: V) => void;\n\n  // legacy decorator signature\n  (\n    protoOrDescriptor: Object,\n    name: PropertyKey,\n    descriptor?: PropertyDescriptor\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): any;\n};\n\nconst legacyProperty = (\n  options: PropertyDeclaration | undefined,\n  proto: Object,\n  name: PropertyKey\n) => {\n  const hasOwnProperty = proto.hasOwnProperty(name);\n  (proto.constructor as typeof ReactiveElement).createProperty(name, options);\n  // For accessors (which have a descriptor on the prototype) we need to\n  // return a descriptor, otherwise TypeScript overwrites the descriptor we\n  // define in createProperty() with the original descriptor. We don't do this\n  // for fields, which don't have a descriptor, because this could overwrite\n  // descriptor defined by other decorators.\n  return hasOwnProperty\n    ? Object.getOwnPropertyDescriptor(proto, name)\n    : undefined;\n};\n\n// This is duplicated from a similar variable in reactive-element.ts, but\n// actually makes sense to have this default defined with the decorator, so\n// that different decorators could have different defaults.\nconst defaultPropertyDeclaration: PropertyDeclaration = {\n  attribute: true,\n  type: String,\n  converter: defaultConverter,\n  reflect: false,\n  hasChanged: notEqual,\n};\n\n// Temporary type, until google3 is on TypeScript 5.2\ntype StandardPropertyContext<C, V> = (\n  | ClassAccessorDecoratorContext<C, V>\n  | ClassSetterDecoratorContext<C, V>\n) & {metadata: object};\n\n/**\n * Wraps a class accessor or setter so that `requestUpdate()` is called with the\n * property name and old value when the accessor is set.\n */\nexport const standardProperty = <C extends Interface<ReactiveElement>, V>(\n  options: PropertyDeclaration = defaultPropertyDeclaration,\n  target: ClassAccessorDecoratorTarget<C, V> | ((value: V) => void),\n  context: StandardPropertyContext<C, V>\n): ClassAccessorDecoratorResult<C, V> | ((this: C, value: V) => void) => {\n  const {kind, metadata} = context;\n\n  if (DEV_MODE && metadata == null) {\n    issueWarning(\n      'missing-class-metadata',\n      `The class ${target} is missing decorator metadata. This ` +\n        `could mean that you're using a compiler that supports decorators ` +\n        `but doesn't support decorator metadata, such as TypeScript 5.1. ` +\n        `Please update your compiler.`\n    );\n  }\n\n  // Store the property options\n  let properties = globalThis.litPropertyMetadata.get(metadata);\n  if (properties === undefined) {\n    globalThis.litPropertyMetadata.set(metadata, (properties = new Map()));\n  }\n  if (kind === 'setter') {\n    options = Object.create(options);\n    options.wrapped = true;\n  }\n  properties.set(context.name, options);\n\n  if (kind === 'accessor') {\n    // Standard decorators cannot dynamically modify the class, so we can't\n    // replace a field with accessors. The user must use the new `accessor`\n    // keyword instead.\n    const {name} = context;\n    return {\n      set(this: ReactiveElement, v: V) {\n        const oldValue = (\n          target as ClassAccessorDecoratorTarget<C, V>\n        ).get.call(this as unknown as C);\n        (target as ClassAccessorDecoratorTarget<C, V>).set.call(\n          this as unknown as C,\n          v\n        );\n        this.requestUpdate(name, oldValue, options);\n      },\n      init(this: ReactiveElement, v: V): V {\n        if (v !== undefined) {\n          this._$changeProperty(name, undefined, options, v);\n        }\n        return v;\n      },\n    } as unknown as ClassAccessorDecoratorResult<C, V>;\n  } else if (kind === 'setter') {\n    const {name} = context;\n    return function (this: ReactiveElement, value: V) {\n      const oldValue = this[name as keyof ReactiveElement];\n      (target as (value: V) => void).call(this, value);\n      this.requestUpdate(name, oldValue, options);\n    } as unknown as (this: C, value: V) => void;\n  }\n  throw new Error(`Unsupported decorator location: ${kind}`);\n};\n\n/**\n * A class field or accessor decorator which creates a reactive property that\n * reflects a corresponding attribute value. When a decorated property is set\n * the element will update and render. A {@linkcode PropertyDeclaration} may\n * optionally be supplied to configure property features.\n *\n * This decorator should only be used for public fields. As public fields,\n * properties should be considered as primarily settable by element users,\n * either via attribute or the property itself.\n *\n * Generally, properties that are changed by the element should be private or\n * protected fields and should use the {@linkcode state} decorator.\n *\n * However, sometimes element code does need to set a public property. This\n * should typically only be done in response to user interaction, and an event\n * should be fired informing the user; for example, a checkbox sets its\n * `checked` property when clicked and fires a `changed` event. Mutating public\n * properties should typically not be done for non-primitive (object or array)\n * properties. In other cases when an element needs to manage state, a private\n * property decorated via the {@linkcode state} decorator should be used. When\n * needed, state properties can be initialized via public properties to\n * facilitate complex interactions.\n *\n * ```ts\n * class MyElement {\n *   @property({ type: Boolean })\n *   clicked = false;\n * }\n * ```\n * @category Decorator\n * @ExportDecoratedItems\n */\nexport function property(options?: PropertyDeclaration): PropertyDecorator {\n  return <C extends Interface<ReactiveElement>, V>(\n    protoOrTarget:\n      | object\n      | ClassAccessorDecoratorTarget<C, V>\n      | ((value: V) => void),\n    nameOrContext:\n      | PropertyKey\n      | ClassAccessorDecoratorContext<C, V>\n      | ClassSetterDecoratorContext<C, V>\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): any => {\n    return (\n      typeof nameOrContext === 'object'\n        ? standardProperty<C, V>(\n            options,\n            protoOrTarget as\n              | ClassAccessorDecoratorTarget<C, V>\n              | ((value: V) => void),\n            nameOrContext as StandardPropertyContext<C, V>\n          )\n        : legacyProperty(\n            options,\n            protoOrTarget as Object,\n            nameOrContext as PropertyKey\n          )\n    ) as PropertyDecorator;\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * Generates a public interface type that removes private and protected fields.\n * This allows accepting otherwise incompatible versions of the type (e.g. from\n * multiple copies of the same package in `node_modules`).\n */\nexport type Interface<T> = {\n  [K in keyof T]: T[K];\n};\n\nexport type Constructor<T> = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  new (...args: any[]): T;\n};\n\n/**\n * Wraps up a few best practices when returning a property descriptor from a\n * decorator.\n *\n * Marks the defined property as configurable, and enumerable, and handles\n * the case where we have a busted Reflect.decorate zombiefill (e.g. in Angular\n * apps).\n *\n * @internal\n */\nexport const desc = (\n  obj: object,\n  name: PropertyKey | ClassAccessorDecoratorContext<unknown, unknown>,\n  descriptor: PropertyDescriptor\n) => {\n  // For backwards compatibility, we keep them configurable and enumerable.\n  descriptor.configurable = true;\n  descriptor.enumerable = true;\n  if (\n    // We check for Reflect.decorate each time, in case the zombiefill\n    // is applied via lazy loading some Angular code.\n    (Reflect as typeof Reflect & {decorate?: unknown}).decorate &&\n    typeof name !== 'object'\n  ) {\n    // If we're called as a legacy decorator, and Reflect.decorate is present\n    // then we have no guarantees that the returned descriptor will be\n    // defined on the class, so we must apply it directly ourselves.\n\n    Object.defineProperty(obj, name, descriptor);\n  }\n  return descriptor;\n};\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/*\n * IMPORTANT: For compatibility with tsickle and the Closure JS compiler, all\n * property decorators (but not class decorators) in this file that have\n * an @ExportDecoratedItems annotation must be defined as a regular function,\n * not an arrow function.\n */\nimport type {ReactiveElement} from '../reactive-element.js';\nimport {desc, type Interface} from './base.js';\n\nconst DEV_MODE = true;\n\nlet issueWarning: (code: string, warning: string) => void;\n\nif (DEV_MODE) {\n  // Ensure warnings are issued only 1x, even if multiple versions of Lit\n  // are loaded.\n  globalThis.litIssuedWarnings ??= new Set();\n\n  /**\n   * Issue a warning if we haven't already, based either on `code` or `warning`.\n   * Warnings are disabled automatically only by `warning`; disabling via `code`\n   * can be done by users.\n   */\n  issueWarning = (code: string, warning: string) => {\n    warning += code\n      ? ` See https://lit.dev/msg/${code} for more information.`\n      : '';\n    if (\n      !globalThis.litIssuedWarnings!.has(warning) &&\n      !globalThis.litIssuedWarnings!.has(code)\n    ) {\n      console.warn(warning);\n      globalThis.litIssuedWarnings!.add(warning);\n    }\n  };\n}\n\nexport type QueryDecorator = {\n  // legacy\n  (\n    proto: Interface<ReactiveElement>,\n    name: PropertyKey,\n    descriptor?: PropertyDescriptor\n    // Note TypeScript requires the return type to be `void|any`\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): void | any;\n\n  // standard\n  <C extends Interface<ReactiveElement>, V extends Element | null>(\n    value: ClassAccessorDecoratorTarget<C, V>,\n    context: ClassAccessorDecoratorContext<C, V>\n  ): ClassAccessorDecoratorResult<C, V>;\n};\n\n/**\n * A property decorator that converts a class property into a getter that\n * executes a querySelector on the element's renderRoot.\n *\n * @param selector A DOMString containing one or more selectors to match.\n * @param cache An optional boolean which when true performs the DOM query only\n *     once and caches the result.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\n *\n * ```ts\n * class MyElement {\n *   @query('#first')\n *   first: HTMLDivElement;\n *\n *   render() {\n *     return html`\n *       <div id=\"first\"></div>\n *       <div id=\"second\"></div>\n *     `;\n *   }\n * }\n * ```\n * @category Decorator\n */\nexport function query(selector: string, cache?: boolean): QueryDecorator {\n  return (<C extends Interface<ReactiveElement>, V extends Element | null>(\n    protoOrTarget: ClassAccessorDecoratorTarget<C, V>,\n    nameOrContext: PropertyKey | ClassAccessorDecoratorContext<C, V>,\n    descriptor?: PropertyDescriptor\n  ) => {\n    const doQuery = (el: Interface<ReactiveElement>): V => {\n      const result = (el.renderRoot?.querySelector(selector) ?? null) as V;\n      if (DEV_MODE && result === null && cache && !el.hasUpdated) {\n        const name =\n          typeof nameOrContext === 'object'\n            ? nameOrContext.name\n            : nameOrContext;\n        issueWarning(\n          '',\n          `@query'd field ${JSON.stringify(String(name))} with the 'cache' ` +\n            `flag set for selector '${selector}' has been accessed before ` +\n            `the first update and returned null. This is expected if the ` +\n            `renderRoot tree has not been provided beforehand (e.g. via ` +\n            `Declarative Shadow DOM). Therefore the value hasn't been cached.`\n        );\n      }\n      // TODO: if we want to allow users to assert that the query will never\n      // return null, we need a new option and to throw here if the result\n      // is null.\n      return result;\n    };\n    if (cache) {\n      // Accessors to wrap from either:\n      //   1. The decorator target, in the case of standard decorators\n      //   2. The property descriptor, in the case of experimental decorators\n      //      on auto-accessors.\n      //   3. Functions that access our own cache-key property on the instance,\n      //      in the case of experimental decorators on fields.\n      const {get, set} =\n        typeof nameOrContext === 'object'\n          ? protoOrTarget\n          : descriptor ??\n            (() => {\n              const key = DEV_MODE\n                ? Symbol(`${String(nameOrContext)} (@query() cache)`)\n                : Symbol();\n              type WithCache = ReactiveElement & {\n                [key: symbol]: Element | null;\n              };\n              return {\n                get() {\n                  return (this as WithCache)[key];\n                },\n                set(v) {\n                  (this as WithCache)[key] = v;\n                },\n              };\n            })();\n      return desc(protoOrTarget, nameOrContext, {\n        get(this: ReactiveElement): V {\n          let result: V = get!.call(this);\n          if (result === undefined) {\n            result = doQuery(this);\n            if (result !== null || this.hasUpdated) {\n              set!.call(this, result);\n            }\n          }\n          return result;\n        },\n      });\n    } else {\n      // This object works as the return type for both standard and\n      // experimental decorators.\n      return desc(protoOrTarget, nameOrContext, {\n        get(this: ReactiveElement) {\n          return doQuery(this);\n        },\n      });\n    }\n  }) as QueryDecorator;\n}\n",null,"/*! (c) Andrea Giammarchi - ISC */\nvar self = {};\ntry {\n  self.EventTarget = (new EventTarget).constructor;\n} catch(EventTarget) {\n  (function (Object, wm) {\n    var create = Object.create;\n    var defineProperty = Object.defineProperty;\n    var proto = EventTarget.prototype;\n    define(proto, 'addEventListener', function (type, listener, options) {\n      for (var\n        secret = wm.get(this),\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener)\n          return;\n      }\n      listeners.push({target: this, listener: listener, options: options});\n    });\n    define(proto, 'dispatchEvent', function (event) {\n      var secret = wm.get(this);\n      var listeners = secret[event.type];\n      if (listeners) {\n        define(event, 'target', this);\n        define(event, 'currentTarget', this);\n        listeners.slice(0).some(dispatch, event);\n        delete event.currentTarget;\n        delete event.target;\n      }\n      return true;\n    });\n    define(proto, 'removeEventListener', function (type, listener) {\n      for (var\n        secret = wm.get(this),\n        /* istanbul ignore next */\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener) {\n          listeners.splice(i, 1);\n          return;\n        }\n      }\n    });\n    self.EventTarget = EventTarget;\n    function EventTarget() {'use strict';\n      wm.set(this, create(null));\n    }\n    function define(target, name, value) {\n      defineProperty(\n        target,\n        name,\n        {\n          configurable: true,\n          writable: true,\n          value: value\n        }\n      );\n    }\n    function dispatch(info) {\n      var options = info.options;\n      if (options && options.once)\n        info.target.removeEventListener(this.type, info.listener);\n      if (typeof info.listener === 'function')\n        info.listener.call(info.target, this);\n      else\n        info.listener.handleEvent(this);\n      return this._stopImmediatePropagationFlag;\n    }\n  }(Object, new WeakMap));\n}\nexport default self.EventTarget;\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport EventTarget from '@ungap/event-target';\nimport { View, Renderer } from '../lib/renderer.js';\nimport { SchedulerState } from '../lib/scheduler.js';\nimport { AssetDecl } from './media.js';\n\nexport class NullRenderer extends EventTarget implements Renderer {\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tget ended() { return false; }\n\tget error() { return null; }\n\tget networkState() { return HTMLMediaElement.NETWORK_EMPTY; }\n\tget paused() { return true; }\n\tget readyState() { return HTMLMediaElement.HAVE_NOTHING; }\n\n\t// Called after placement in DOM.\n\tinit() {\n\t\tconsole.log(\"NULL-RENDERER: init\");\n\t}\n\n\tclose() {\n\t\tconsole.log(\"NULL-RENDERER: close\");\n\t}\n\n\tsetSetStateHook(_cb: any): void {}\n\tclearSetStateHook(): void {}\n\n\tsetSchedulerMessagePort(scheduler: MessagePort): void {\n\t\tconsole.log(\"NULL-RENDERER: setSchedulerMessagePort\", scheduler);\n\t}\n\n\t// Called by Scheduler or via Cluster as a follower.  This API receives\n\t// the near and immediate scheduling state to render the current and\n\t// next media asset, including the transition between the two.\n\tasync setState(_value: SchedulerState): Promise<void> {}\n\tasync setStateUnhooked(_value: SchedulerState): Promise<void> {}\n\n\tsetAssetTarget(assetTarget: HTMLElement): void {\n\t\tconsole.log(\"NULL-RENDERER: setAssetTarget\", assetTarget);\n\t}\n\n\tsetRenderTarget(renderTarget: HTMLElement): void {\n\t\tconsole.log(\"NULL-RENDERER: setRenderTarget\", renderTarget);\n\t}\n\n\tsetPixelRatio(value: number): void {\n\t\tconsole.log(\"NULL-RENDERER: setPixelRatio\", value);\n\t}\n\n\tsetSize(width: number, height: number): void {\n\t\tconsole.log(\"NULL-RENDERER: setSize\", width, height);\n\t}\n\n\tsetViews(views: View[]): void {\n\t\tconsole.log(\"NULL-RENDERER: setViews\", views);\n\t}\n\n\tasync setSources(_scope: string, _sources: AssetDecl[]): Promise<void> {\n\t\t// no-op\n\t}\n\n\t// on requestAnimationFrame() callback.\n\trender(_timestamp: DOMHighResTimeStamp): void {}\n\n\t// on requestIdleCallback() callback.\n\tidle(): void {}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n\nimport { z } from 'zod/v4';\nimport { ConfigShowModalFunction } from './config-modal.js';\nimport { WebAppConstructor } from './web-app.js';\nimport { WebGLAppConstructor } from './webgl-app.js';\nimport { LunaAppConstructor } from './luna-app.js';\n\nexport const AppManifestSchema = z.object({\n\tname: z.string(),\n\tdescription: z.string(),\n\tversion: z.string(),\n\tauthor: z.string(),\n\tlicense: z.string(),\n\tshowModal: z.custom<ConfigShowModalFunction>().optional(),\n\tConfigSchema: z.any().optional(),\n\tLunaApp: z.custom<LunaAppConstructor>().optional(),\n\tWebApp: z.custom<WebAppConstructor>().optional(),\n\tWebGLApp: z.custom<WebGLAppConstructor>().optional(),\n});\n\nexport type AppManifestSchema = z.infer<typeof AppManifestSchema>;\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nwindow.HTMLImageElement.prototype.decode =\n\twindow.HTMLImageElement.prototype.decode ||\n\tfunction(this: HTMLImageElement) {\n\t\t// If the image is already loaded, return a resolved promise.\n\t\tif(this.complete) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tlet timeout: ReturnType<typeof setTimeout> | undefined;\n\t\tconst promise = new Promise<string | Event>((resolve, reject) => {\n\t\t\tthis.onload = (event: string | Event) => {\n\t\t\t\tif(typeof timeout === \"undefined\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = undefined;\n\t\t\t\tresolve(event);\n\t\t\t};\n\t\t\tthis.onerror = (event: string | Event) => {\n\t\t\t\tif(typeof timeout === \"undefined\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = undefined;\n\t\t\t\tif(typeof event === \"string\"\n\t\t\t\t\t&& event !== \"timeout\")\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`HTMLImageElement.decode: Image load failed with error: ${event}`);\n\t\t\t\t} else if(event instanceof Event) {\n\t\t\t\t\tconsole.warn(`HTMLImageElement.decode: Image load failed with event: ${event.type}`);\n\t\t\t\t}\n\t\t\t\treject(event);\n\t\t\t};\n\t\t});\n\t\t// Reject the promise if the image fails to load or reasonable\n\t\t// time has passed.\n\t\ttimeout = setTimeout(() => {\n\t\t\tif(typeof timeout === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this.onerror) {\n\t\t\t\tconsole.warn(\"HTMLImageElement.decode: Timeout waiting for image load.\");\n\t\t\t\tthis.onerror(\"timeout\");\n\t\t\t}\n\t\t}, 10000);\n\t\treturn promise;\n\t};\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport EventTarget from '@ungap/event-target';\nimport { AppBaseParams, AppManifestSchema, WebApp } from '@dsbunny/app';\nimport { MediaDecl } from './media.js';\nimport \"./htmlimageelement-decode-polyfill.js\";\n\nexport abstract class AbstractWebAsset extends EventTarget {\n\telement: HTMLElement | null = document.createElement('div');\n\n\tprotected _src: string;\n\tprotected _opacity = 1;\n\tprotected _params: AppBaseParams;\n\t// Per `HTMLMediaElement`.\n\tprotected _duration: number;\n\tprotected _ended = false;\n\tprotected _error: any = null;\n\tprotected _networkState: number = HTMLMediaElement.NETWORK_NO_SOURCE;\n\tprotected _paused = true;\n\tprotected _readyState: number = HTMLMediaElement.HAVE_NOTHING;\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: any,\n\t\tduration: number,\n\t\tpublic readonly collection: WebCollection,\n\t) {\n\t\tsuper();\n\t\tconst url = new URL(src, self.location.href);\n\t\tthis._src = url.href;\n\t\tif(this._src.length !== 0) {\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_EMPTY;\n\t\t}\n\t\tthis._params = params;\n\t\tthis._duration = duration;\n\t}\n\n\tabstract close(): void;\n\tabstract paint(now: DOMHighResTimeStamp, remaining: number) : void;\n\n\tget params() { return this._params; }\n\t// Per `HTMLElement`.\n\tget className() { return this.element!.className; }\n\tset className(_value: string) { this.element!.className = _value; }\n\tget classList() { return this.element!.classList; }\n\tget style() { return this.element!.style; }\n\t// Per `HTMLMediaElement`.\n\tget currentSrc() { return this._src; }\n\tget currentTime() { return 0; }\n\tget duration() { return this._duration; }\n\tget ended() { return this._ended; }\n\tget error() { return this._error; }\n\tget networkState() { return this._networkState; }\n\tget paused() { return this._paused; }\n\tget readyState() { return this._readyState; }\n\tget src() { return this._src; }\n\tget srcObject(): MediaProvider | null { return null; }\n\tabstract load(): void;\n\tabstract pause(): void;\n\tabstract play(): Promise<void>;\n\t// Per `HTMLVideoElement`.\n\tget height() { return 0; }\n\tget width() { return 0; }\n}\n\n// super must be used to call functions only, operation is undefined when\n// accessing variables that are not hidden behind getters and setters.\nexport class WebImageAsset extends AbstractWebAsset {\n\tprotected _startTime: DOMHighResTimeStamp | number = NaN;\n\tprotected _lastTimeUpdate: DOMHighResTimeStamp = 0;\n\tprotected _currentTime: DOMHighResTimeStamp = 0;\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t\tcollection: WebImageCollection,\n\t) {\n\t\tsuper(src, params, duration, collection);\n\t}\n\n\tget image(): HTMLImageElement | null {\n\t\treturn this.element as HTMLImageElement;\n\t}\n\n\toverride close(): void {\n\t\tif(this.image === null) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(`unload image ... \"${this.src}\"`);\n\t\tthis.pause();\n\t\tconst collection = this.collection as WebImageCollection;\n\t\tcollection.release(this.image);\n\t\tthis.element = null;\n\t\tthis._readyState = HTMLMediaElement.HAVE_NOTHING;\n\t\tthis._networkState = HTMLMediaElement.NETWORK_EMPTY;\n\t\tthis._currentTime = 0;\n\t\tthis._startTime = NaN;\n\t\tthis._lastTimeUpdate = 0;\n\t\tthis._ended = false;\n\t\tthis._error = null;\n\t}\n\n\t// FIXME: delta for paused.\n\toverride paint(now: DOMHighResTimeStamp, _remaining: number): void {\n\t\tif(this.paused || this.ended) return;\n\t\tconst elapsed = (now - this._startTime) / 1000;\n\t\tthis._currentTime += elapsed;\n\t\tif(this._currentTime > this._duration) {\n\t\t\tthis._setEndedState();\n\t\t} else {\n\t\t\tif(Math.floor(this._currentTime) > this._lastTimeUpdate) {\n\t\t\t\tthis._lastTimeUpdate = this._currentTime;\n\t\t\t\tthis.dispatchEvent(new Event('timeupdate'));\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _setEndedState(): void {\n\t\tthis._currentTime = this._duration;\n\t\tthis._ended = true;\n\t\tthis._startTime = NaN;\n\t\tthis.dispatchEvent(new Event('ended'));\n\t}\n\n\toverride get params() { return super.params; }\n\t// Per `HTMLElement`.\n\toverride get className() { return super.className; }\n\toverride set className(value: string) { super.className = value; }\n\toverride get classList() { return super.classList; }\n\toverride get style() { return super.style; }\n\n\t// Per `HTMLMediaElement`.\n\toverride get currentSrc() { return super.currentSrc; }\n\toverride get currentTime() { return this._currentTime; }\n\toverride get duration() { return super.duration; }\n\toverride get ended() { return super.ended; }\n\toverride get error() { return super.error; }\n\toverride get networkState() { return super.networkState; }\n\toverride get paused() { return super.paused; }\n\toverride get readyState() { return super.readyState; }\n\toverride get src() { return super.src; }\n\toverride get srcObject() { return null; }\n\n\toverride load(): void {\n\t\t(async () => {\n\t\t\tconst collection = this.collection as WebImageCollection;\n\t\t\tconst img = this.element = collection.acquire();\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_LOADING;\n\t\t\ttry {\n\t\t\t\tconsole.log(`load image ... \"${this.src}\"`);\n\t\t\t\timg.crossOrigin = 'anonymous';\n\t\t\t\timg.setAttribute('src', this.src);\n\t\t\t\tawait img.decode();\n\t\t\t\tthis._readyState = HTMLMediaElement.HAVE_ENOUGH_DATA\n\t\t\t\tsuper.dispatchEvent(new Event('canplay'));\n\t\t\t} catch(encodingError: unknown) {\n\t\t\t\tconsole.warn(`Failed to load image: \"${this.src}\" Error: ${encodingError}`);\n\t\t\t\tthis._error = encodingError;\n\t\t\t\tthis._networkState = HTMLMediaElement.NETWORK_IDLE;\n\t\t\t\tcollection.release(img);\n\t\t\t\tsuper.dispatchEvent(new Event('error'));\n\t\t\t}\n\t\t})();\n\t}\n\n\toverride pause(): void {\n\t\tif(this._paused) return;\n\t\tthis._paused = true;\n\t}\n\n\toverride async play(): Promise<void> {\n\t\tthis._paused = false;\n\t\tif(this._ended) {\n\t\t\tthis._ended = false;\n\t\t\tthis._currentTime = 0;\n\t\t}\n\t\tif(isNaN(this._startTime)) {\n\t\t\tthis._startTime = performance.now() - this._currentTime;\n\t\t}\n\t}\n\n\t// Per `HTMLVideoElement`.\n\toverride get height() {\n\t\tif(this.image === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.image.height;\n\t}\n\toverride get width() {\n\t\tif(this.image === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.image.width;\n\t}\n}\n\nexport class WebVideoAsset extends AbstractWebAsset {\n\tprotected _redispatchEvent = (event: string | Event) => {\n\t\tsuper.dispatchEvent(new Event(event instanceof Event ? event.type : event));\n\t};\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t\tcollection: WebVideoCollection,\n\t) {\n\t\tsuper(src, params, duration, collection);\n\t}\n\n\tget video(): HTMLVideoElement | null {\n\t\treturn this.element as HTMLVideoElement;\n\t}\n\n\toverride close(): void {\n\t\tif(this.video === null) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(`unload video ... \"${this.src}\"`);\n\t\tthis.pause();\n\t\tconst collection = this.collection as WebVideoCollection;\n\t\tconst video = this.video;\n\t\tvideo.oncanplay = null;\n\t\tvideo.onended = null;\n\t\tvideo.onerror = null;\n\t\tvideo.onloadeddata = null;\n\t\tvideo.removeAttribute('src');\n\t\tcollection.release(video);\n\t\tthis.element = null;\n\t}\n\n\toverride paint(_now: DOMHighResTimeStamp, _remaining: number): void {}\n\n\toverride get params() { return super.params; }\n\t// Per `HTMLElement`.\n\toverride get className() { return super.className; }\n\toverride set className(value: string) { super.className = value; }\n\toverride get classList() { return super.classList; }\n\toverride get style() { return super.style; }\n\n\t// Per `HTMLMediaElement`.\n\toverride get currentSrc() {\n\t\tif(this.video === null) {\n\t\t\treturn super.currentSrc;\n\t\t}\n\t\treturn this.video.currentSrc;\n\t}\n\toverride get currentTime() {\n\t\tif(this.video === null) {\n\t\t\treturn super.currentTime;\n\t\t}\n\t\treturn this.video.currentTime;\n\t}\n\toverride get duration() {\n\t\tif(this.video === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.video.duration;\n\t}\n\toverride get ended() {\n\t\tif(this.video === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.video.ended;\n\t}\n\toverride get error() {\n\t\tif(this.video === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.video.error;\n\t}\n\toverride get networkState() {\n\t\tif(this.video === null) {\n\t\t\treturn HTMLMediaElement.NETWORK_EMPTY;\n\t\t}\n\t\treturn this.video.networkState;\n\t}\n\toverride get paused() {\n\t\tif(this.video === null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.video.paused;\n\t}\n\toverride get readyState() {\n\t\tif(this.video === null) {\n\t\t\treturn HTMLMediaElement.HAVE_NOTHING;\n\t\t}\n\t\treturn this.video.readyState;\n\t}\n\toverride get src() { return super.src; }\n\toverride get srcObject() {\n\t\tif(this.video === null) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.video.srcObject;\n\t}\n\n\toverride load(): void {\n\t\tconst collection = this.collection as WebVideoCollection;\n\t\tconst video = this.element = collection.acquire();\n\t\tvideo.oncanplay = this._redispatchEvent;\n\t\tvideo.onended = this._redispatchEvent;\n\t\tvideo.onerror = this._redispatchEvent;\n\t\t// Avoid \"WebGL: INVALID_VALUE: texImage2D: no video\".\n\t\tvideo.onloadeddata = this._redispatchEvent;\n\t\ttry {\n\t\t\tconsole.log(`load video ... \"${this.src}\"`);\n\t\t\tvideo.crossOrigin = 'anonymous';\n\t\t\tvideo.setAttribute('src', this.src);\n\t\t\tvideo.load();\n\t\t} catch(encodingError: unknown) {\n\t\t\tcollection.release(video);\n\t\t\tthrow encodingError;\n\t\t}\n\t}\n\n\toverride pause(): void {\n\t\tif(this.video === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.video.pause();\n\t}\n\n\toverride async play(): Promise<void> {\n\t\tif(this.video === null) {\n\t\t\treturn;\n\t\t}\n\t\tawait this.video.play();\n\t}\n\n\t// Per `HTMLVideoElement`.\n\toverride get height() {\n\t\tif(this.video === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.video.height;\n\t}\n\toverride get width() {\n\t\tif(this.video === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.video.width;\n\t}\n}\n\nexport class WebAppAsset extends AbstractWebAsset {\n\tprotected _app: WebApp | null = null;\n\tprotected _redispatchEvent = (event: string | Event) => {\n\t\t//console.log(`redispatch event: ${event instanceof Event ? event.type : event}`);\n\t\tsuper.dispatchEvent(new Event(event instanceof Event ? event.type : event));\n\t};\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t\tcollection: WebAppCollection,\n\t) {\n\t\tsuper(src, params, duration, collection);\n\t}\n\n\tget container(): HTMLElement | null {\n\t\treturn this.element;\n\t}\n\n\toverride close(): void {\n\t\tif(this.element === null) {\n\t\t\treturn\n\t\t}\n\t\tconsole.log(`unload app ... \"${this.src}\"`);\n\t\tthis.pause();\n\t\tconst collection = this.collection as WebAppCollection;\n\t\tif(this._app !== null) {\n\t\t\tthis._app.close();\n\t\t\tthis._app.removeEventListener('canplay', this._redispatchEvent);\n\t\t\tthis._app.removeEventListener('ended', this._redispatchEvent);\n\t\t\tthis._app.removeEventListener('error', this._redispatchEvent);\n\t\t\tthis._app = null;\n\t\t}\n\t\tcollection.release(this.container!);\n\t\tthis.element = null;\n\t}\n\n\toverride paint(now: DOMHighResTimeStamp, remaining: number): void {\n\t\tif(this.paused || this.ended) return;\n\t\tif(this._app === null){\n\t\t\treturn;\n\t\t}\n\t\tthis._app.animate(now, remaining);\n\t}\n\n\toverride get params() { return super.params; }\n\t// Per `HTMLElement`.\n\toverride get className() { return super.className; }\n\toverride set className(value: string) { super.className = value; }\n\toverride get classList() { return super.classList; }\n\toverride get style() { return super.style; }\n\n\t// Per HTMLMediaElement.\n\toverride get currentSrc() {\n\t\tif(this._app === null) {\n\t\t\treturn super.currentSrc;\n\t\t}\n\t\treturn this._app.currentSrc;\n\t}\n\toverride get currentTime() {\n\t\tif(this._app === null) {\n\t\t\treturn super.currentTime;\n\t\t}\n\t\treturn this._app.currentTime;\n\t}\n\toverride get duration() {\n\t\tif(this._app === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this._app.duration;\n\t}\n\toverride get ended() {\n\t\tif(this._app === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._app.ended;\n\t}\n\toverride get error() {\n\t\tif(this._app === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._app.error;\n\t}\n\toverride get networkState() {\n\t\tif(this._app === null) {\n\t\t\treturn HTMLMediaElement.NETWORK_EMPTY;\n\t\t}\n\t\treturn this._app.networkState;\n\t}\n\toverride get paused() {\n\t\tif(this._app === null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this._app.paused;\n\t}\n\toverride get readyState() {\n\t\tif(this._app === null) {\n\t\t\treturn HTMLMediaElement.HAVE_NOTHING;\n\t\t}\n\t\treturn this._app.readyState;\n\t}\n\toverride get src() { return super.src; }\n\toverride get srcObject() { return super.srcObject; }\n\n\toverride load(): void {\n\t\t(async () => {\n\t\t\tconst collection = this.collection as WebAppCollection;\n\t\t\tconst renderRoot = this.element = collection.acquire();\n\t\t\ttry {\n\t\t\t\tconsole.log(`import module ... \"${this.src}\"`);\n\t\t\t\tconst manifest = await collection.importModule(this.src);\n\t\t\t\tconsole.log(`create WebApp ... \"${this.src}\"`);\n\t\t\t\tconst params = {\n\t\t\t\t\t...this.params,\n\t\t\t\t\tsrc: this.src,\n\t\t\t\t\tduration: super.duration,  // WARNING: `super` not `this`.\n\t\t\t\t}\n\t\t\t\tconst app = this._app = manifest.WebApp!.create(\n\t\t\t\t\trenderRoot,\n\t\t\t\t\tparams,\n\t\t\t\t);\n\t\t\t\tapp.addEventListener('canplay', this._redispatchEvent);\n\t\t\t\tapp.addEventListener('ended', this._redispatchEvent);\n\t\t\t\tapp.addEventListener('error', this._redispatchEvent);\n\t\t\t\tconsole.log(`init \"${manifest.name}\" with params:`, params);\n\t\t\t\tapp.load();\n\t\t\t} catch(initError: unknown) {\n\t\t\t\tconsole.warn(`Failed to load app: \"${this.src}\"`, initError);\n\t\t\t\tcollection.release(renderRoot);\n\t\t\t\tsuper.dispatchEvent(new Event('error'));\n\t\t\t}\n\t\t})();\n\t}\n\n\toverride pause(): void {\n\t\tif(this._app === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis._app.pause();\n\t}\n\n\toverride async play(): Promise<void> {\n\t\tif(this._app === null) {\n\t\t\treturn;\n\t\t}\n\t\tawait this._app.play();\n\t}\n\n\t// Per `HTMLVideoElement`.\n\toverride get height() {\n\t\tif(this._app === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this._app.height;\n\t}\n\toverride get width() {\n\t\tif(this._app === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this._app.width;\n\t}\n}\n\nexport abstract class WebCollection {\n\tconstructor(readonly renderRoot: (HTMLElement | ShadowRoot)) {}\n\tabstract acquire(): HTMLImageElement | HTMLVideoElement | HTMLElement;\n\tabstract createWebAsset(src: string, params: any, duration: number): WebImageAsset | WebVideoAsset | WebAppAsset;\n\tabstract release(asset: HTMLImageElement | HTMLVideoElement | HTMLElement): void;\n\tabstract clear(): void;\n}\n\nexport class WebImageCollection extends WebCollection {\n\tprotected _images: HTMLImageElement[] = [];\n\tprotected _count = 0;\n\n\tconstructor(renderRoot: (HTMLElement | ShadowRoot)) {\n\t\tsuper(renderRoot);\n\t}\n\n\t// TSC forces pop() to return undefined even if length is checked.\n\toverride acquire(): HTMLImageElement {\n\t\tlet img = this._images.pop();\n\t\tif(typeof img === \"undefined\") {\n\t\t\timg = new Image();\n\t\t\tthis._count++;\n\t\t\tthis.renderRoot.appendChild(img);\n\t\t} else {\n\t\t\timg.className = '';\n\t\t}\n\t\treturn img;\n\t}\n\n\toverride createWebAsset(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t): WebImageAsset {\n\t\treturn new WebImageAsset(src, params, duration, this);\n\t}\n\n\toverride release(img: HTMLImageElement): void {\n\t\timg.removeAttribute('src');\n\t\tif(this._count > 2) {\n\t\t\tthis.renderRoot.removeChild(img);\n\t\t\tthis._count--;\n\t\t\treturn;\n\t\t}\n\t\timg.className = 'spare';\n\t\timg.style.opacity = '';\n\t\timg.style.visibility = '';\n\t\tthis._images.push(img);\n\t}\n\n\t// Clears the trash stack, not the elements acquired by the user.\n\toverride clear(): void {\n\t\tfor(const img of this._images) {\n\t\t\tthis.renderRoot.removeChild(img);\n\t\t}\n\t\tthis._images = [];\n\t\tthis._count = 0;\n\t}\n}\n\nexport class WebVideoCollection extends WebCollection {\n\tprotected _videos: HTMLVideoElement[] = [];\n\tprotected _count = 0;\n\n\tconstructor(renderRoot: (HTMLElement | ShadowRoot)) {\n\t\tsuper(renderRoot);\n\t}\n\n\toverride acquire(): HTMLVideoElement {\n\t\tlet video = this._videos.pop();\n\t\tif(typeof video === \"undefined\") {\n\t\t\tvideo = document.createElement('video');\n\t\t\tthis._count++;\n\t\t\tvideo.autoplay = false;\n\t\t\tvideo.crossOrigin = 'anonymous';\n\t\t\tvideo.muted = true;\n\t\t\tvideo.playsInline = true;\n\t\t\tvideo.preload = 'auto';  // The video will be played soon.\n\t\t\t// Video must be within DOM to playback.\n\t\t\tthis.renderRoot.appendChild(video);\n\t\t} else {\n\t\t\tvideo.className = '';\n\t\t}\n\t\treturn video;\n\t}\n\n\toverride createWebAsset(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\t_duration: number,\n\t): WebVideoAsset {\n\t\treturn new WebVideoAsset(src, params, NaN, this);\n\t}\n\n\toverride release(video: HTMLVideoElement): void {\n\t\tif(!video.paused) {\n\t\t\tvideo.pause();\n\t\t}\n\t\t// Some platforms treat `video.src = ''` as loading the current\n\t\t// location, so we use `video.removeAttribute('src')` instead.\n\t\tvideo.removeAttribute('src');\n\t\tif(this._count > 2) {\n\t\t\tthis.renderRoot.removeChild(video);\n\t\t\tthis._count--;\n\t\t\treturn;\n\t\t}\n\t\tvideo.className = 'spare';\n\t\tvideo.style.opacity = '';\n\t\tvideo.style.visibility = '';\n\t\tthis._videos.push(video);\n\t}\n\n\toverride clear(): void {\n\t\tfor(const video of this._videos) {\n\t\t\tthis.renderRoot.removeChild(video);\n\t\t}\n\t\tthis._videos = [];\n\t\tthis._count = 0;\n\t}\n}\n\nexport class WebAppCollection extends WebCollection {\n\tprotected _manifests = new Map<string, AppManifestSchema>();\n\tprotected _roots: HTMLElement[] = [];\n\tprotected _count = 0;\n\n\tconstructor(\n\t\trenderRoot: (HTMLElement | ShadowRoot),\n\t) {\n\t\tsuper(renderRoot);\n\t}\n\n\toverride acquire(): HTMLElement {\n\t\tlet root = this._roots.pop();\n\t\tif(typeof root === \"undefined\") {\n\t\t\troot = document.createElement('article');\n\t\t\tthis._count++;\n\t\t\tthis.renderRoot.appendChild(root);\n\t\t} else {\n\t\t\troot.className = '';\n\t\t}\n\t\treturn root;\n\t}\n\n\tasync importModule(src: string): Promise<AppManifestSchema> {\n\t\tlet manifest = this._manifests.get(src);\n\t\tif(typeof manifest === 'undefined') {\n\t\t\tconsole.log(`import app manifest ... \"${src}\"`);\n\t\t\tconst module = await import(src);\n\t\t\tconsole.log(`validate app manifest ... \"${src}\"`);\n\t\t\tconst result = AppManifestSchema.safeParse(module.default);\n\t\t\tconsole.log(`app manifest validation result: ${result.success} ... \"${src}\"`);\n\t\t\tif(!result.success) {\n\t\t\t\tthrow new Error(`Invalid app manifest: \"${src}\"`);\n\t\t\t}\n\t\t\tif(!result.data.WebApp) {\n\t\t\t\tthrow new Error(`WebApp constructor not found in manifest: ${src}`);\n\t\t\t}\n\t\t\tmanifest = result.data;\n\t\t\tthis._manifests.set(src, manifest);\n\t\t}\n\t\treturn manifest;\n\t}\n\n\toverride createWebAsset(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t): WebAppAsset {\n\t\treturn new WebAppAsset(src, params, duration, this);\n\t}\n\n\toverride release(root: HTMLElement): void {\n\t\tif(this._count > 2) {\n\t\t\tthis.renderRoot.removeChild(root);\n\t\t\tthis._count--;\n\t\t\treturn;\n\t\t}\n\t\troot.className = 'spare';\n\t\troot.style.opacity = '';\n\t\troot.style.visibility = '';\n\t\tthis._roots.push(root);\n\t}\n\n\toverride clear(): void {\n\t\tfor(const root of this._roots) {\n\t\t\tthis.renderRoot.removeChild(root);\n\t\t}\n\t\tthis._roots = [];\n\t\tthis._manifests.clear();\n\t\tthis._count = 0;\n\t}\n}\n\nexport class WebAssetManager {\n\tprotected _renderTarget: HTMLElement | undefined;\n\tprotected _collection: Map<string, WebCollection> = new Map();\n\n\tsetAssetTarget(renderTarget: HTMLElement): void {\n\t\tthis._renderTarget = renderTarget;\n\t}\n\n\tprotected _createCollection(\n\t\trenderTarget: HTMLElement,\n\t): Map<string, WebCollection> {\n\t\t// TypeScript assumes iterator of first type.\n\t\tconst collection = new Map([\n\t\t\t['HTMLImageElement', new WebImageCollection(renderTarget) as WebCollection],\n\t\t\t['HTMLVideoElement', new WebVideoCollection(renderTarget) as WebCollection],\n\t\t\t['CustomElement', new WebAppCollection(renderTarget) as WebCollection],\n\t\t]);\n\t\treturn collection;\n\t}\n\n\t// decl: { type, href }\n\t// Returns: asset.\n\tcreateWebAsset(decl: MediaDecl): AbstractWebAsset {\n\t\tif(this._collection.size === 0) {\n\t\t\tif(typeof this._renderTarget === \"undefined\") {\n\t\t\t\tthrow new Error(\"undefined render target.\");\n\t\t\t}\n\t\t\tthis._collection = this._createCollection(this._renderTarget);\n\t\t}\n\t\tconst collection = this._collection.get(decl['@type']);\n\t\tif(typeof collection === \"undefined\") {\n\t\t\tthrow new Error('Undefined collection.');\n\t\t}\n\t\treturn collection.createWebAsset(\n\t\t\tdecl.href,\n\t\t\tdecl.params,\n\t\t\tdecl.duration,\n\t\t);\n\t}\n\n\tclear(): void {\n\t\tfor(const value of this._collection.values()) {\n\t\t\tvalue.clear();\n\t\t}\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n\nimport { AbstractWebAsset } from './web-media.js';\n\nexport class WebRendererAsset {\n\tis_loading = false;\n\thas_element = false;\n\tend_time = NaN;\n\tprotected _ref_count = 0;\n\n\tconstructor(\n\t\treadonly id: string,\n\t\tpublic web_asset: AbstractWebAsset,\n\t) {}\n\n\tget paused() { return this.web_asset.paused; }\n\tget ended() { return this.web_asset.ended; }\n\tget error() { return this.web_asset.error; }\n\tget readyState() { return this.web_asset.readyState; }\n\tget networkState() { return this.web_asset.networkState; }\n\tget element() { return this.web_asset.element; }\n\tget currentSrc() { return this.web_asset.currentSrc; }\n\tget currentTime() { return this.web_asset.currentTime; }\n\n\tget className() { return this.web_asset.className; }\n\tset className(value: string) { this.web_asset.className = value; }\n\tget classList() { return this.web_asset.classList; }\n\tget style() { return this.web_asset.style; }\n\n\tload(): void {\n\t\tif(this.readyState !== HTMLMediaElement.HAVE_NOTHING) {\n\t\t\treturn;\n\t\t}\n\t\tif(this.networkState !== HTMLMediaElement.NETWORK_EMPTY) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tthis.web_asset.load();\n\t\t} catch(error: unknown) {\n\t\t\tconsole.error(`WEB-ASSET: ${error}`);\n\t\t}\n\t}\n\n\tasync play() {\n\t\tawait this.web_asset.play();\n\t}\n\n\tpaint(now: number, remaining: number) {\n\t\tthis.web_asset.paint(now, remaining);\n\t}\n\n\tpause() {\n\t\tthis.web_asset.pause();\n\t}\n\n\tclose(): void {\n\t\tthis.web_asset.close();\n\t}\n\n\tget ref_count() { return this._ref_count; }\n\n\tref() {\n\t\tthis._ref_count++;\n\t}\n\n\tunref() {\n\t\tthis._ref_count--;\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport * as Comlink from 'comlink';\nimport EventTarget from '@ungap/event-target';\nimport { View, Renderer } from './renderer.js';\nimport {\n\tSchedulerState,\n\tSchedulerAssetDeclWithRemainingTime,\n\tSchedulerAssetTransition,\n} from './scheduler.js';\nimport { AssetDecl, MediaDecl } from './media.js';\nimport { WebAssetManager } from './web-media.js';\nimport { Prefetch } from './prefetch.js';\nimport { WebRendererAsset } from './web-renderer-asset.js';\nimport \"./htmlimageelement-decode-polyfill.js\";\n\nconst DEBUG_SHOW_DETAIL = true;\n\n// REF: http://jsfiddle.net/unLSJ/\nfunction replacer(_match: any, pIndent: any, pKey: any, pVal: any, pEnd: any): any {\n\tconst key = '<span class=json-key>';\n\tconst val = '<span class=json-value>';\n\tconst str = '<span class=json-string>';\n\tlet r = pIndent || '';\n\tif(pKey) {\n\t\tr = r + key + pKey.replace(/[\": ]/g, '') + '</span>: ';\n\t}\n\tif(pVal) {\n\t\tr = r + (pVal[0] == '\"' ? str : val) + pVal + '</span>';\n\t}\n\treturn r + (pEnd || '');\n}\n\nfunction prettyPrint(obj: any): string {\n\tconst jsonLine = /^( *)(\"[\\w]+\": )?(\"[^\"]*\"|[\\w.+-]*)?([,[{])?$/mg;\n\treturn JSON.stringify(obj, null, 3)\n\t\t.replace(/&/g, '&amp;').replace(/\\\\\"/g, '&quot;')\n\t\t.replace(/</g, '&lt;').replace(/>/g, '&gt;')\n\t\t.replace(jsonLine, replacer);\n}\n\nfunction minimize(value: SchedulerState): any {\n\tconst obj = {\n\t\tcurrentTime: value.currentTime,\n\t\teventSeries: value.eventSeries,\n\t\tmediaList: value.mediaList,\n\t\tmediaCurrent: value.mediaCurrent && {\n\t\t\thref: value.mediaCurrent.decl.href,\n\t\t\tduration: value.mediaCurrent.decl.duration,\n\t\t\tremainingTimeMs: value.mediaCurrent.remainingTimeMs,\n\t\t},\n\t\tmediaNext: value.mediaNext && {\n\t\t\thref: value.mediaNext.decl.href,\n\t\t\tduration: value.mediaNext.decl.duration,\n\t\t\tremainingTimeMs: value.mediaNext.remainingTimeMs,\n\t\t},\n\t\ttransition: value.transition && {\n\t\t\tpercent: value.transition.percent,\n\t\t},\n\t};\n\treturn obj;\n}\n\nexport class WebRenderer extends EventTarget implements Renderer {\n\tprotected _renderTarget: HTMLElement | null = null;\n\tprotected _asset_manager = new WebAssetManager();\n\tprotected _transition_percent = 0;\n\tprotected _transition_percent_speed = 0;\n\tprotected _network_loading_count = 0;\n\tprotected _current_renderer_asset: WebRendererAsset | null = null;\n\tprotected _next_renderer_asset: WebRendererAsset | null = null;\n\tprotected _map1_renderer_asset: WebRendererAsset | null = null;\n\tprotected _map2_renderer_asset: WebRendererAsset | null = null;\n\tprotected _renderer_asset_cache: Map<string, WebRendererAsset> = new Map();\n\tprotected _renderer_asset_trash: Map<string, WebRendererAsset> = new Map();\n\tprotected _set_state_hook: any;\n\tprotected _asset_prefetch: Prefetch;\n\t// Per HTMLMediaElement.\n\tprotected _ended = false;\n\tprotected _error = null;\n\tprotected _networkState: number = HTMLMediaElement.NETWORK_EMPTY;\n\tprotected _paused = true;\n\tprotected _readyState: number = HTMLMediaElement.HAVE_NOTHING;\n\n\tprotected _debug = document.createElement('div');\n\n\tconstructor(prefetchFactory: { new(): Prefetch }) {\n\t\tsuper();\n\t\tthis._asset_prefetch = new prefetchFactory();\n\t\tif(DEBUG_SHOW_DETAIL) {\n\t\t\tthis._debug.className = 'debug';\n\t\t\tdocument.body.appendChild(this._debug);\n\t\t}\n\t}\n\n\tget ended() { return this._ended; }\n\tget error() { return this._error; }\n\tget networkState() { return this._networkState; }\n\tget paused() { return this._paused; }\n\tget readyState() { return this._readyState; }\n\n\t// Called after placement in DOM.\n\tinit() {\n\t\tconsole.groupCollapsed(\"WEB-RENDERER: init\");\n\t\tconsole.groupEnd();\n\t}\n\n\tclose() {\n\t\tconsole.log(\"WEB-RENDERER: close\");\n\t\tfor(const asset of this._renderer_asset_cache.values()) {\n\t\t\t// Hide from view.\n\t\t\tasset.style.visibility = \"hidden\";\n\t\t\tasset.close();\n\t\t}\n\t\tthis._renderer_asset_cache.clear();\n\t}\n\n\tsetSetStateHook(cb: any): void {\n\t\tthis._set_state_hook = cb;\n\t}\n\n\tclearSetStateHook(): void {\n\t\tthis._set_state_hook = undefined;\n\t}\n\n\tsetSchedulerMessagePort(scheduler: MessagePort): void {\n\t\tconsole.log(\"WEB-RENDERER: setSchedulerMessagePort\", scheduler);\n\t\tComlink.expose({\n\t\t\tsetState: (value: SchedulerState) => this.setState(value),\n\t\t\tsetSources: async (scope: string, decls: MediaDecl[]) => {\n\t\t\t\treturn await this.setSources(scope, decls.map(decl => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'@type': decl['@type'],\n\t\t\t\t\t\tid: decl.id,\n\t\t\t\t\t\thref: decl.href,\n\t\t\t\t\t\tsize: decl.size,\n\t\t\t\t\t\thash: decl.hash,\n\t\t\t\t\t\tmd5: decl.md5,\n\t\t\t\t\t\tintegrity: decl.integrity,\n\t\t\t\t\t} as AssetDecl;\n\t\t\t\t}));\n\t\t\t},\n\t\t}, scheduler);\n\t}\n\n\t// Called by Scheduler or via Cluster as a follower.  This API receives\n\t// the near and immediate scheduling state to render the current and\n\t// next media asset, including the transition between the two.\n\tasync setState(value: SchedulerState): Promise<void> {\n\t\t// In a cluster we need to forward the state to all nodes\n\t\t// before we can process.\n\t\tif(typeof this._set_state_hook !== \"undefined\") {\n\t\t\tthis._set_state_hook(value);\n\t\t\treturn;\n\t\t}\n\t\tawait this.setStateUnhooked(value);\n\t}\n\n\tprotected _lastDebug = \"\";\n\tasync setStateUnhooked(value: SchedulerState): Promise<void> {\n\t\tif(DEBUG_SHOW_DETAIL) {\n\t\t\tconst html = prettyPrint(minimize(value));\n\t\t\tif(html !== this._lastDebug) {\n\t\t\t\tthis._debug.innerHTML = this._lastDebug = html;\n\t\t\t}\n\t\t}\n\t\tawait this._onSchedulerCurrent(value.mediaCurrent);\n\t\tthis._onSchedulerNext(value.mediaNext);\n\t\tawait this._onSchedulerTransition(value.transition);\n\t}\n\n\tsetAssetTarget(assetTarget: HTMLElement): void {\n\t\tconsole.log(\"WEB-RENDERER: setAssetTarget\", assetTarget);\n\t\tthis._asset_manager.setAssetTarget(assetTarget);\n\t}\n\n\tsetRenderTarget(renderTarget: HTMLElement): void {\n\t\tconsole.log(\"WEB-RENDERER: setRenderTarget\", renderTarget);\n\t\tthis._renderTarget = renderTarget;\n\t}\n\n\tsetPixelRatio(value: number): void {\n\t\tconsole.log(\"WEB-RENDERER: setPixelRatio\", value);\n\t\t// TBD: translate to CSS.\n\t}\n\n\tsetSize(width: number, height: number): void {\n\t\tconsole.log(\"WEB-RENDERER: setSize\", width, height);\n\t\tif(this._renderTarget !== null) {\n\t\t\tthis._renderTarget.style.width = `${width}px`;\n\t\t\tthis._renderTarget.style.height = `${height}px`;\n\t\t}\n\t}\n\n\tsetViews(views: View[]): void {\n\t\tconsole.log(\"WEB-RENDERER: setViews\", views);\n\t}\n\n\tasync setSources(scope: string, sources: AssetDecl[]): Promise<void> {\n\t\tconsole.log(\"WEB-RENDERER: setSources\", scope, sources);\n\t\tawait this._asset_prefetch.acquireSources(scope, sources);\n\t}\n\n\t// on requestAnimationFrame() callback.\n\tprotected _previousTimestamp = 0;\n\trender(timestamp: DOMHighResTimeStamp): void {\n//\t\tconsole.log('update', timestamp);\n\t\tconst elapsed = timestamp - this._previousTimestamp;\n\t\tthis._previousTimestamp = timestamp;\n\t\tif(this._canPaintCurrent()) {\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"current asset is null.\");\n\t\t\t}\n\t\t\tconst remaining = this._current_renderer_asset.end_time - timestamp;\n\t\t\ttry {\n\t\t\t\tthis._paintCurrent(timestamp, remaining);\n\t\t\t} catch(ex) {\n\t\t\t\tconsole.error(ex);\n\t\t\t\tconsole.error(this._current_renderer_asset);\n\t\t\t}\n\t\t} else if(this._hasWaitingDuration()) {\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"current asset is null.\");\n\t\t\t}\n\t\t\tconst remaining = this._current_renderer_asset.end_time - timestamp;\n\t\t\tthis._paintWaitingDuration(timestamp, remaining);\n\t\t} else {\n\t\t\tthis._paintWaiting(timestamp);\n\t\t}\n\t\tif(this._canPaintNext()) {\n\t\t\tif(this._next_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"next asset is null.\");\n\t\t\t}\n\t\t\tconst remaining = this._next_renderer_asset.end_time - timestamp;\n\t\t\ttry {\n\t\t\t\tthis._paintNext(timestamp, remaining);\n\t\t\t} catch(ex) {\n\t\t\t\tconsole.error(ex);\n\t\t\t\tconsole.error(this._next_renderer_asset);\n\t\t\t}\n\t\t}\n\t\tthis._interpolateTransition(elapsed);\n\t}\n\n\t// on requestIdleCallback() callback.\n\tidle(): void {\n\t\tthis._emptyAssetTrash();\n\t}\n\n\tprotected _setTransitionPercent(\n\t\tpercent: number,\n\t): void {\n\t\tif(this._map1_renderer_asset !== null) {\n\t\t\tconst rounded = Math.round((1 - percent + Number.EPSILON) * 100) / 100\n\t\t\tthis._map1_renderer_asset.style.opacity = rounded.toString();\n\t\t}\n\t\tif(this._map2_renderer_asset !== null) {\n\t\t\tthis._map2_renderer_asset.style.opacity = '1';\n\t\t}\n\t\tthis._transition_percent = percent;\n\t}\n\n\tprotected _interpolateTransition(elapsed: number): void {\n\t\tif(this._transition_percent_speed !== 0) {\n\t\t\tthis._transition_percent += (this._transition_percent_speed * elapsed) / 1000;\n\t\t\tif(this._transition_percent > 1) {\n\t\t\t\tthis._transition_percent = 1;\n\t\t\t\tthis._transition_percent_speed = 0;\n\t\t\t}\n\t\t\tthis._setTransitionPercent(this._transition_percent);\n\t\t}\n\t}\n\n\tprotected async _fetchImage(url: string): Promise<HTMLImageElement> {\n\t\tconsole.log(\"WEB-RENDERER: _fetchImage\", url);\n\t\tconst img = await new Promise<HTMLImageElement>((resolve, reject) => {\n\t\t\tconst img = new Image();\n\t\t\timg.src = url;\n\t\t\timg.decode()\n\t\t\t.then(() => {\n\t\t\t\tresolve(img);\n\t\t\t})\n\t\t\t.catch(encodingError => {\n\t\t\t\treject(encodingError);\n\t\t\t});\n\t\t});\nconsole.info(\"WEB-RENDERER: loaded displacement map\", img.src);\n\t\treturn img;\n\t}\n\n//\tprotected _onSchedulerError(err: Error): void {\n//\t\tconsole.error(err);\n//\t}\n\n\t// This media asset.\n\tprotected async _onSchedulerCurrent(current: SchedulerAssetDeclWithRemainingTime | null): Promise<void> {\n\t\tif(current !== null) {\n\t\t\tif(!this._isMediaReady(current.decl)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this._current_renderer_asset === null)\n\t\t\t{\n//console.info(current.decl.href, current.remainingTimeMs);\n\t\t\t\tthis._current_renderer_asset = await this._updateCurrent(current.decl);\n\t\t\t\tthis._current_renderer_asset.end_time = (typeof current.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(current.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._current_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEB-RENDERER: current\", this._current_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(current.decl.id !== this._current_renderer_asset.id)\n\t\t\t{\n//console.info(current.decl.href, current.remainingTimeMs);\n\t\t\t\tthis._closeCurrent();\n\t\t\t\tif(this._next_renderer_asset !== null\n\t\t\t\t\t&& current.decl.id === this._next_renderer_asset.id)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(\"WEB-RENDERER: current <- next\");\n\t\t\t\t\tthis._current_renderer_asset = await this._updateCurrentFromNext();\n\t\t\t\t} else {\n\t\t\t\t\tthis._current_renderer_asset = await this._updateCurrent(current.decl);\n\t\t\t\t}\n\t\t\t\tthis._current_renderer_asset.end_time = (typeof current.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(current.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._current_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEB-RENDERER: current\", this._current_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(this._current_renderer_asset !== null)\n\t\t\t{\n\t\t\t\tthis._current_renderer_asset = await this._updateCurrent(current.decl);\n\t\t\t\tthis._current_renderer_asset.end_time = (typeof current.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(current.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t}\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"current asset is null.\");\n\t\t\t}\n\t\t} else if(this._current_renderer_asset !== null) {\n\t\t\tthis._closeCurrent();\n\t\t\tconsole.log(`WEB-RENDERER: current null`);\n\t\t}\n\t}\n\n\tprotected _onSchedulerNext(next: SchedulerAssetDeclWithRemainingTime | null): void {\n\t\t// Next media asset.\n\t\tif(next !== null) {\n\t\t\tif(!this._isMediaReady(next.decl)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this._next_renderer_asset === null) {\n\t\t\t\tthis._next_renderer_asset = this._updateNext(next.decl);\n\t\t\t\tthis._next_renderer_asset.end_time = (typeof next.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(next.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._next_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEB-RENDERER: next\", this._next_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(next.decl.id !== this._next_renderer_asset.id) {\n\t\t\t\tthis._closeNext();\n\t\t\t\tthis._next_renderer_asset = this._updateNext(next.decl);\n\t\t\t\tthis._next_renderer_asset.end_time = (typeof next.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(next.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._next_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEB-RENDERER: next\", this._next_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(this._next_renderer_asset !== null)\n\t\t\t{\n\t\t\t\tthis._next_renderer_asset = this._updateNext(next.decl);\n\t\t\t\tthis._next_renderer_asset.end_time = (typeof next.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(next.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t}\n\t\t\tif(this._next_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"next asset is null.\");\n\t\t\t}\n\t\t} else if(this._next_renderer_asset !== null) {\n\t\t\tthis._closeNext();\n\t\t\tconsole.log(`WEB-RENDERER: next null`);\n\t\t}\n\t}\n\n\tprotected async _onSchedulerTransition(transition: SchedulerAssetTransition | null): Promise<void> {\n\t\t// Resources for transitions, explicitly details textures to\n\t\t// avoid confusion when crossing boundary between two assets.\n\t\tif(transition !== null) {\n\t\t\tconst from_asset = this._renderer_asset_cache.get(transition.from.decl.id);\n\t\t\tif(typeof from_asset !== \"undefined\"\n\t\t\t\t&& from_asset.element !== null\n\t\t\t\t&& from_asset.id !== this._map1_renderer_asset?.id)\n\t\t\t{\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tfrom_asset.ref();\n\t\t\t\tthis._setMap1Asset(from_asset);\n\t\t\t}\n\t\t\tconst to_asset = this._renderer_asset_cache.get(transition.to.decl.id);\n\t\t\tif(typeof to_asset !== \"undefined\"\n\t\t\t\t&& to_asset.element !== null\n\t\t\t\t&& to_asset.id !== this._map2_renderer_asset?.id)\n\t\t\t{\n\t\t\t\tif(this._map2_renderer_asset !== null) {\n\t\t\t\t\tthis._map2_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tto_asset.ref();\n\t\t\t\tthis._setMap2Asset(to_asset);\n\t\t\t}\n\t\t\tif(transition.percent !== this._transition_percent) {\n\t\t\t\tthis._setTransitionPercent(transition.percent);\n\t\t\t}\n\t\t\tif(transition.percentSpeed !== this._transition_percent_speed) {\n\t\t\t\tthis._transition_percent_speed = transition.percentSpeed;\n\t\t\t}\n\t\t} else {  // Transition finished, follow settings per \"current\".\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t\tthis._setMap1Asset(null);\n\t\t\t\t}\n\t\t\t} else if(this._current_renderer_asset.element !== null\n\t\t\t\t&& this._current_renderer_asset.id !== this._map1_renderer_asset?.id)\n\t\t\t{\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tthis._current_renderer_asset.ref();\n\t\t\t\tthis._setMap1Asset(this._current_renderer_asset);\n\t\t\t}\n\t\t\tif(this._map2_renderer_asset !== null) {\n\t\t\t\tthis._map2_renderer_asset.unref();\n\t\t\t\tthis._setMap2Asset(null);\n\t\t\t}\n\t\t\tif(this._transition_percent !== 0) {\n\t\t\t\tthis._setTransitionPercent(0);\n\t\t\t}\n\t\t\tif(this._transition_percent_speed !== 0) {\n\t\t\t\tthis._transition_percent_speed = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _networkLoadingRef(): void {\n\t\tif(this._network_loading_count === 0) {\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_LOADING;\n\t\t}\n\t\tthis._network_loading_count++;\n\t}\n\n\tprotected _networkLoadingUnref(): void {\n\t\tthis._network_loading_count--;\n\t\tif(this._network_loading_count === 0) {\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_IDLE;\n\t\t}\n\t}\n\n\tprotected _emptyAssetTrash(): void {\n\t\tconst remove_list: string[] = [];\n\t\tfor(const [id, asset] of this._renderer_asset_trash) {\n\t\t\tif(asset.ref_count !== 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tasset.close();\n\t\t\tremove_list.push(id);\n\t\t}\n\t\tfor(const id of remove_list) {\n\t\t\tconsole.log(\"WEB-RENDERER: Destroying\", id)\n\t\t\tthis._renderer_asset_cache.delete(id);\n\t\t\tthis._renderer_asset_trash.delete(id);\n\t\t}\n\t}\n\n\tprotected _setMap1Asset(asset: WebRendererAsset | null): void {\n\t\tthis._map1_renderer_asset?.classList.remove('map1');\n\t\tif(asset === null) {\n\t\t\tthis._map1_renderer_asset = null;\n\t\t\treturn;\n\t\t}\n\t\tthis._map1_renderer_asset = asset;\n\t\tthis._map1_renderer_asset.className = 'map1';\n\t}\n\n\tprotected _setMap2Asset(asset: WebRendererAsset | null): void {\n\t\tthis._map2_renderer_asset?.classList.remove('map2');\n\t\tif(asset === null) {\n\t\t\tthis._map2_renderer_asset = null;\n\t\t\treturn;\n\t\t}\n\t\tthis._map2_renderer_asset = asset;\n\t\tthis._map2_renderer_asset.className = 'map2';\n\t}\n\n\t// Assumes new decl.\n\tprotected async _updateCurrent(decl: MediaDecl): Promise<WebRendererAsset> {\n\t\tconst asset = this._resolveMediaAsset(decl);\n\t\tif(!asset.has_element\n\t\t\t&& asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)\n\t\t{\n\t\t\tasset.has_element = true;\n\t\t\tawait asset.play();\n\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t}\n\t\t\tif(this._map2_renderer_asset !== null) {\n\t\t\t\tthis._map2_renderer_asset.unref();\n\t\t\t}\n\t\t\tasset.ref();\n\t\t\tthis._setMap1Asset(asset);\n\t\t\tthis._setMap2Asset(null);\n\t\t\tthis._setTransitionPercent(0);\n\t\t\tif(this.readyState < HTMLMediaElement.HAVE_CURRENT_DATA) {\n\t\t\t\tthis._readyState = HTMLMediaElement.HAVE_CURRENT_DATA;\n\t\t\t}\n\t\t}\n\t\treturn asset;\n\t}\n\n\t// Keep reference next to current.\n\tprotected async _updateCurrentFromNext(): Promise<WebRendererAsset> {\n\t\tif(this._current_renderer_asset !== null) {\n\t\t\tthrow new Error(\"current asset must be closed before calling.\");\n\t\t}\n\t\tif(this._next_renderer_asset === null) {\n\t\t\tthrow new Error(\"next asset must be defined before calling.\");\n\t\t}\n\t\tconst asset = this._next_renderer_asset;\n\t\tthis._next_renderer_asset = null;\n\t\tif(asset !== null\n\t\t\t&& asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)\n\t\t{\n\t\t\tawait asset.play();\n\t\t\tif(this._map2_renderer_asset === null) {\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tthis._setMap1Asset(asset);\n\t\t\t\tthis._setTransitionPercent(0);\n\t\t\t}\n\t\t\tthis._readyState = HTMLMediaElement.HAVE_CURRENT_DATA;\n\t\t} else {\n\t\t\tconsole.warn(\"WEB-RENDERER: current asset not ready.\");\n\t\t\tthis._readyState = HTMLMediaElement.HAVE_METADATA;\n\t\t}\n\t\treturn asset;\n\t}\n\n\tprotected _canPaintCurrent(): boolean {\n\t\treturn this._current_renderer_asset !== null\n\t\t\t&& this._current_renderer_asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA;\n\t}\n\n\tprotected _paintCurrent(timestamp: DOMHighResTimeStamp, remaining: number): void {\n\t\tif(this._current_renderer_asset === null) {\n\t\t\tthrow new Error(\"undefined current asset.\");\n\t\t}\n\t\tthis._current_renderer_asset.paint(timestamp, remaining);\n\t\t// Very slow loading asset, force playback, avoid seeking as already broken.\n//\t\tif(this.#current_asset.paused) {\n//\t\t\t(async() => {\n//\t\t\t\tif(this.#current_asset !== null\n//\t\t\t\t\t&& this.#current_asset.paused\n//\t\t\t\t\t&& !this.#current_asset.ended\n//\t\t\t\t\t&& this.#current_asset.readyState >= HTMLMediaElement.HAVE_FUTURE_DATA)\n//\t\t\t\t{\n//\t\t\t\t\tawait this.#current_asset.play();\n//\t\t\t\t}\n//\t\t\t})();\n//\t\t}\n\t}\n\n\tprotected _closeCurrent(): void {\n\t\tif(this._current_renderer_asset === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis._current_renderer_asset.pause();\n\t\tthis._current_renderer_asset.unref();\n\t\tthis._renderer_asset_trash.set(this._current_renderer_asset.id, this._current_renderer_asset);\n\t\tthis._current_renderer_asset = null;\n\t}\n\n\tprotected _hasWaitingDuration(): boolean {\n\t\treturn false;\n\t}\n\n\tprotected _paintWaiting(_timestamp: DOMHighResTimeStamp): void {}\n\t_paintWaitingDuration(_timestamp: DOMHighResTimeStamp, _remaining: number): void {}\n\n\tprotected _updateNext(decl: MediaDecl): WebRendererAsset {\n\t\tconst asset = this._resolveMediaAsset(decl);\n\t\tif(!asset.has_element\n\t\t\t&& asset.readyState >= HTMLMediaElement.HAVE_FUTURE_DATA)\n\t\t{\n\t\t\tasset.has_element = true;\n\t\t\tif(this.readyState < HTMLMediaElement.HAVE_FUTURE_DATA) {\n\t\t\t\tthis._readyState = HTMLMediaElement.HAVE_FUTURE_DATA;\n\t\t\t}\n\t\t}\n\t\treturn asset;\n\t}\n\n\tprotected _isMediaReady(decl: MediaDecl): boolean {\n\t\t\tconst path = this._asset_prefetch.getCachedPath(decl.href);\n\t\treturn path !== null;\n\t}\n\n\tprotected _resolveMediaAsset(decl: MediaDecl): WebRendererAsset {\n\t\tconst existing_asset = this._renderer_asset_cache.get(decl.id);\n\t\tif(typeof existing_asset !== \"undefined\") {\n\t\t\tif(this._renderer_asset_trash.has(decl.id)) {\n\t\t\t\tthis._renderer_asset_trash.delete(decl.id);\n\t\t\t}\n\t\t\tif(existing_asset.is_loading\n\t\t\t\t&& existing_asset.readyState === HTMLMediaElement.HAVE_ENOUGH_DATA)\n\t\t\t{\n\t\t\t\tthis._networkLoadingUnref();\n\t\t\t\texisting_asset.is_loading = false;\n\t\t\t}\n\t\t\treturn existing_asset;\n\t\t}\n\t\tconst cached_path = this._asset_prefetch.getCachedPath(decl.href);\n\t\tif(cached_path === null) {\n\t\t\tthrow new Error(`Media asset not cached: ${decl.href}`);\n\t\t}\n\t\tconst resolved_decl: MediaDecl = {\n\t\t\t...decl,\n\t\t\thref: cached_path,\n\t\t};\n\t\tconst web_asset = this._asset_manager.createWebAsset(resolved_decl);\n\t\tconst renderer_asset = new WebRendererAsset(decl.id, web_asset);\n\t\tthis._renderer_asset_cache.set(renderer_asset.id, renderer_asset);\n\t\tthis._networkLoadingRef();\n\t\trenderer_asset.is_loading = true;\n\t\trenderer_asset.load();\n\t\treturn renderer_asset;\n\t}\n\n\tprotected _canPaintNext(): boolean {\n\t\treturn this._next_renderer_asset !== null\n\t\t\t&& this._next_renderer_asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA;\n\t}\n\n\tprotected _paintNext(timestamp: DOMHighResTimeStamp, remaining: number): void {\n\t\tif(this._next_renderer_asset === null) {\n\t\t\tthrow new Error(\"undefined next asset.\");\n\t\t}\n\t\tthis._next_renderer_asset.paint(timestamp, remaining);\n\t}\n\n\tprotected _closeNext(): void {\n\t\tif(this._next_renderer_asset === null) {\n\t\t\tthrow new Error(\"undefined next asset.\");\n\t\t}\n\t\tthis._next_renderer_asset.unref();\n\t\tthis._renderer_asset_trash.set(this._next_renderer_asset.id, this._next_renderer_asset);\n\t\tthis._next_renderer_asset = null;\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nexport interface RTCMeshSettings {\n\tlabel: string;\n\tid: string;\n\ticeServers: RTCIceServer[];\n\tpeers: string[];\n\tenableLoopback: boolean;\n};\n\nexport class RTCMesh extends EventTarget {\n\tlabel: string;\n\tid: string;\n\tconfiguration: RTCConfiguration;\n\tpeers: string[];\n\tenable_loopback: boolean;\n\tchannels: Map<string, RTCDataChannel>;\n\tuser_channels: Map<string, RTCDataChannel>;\n\tconnections: Map<string, RTCPeerConnection>;\n\tloopback1?: RTCPeerConnection;\n\tloopback2?: RTCPeerConnection;\n\tloopback_send_channel?: RTCDataChannel;\n\tloopback_receive_channel?: RTCDataChannel;\n\n\tconstructor(\n\t\tsettings: RTCMeshSettings,\n\t) {\n\t\tsuper();\n\t\tthis.label = settings.label;\n\t\tthis.id = settings.id;\n\t\tthis.configuration = {\n\t\t\tbundlePolicy: \"max-compat\",\n\t\t\ticeServers: settings.iceServers,\n\t\t};\n\t\tthis.peers = settings.peers;\n\t\tthis.enable_loopback = settings.enableLoopback;\n\t\tthis.channels = new Map();\n\t\tthis.user_channels = new Map();\n\t\tthis.connections = new Map();\n\t\tfor(const peer of this.peers) {\n\t\t\tif(peer === this.id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.#createRTCPeerConnection(peer);\n\t\t}\n\t\tif(this.enable_loopback) {\n\t\t\t(async () => {\n\t\t\t\tawait this.#createLoopback();\n\t\t\t})();\n\t\t}\n\t}\n\n\tasync #createLoopback() {\n\t\ttry {\n\t\t\tthis.loopback1 = new RTCPeerConnection();\n\t\t\tif(typeof this.loopback1 === \"undefined\") {\n\t\t\t\tconsole.error(\"Failed to create loopback#1 RTCPeerConnection.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.loopback2 = new RTCPeerConnection();\n\t\t\tif(typeof this.loopback2 === \"undefined\") {\n\t\t\t\tconsole.error(\"Failed to create loopback#2 RTCPeerConnection.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.loopback1.onicecandidate = (event) => {\n\t\t\t\tif(typeof this.loopback2 === \"undefined\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Ignore null candidate, which indicates that ICE gathering has finished.\n\t\t\t\tif(!event.candidate) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tthis.loopback2.addIceCandidate(event.candidate);\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.loopback2.onicecandidate = (event) => {\n\t\t\t\tif(typeof this.loopback1 === \"undefined\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Ignore null candidate, which indicates that ICE gathering has finished.\n\t\t\t\tif(!event.candidate) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tthis.loopback1.addIceCandidate(event.candidate);\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.loopback2.ondatachannel = (event) => {\n\t\t\t\tconsole.info('LOOPBACK', event);\n\t\t\t\tthis.loopback_receive_channel = event.channel;\n\t\t\t\tthis.loopback_receive_channel.onmessage = (event) => {\n\t\t\t\t\tthis.dispatchEvent(new CustomEvent(\"message\", {\n\t\t\t\t\t\tdetail: event.data,\n\t\t\t\t\t}));\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.loopback_send_channel = this.loopback1.createDataChannel(\"loopback\");\n\t\t\tconst offer = await this.loopback1.createOffer();\n\t\t\tawait this.loopback1.setLocalDescription(offer);\n\t\t\tawait this.loopback2.setRemoteDescription(offer);\n\t\t\tconst answer = await this.loopback2.createAnswer();\n\t\t\tawait this.loopback2.setLocalDescription(answer);\n\t\t\tawait this.loopback1.setRemoteDescription(answer);\n\t\t} catch(e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\tuser_channel(\n\t\tpeer: string,\n\t): RTCDataChannel | undefined {\n\t\treturn this.user_channels.get(peer);\n\t}\n\n\treadyState(\n\t\tpeer: string,\n\t): RTCDataChannelState | \"new\" {\n\t\tconst channel = this.channels.get(peer);\n\t\tif(typeof channel === \"undefined\") {\n\t\t\treturn \"new\";\n\t\t}\n\t\treturn channel.readyState;\n\t}\n\n\t#createRTCPeerConnection(\n\t\tpeer: string,\n\t) {\n\t\tconst new_connection = new RTCPeerConnection(this.configuration);\n\t\tthis.connections.set(peer, new_connection);\n\t\tconsole.log(\"creating new peer\", peer, new_connection);\n\t}\n\n\t#createRTCDataChannels(\n\t\tpeer: string,\n\t\tconnection: RTCPeerConnection,\n\t) {\n\t\tconsole.log(`#createRTCDataChannels(${peer})`);\n\t\tthis.#createPrimaryDataChannel(peer, connection);\n\t\tthis.#createUserDataChannel(peer, connection);\n\t}\n\n\t#createPrimaryDataChannel(\n\t\tpeer: string,\n\t\tconnection: RTCPeerConnection,\n\t) {\n\t\tconst new_channel = connection.createDataChannel(this.label, {\n\t\t\tordered: true,\n\t\t\tmaxPacketLifeTime: 1000,\n\t\t\tnegotiated: true,\n\t\t\tid: 0,\n\t\t});\n//\t\tnew_channel.addEventListener(\"bufferedamountlow\", (event) => {\n//\t\t\tconsole.log(event);\n//\t\t});\n\t\t// Cannot re-open data channel with same id.\n\t\tnew_channel.addEventListener(\"close\", (event) => {\n\t\t\tconsole.log(event);\n//\t\t\tqueueMicrotask(() => this.close(peer));\n\t\t});\n\t\tnew_channel.addEventListener(\"closing\", (event) => {\n\t\t\tconsole.log(event);\n\t\t});\n\t\tnew_channel.addEventListener(\"error\", (event) => {\n\t\t\tconsole.log(event);\n\t\t});\n\t\tnew_channel.addEventListener(\"message\", (event) => {\n//\t\t\tconsole.log(event);\n\t\t\tthis.dispatchEvent(new CustomEvent(\"message\", {\n\t\t\t\tdetail: event.data,\n\t\t\t}));\n\t\t});\n\t\tnew_channel.addEventListener(\"open\", (event) => {\n\t\t\tconsole.log(event);\n\t\t});\n\t\tthis.channels.set(peer, new_channel);\n\t\tconsole.log(\"creating new primary channel\", peer, new_channel);\n\t}\n\n\t#createUserDataChannel(\n\t\tpeer: string,\n\t\tconnection: RTCPeerConnection,\n\t) {\n\t\tconst new_channel = connection.createDataChannel(this.label, {\n\t\t\tordered: false,\n\t\t\tmaxPacketLifeTime: 6000,\n\t\t\tnegotiated: true,\n\t\t\tid: 1,\n\t\t});\n\t\t// Cannot re-open data channel with same id.\n\t\tnew_channel.addEventListener(\"close\", (event) => {\n\t\t\tconsole.log(event);\n\t\t\tthis.dispatchEvent(new CustomEvent('removechannel', {\n\t\t\t\tdetail: {\n\t\t\t\t\tid: peer,\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t\tnew_channel.addEventListener(\"open\", (event) => {\n\t\t\tconsole.log(event);\n\t\t\tthis.dispatchEvent(new CustomEvent('addchannel', {\n\t\t\t\tdetail: {\n\t\t\t\t\tid: peer,\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t\tthis.user_channels.set(peer, new_channel);\n\t\tconsole.log(\"creating new user channel\", peer, new_channel);\n\t}\n\n\tasync #destroy(\n\t\tid: string,\n\t) {\n\t\tconsole.log(`#destroy(${id})`);\n\t\tconst channel = this.channels.get(id);\n\t\tif(channel instanceof RTCDataChannel) {\n\t\t\tif(channel.readyState !== \"closed\") {\n\t\t\t\tawait new Promise<void>(resolve => {\n\t\t\t\t\tchannel.addEventListener('close', (event) => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tchannel.close();\n\t\t\t}\n\t\t\tthis.channels.delete(id);\n\t\t}\n\t\tconst user_channel = this.user_channels.get(id);\n\t\tif(user_channel instanceof RTCDataChannel) {\n\t\t\tif(user_channel.readyState !== \"closed\") {\n\t\t\t\tawait new Promise<void>(resolve => {\n\t\t\t\t\tuser_channel.addEventListener('close', (event) => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tuser_channel.close();\n\t\t\t}\n\t\t\tthis.user_channels.delete(id);\n\t\t}\n\t\tconst connection = this.connections.get(id);\n\t\tif(connection instanceof RTCPeerConnection) {\n\t\t\tif(connection.connectionState !== \"closed\") {\n//\t\t\t\tawait new Promise(resolve => {\n//\t\t\t\t\tconnection.addEventListener('connectionstatechange', (event) => {\n//\t\t\t\t\t\tif(connection.connectionState === \"closed\") {\n//\t\t\t\t\t\t\tresolve();\n//\t\t\t\t\t\t\treturn;\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\tconnection.close();\n//\t\t\t\t\t});\n//\t\t\t\t});\n\t\t\t\tconnection.close();\n\t\t\t}\n\t\t\tthis.connections.delete(id);\n\t\t}\n\t}\n\n\tasync close(\n\t\tid: string,\n\t) {\n\t\tconsole.log(`close(${id})`);\n\t\tawait this.#destroy(id);\n\t\t// REF: https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/close\n\t\t// Make sure that you delete all references to the previous\n\t\t// RTCPeerConnection before attempting to create a new one that\n\t\t// connects to the same remote peer.\n\t\tqueueMicrotask(() => this.#createRTCPeerConnection(id));\n\t}\n\n\taddIceCandidate(\n\t\tid: string,\n\t\tcandidate: RTCIceCandidateInit | null,\n\t) {\n\t\tconsole.log(`addIceCandidate(${id}, ${candidate})`);\n\t\tconst connection = this.connections.get(id);\n\t\tif(typeof connection === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\t\tif(candidate === null) {\n\t\t\treturn;\n\t\t}\n\t\tconnection.addIceCandidate(new RTCIceCandidate(candidate));\n\t}\n\n\t// Origin side:\n\tcreateOffer(\n\t\tid: string,\n\t) {\n\t\tconsole.log(`createOffer(${id})`);\n\t\t(async () => {\n\t\t\tconst connection = this.connections.get(id);\n\t\t\tif(typeof connection === \"undefined\") {\n\t\t\t\tconsole.error(\"no connection\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconnection.onconnectionstatechange = event => {\n\t\t\t\tconsole.log(event);\n\t\t\t\tthis.#webrtc_onconnectionstatechange(connection, id);\n\t\t\t};\n\t\t\tconnection.onicecandidate = event => {\n\t\t\t\tconsole.log(event);\n\t\t\t\tthis.#webrtc_onicecandidate(connection, id, event.candidate);\n\t\t\t};\n\t\t\ttry {\n\t\t\t\tthis.#createRTCDataChannels(id, connection);\n\t\t\t} catch(e) {\n\t\t\t\tconsole.warn(e);\n\t\t\t\ttry {\n\t\t\t\t\tawait this.close(id);\n\t\t\t\t\tconsole.log(\"RTC connection closed.\");\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t} finally {\n\t\t\t\t\tconst event = new CustomEvent('failed', {\n\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tthis.dispatchEvent(event);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst offer = await connection.createOffer({\n\t\t\t\ticeRestart: false,\n\t\t\t\tofferToReceiveAudio: false,\n\t\t\t\tofferToReceiveVideo: false,\n\t\t\t});\n\t\t\t// Triggering ICE candidate generation.\n\t\t\tawait connection.setLocalDescription(offer);\n\t\t\tconst event = new CustomEvent('offer', {\n\t\t\t\tdetail: {\n\t\t\t\t\tid,\n\t\t\t\t\tsdp: offer.sdp,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.dispatchEvent(event);\n\t\t})();\n\t}\n\n\taddAnswer(\n\t\tid: string,\n\t\tsdp: string,\n\t) {\n\t\tconsole.log(`addAnswer(${id}, ${sdp})`);\n\t\tconst connection = this.connections.get(id);\n\t\tif(typeof connection === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\t\tconst desc = new RTCSessionDescription({ type: \"answer\", sdp });\n\t\tconnection.setRemoteDescription(desc);\n\t}\n\n\tbroadcast(data: string): void;\n\tbroadcast(data: Blob): void;\n\tbroadcast(data: ArrayBuffer): void;\n\tbroadcast(data: ArrayBufferView): void;\n\n\tbroadcast(\n\t\tdata: any,\n\t) {\n\t\tfor(const channel of this.channels.values()) {\n\t\t\tif(channel.readyState !== \"open\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttry {\n//\t\t\t\tconsole.log(\"send ->\", channel.label, data);\n\t\t\t\tchannel.send(data);\n\t\t\t} catch(e) {\n\t\t\t\tconsole.warn(e);\n\t\t\t}\n\t\t}\n\t\tif(this.loopback_send_channel instanceof RTCDataChannel\n\t\t\t&& this.loopback_send_channel.readyState === \"open\")\n\t\t{\n\t\t\ttry {\n\t\t\t\tthis.loopback_send_channel.send(data);\n\t\t\t} catch(e) {\n\t\t\t\tconsole.warn(e);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Receiver side:\n\tcreateAnswer(\n\t\tid: string,\n\t\tsdp: string,\n\t) {\n\t\tconsole.log(`createAnswer(${id}, ${sdp})`);\n\t\t(async () => {\n\t\t\tconst connection = this.connections.get(id);\n\t\t\tif(typeof connection === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconnection.onconnectionstatechange = event => {\n\t\t\t\tconsole.log(event);\n\t\t\t\tthis.#webrtc_onconnectionstatechange(connection, id);\n\t\t\t};\n\t\t\tconnection.onicecandidate = event => {\n\t\t\t\tconsole.log(event);\n\t\t\t\tthis.#webrtc_onicecandidate(connection, id, event.candidate);\n\t\t\t};\n\t\t\ttry {\n\t\t\t\tthis.#createRTCDataChannels(id, connection);\n\t\t\t} catch(e) {\n\t\t\t\tconsole.warn(e);\n\t\t\t\tthis.close(id)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tconsole.log(\"RTC connection closed.\");\n\t\t\t\t\t})\n\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\tconsole.warn(e);\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tconst event = new CustomEvent('failed', {\n\t\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthis.dispatchEvent(event);\n\t\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst desc = new RTCSessionDescription({ type: \"offer\", sdp });\n\t\t\tawait connection.setRemoteDescription(desc);\n\t\t\tconst answer = await connection.createAnswer();\n\t\t\tawait connection.setLocalDescription(answer);\n\t\t\tconst event = new CustomEvent('answer', {\n\t\t\t\tdetail: {\n\t\t\t\t\tid,\n\t\t\t\t\tsdp: answer.sdp,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.dispatchEvent(event);\n\t\t})();\n\t}\n\n\t#webrtc_onconnectionstatechange(\n\t\tconnection: RTCPeerConnection,\n\t\tid: string,\n\t) {\n\t\tswitch(connection.connectionState) {\n\t\tcase 'disconnected':\n\t\t\tthis.#webrtc_ondisconnected(connection, id);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t#webrtc_ondisconnected(\n\t\t_connection: RTCPeerConnection,\n\t\tid: string,\n\t) {\n\t\tconst event = new CustomEvent('disconnected', {\n\t\t\tdetail: {\n\t\t\t\tid,\n\t\t\t},\n\t\t});\n\t\tthis.dispatchEvent(event);\n\t}\n\n\t#webrtc_onicecandidate(\n\t\t_connection: RTCPeerConnection,\n\t\tid: string,\n\t\tcandidate: RTCIceCandidate | null,\n\t) {\n\t\tconst event = new CustomEvent('icecandidate', {\n\t\t\tdetail: {\n\t\t\t\tid,\n\t\t\t\tcandidate,\n\t\t\t},\n\t\t});\n\t\tthis.dispatchEvent(event);\n\t}\n}\n","// Integer Utility\n\nexport const UINT32_MAX = 0xffff_ffff;\n\n// DataView extension to handle int64 / uint64,\n// where the actual range is 53-bits integer (a.k.a. safe integer)\n\nexport function setUint64(view: DataView, offset: number, value: number): void {\n  const high = value / 0x1_0000_0000;\n  const low = value; // high bits are truncated by DataView\n  view.setUint32(offset, high);\n  view.setUint32(offset + 4, low);\n}\n\nexport function setInt64(view: DataView, offset: number, value: number): void {\n  const high = Math.floor(value / 0x1_0000_0000);\n  const low = value; // high bits are truncated by DataView\n  view.setUint32(offset, high);\n  view.setUint32(offset + 4, low);\n}\n\nexport function getInt64(view: DataView, offset: number): number {\n  const high = view.getInt32(offset);\n  const low = view.getUint32(offset + 4);\n  return high * 0x1_0000_0000 + low;\n}\n\nexport function getUint64(view: DataView, offset: number): number {\n  const high = view.getUint32(offset);\n  const low = view.getUint32(offset + 4);\n  return high * 0x1_0000_0000 + low;\n}\n","/* eslint-disable @typescript-eslint/no-unnecessary-condition */\nimport { UINT32_MAX } from \"./int\";\n\nconst TEXT_ENCODING_AVAILABLE =\n  (typeof process === \"undefined\" || process?.env?.[\"TEXT_ENCODING\"] !== \"never\") &&\n  typeof TextEncoder !== \"undefined\" &&\n  typeof TextDecoder !== \"undefined\";\n\nexport function utf8Count(str: string): number {\n  const strLength = str.length;\n\n  let byteLength = 0;\n  let pos = 0;\n  while (pos < strLength) {\n    let value = str.charCodeAt(pos++);\n\n    if ((value & 0xffffff80) === 0) {\n      // 1-byte\n      byteLength++;\n      continue;\n    } else if ((value & 0xfffff800) === 0) {\n      // 2-bytes\n      byteLength += 2;\n    } else {\n      // handle surrogate pair\n      if (value >= 0xd800 && value <= 0xdbff) {\n        // high surrogate\n        if (pos < strLength) {\n          const extra = str.charCodeAt(pos);\n          if ((extra & 0xfc00) === 0xdc00) {\n            ++pos;\n            value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n          }\n        }\n      }\n\n      if ((value & 0xffff0000) === 0) {\n        // 3-byte\n        byteLength += 3;\n      } else {\n        // 4-byte\n        byteLength += 4;\n      }\n    }\n  }\n  return byteLength;\n}\n\nexport function utf8EncodeJs(str: string, output: Uint8Array, outputOffset: number): void {\n  const strLength = str.length;\n  let offset = outputOffset;\n  let pos = 0;\n  while (pos < strLength) {\n    let value = str.charCodeAt(pos++);\n\n    if ((value & 0xffffff80) === 0) {\n      // 1-byte\n      output[offset++] = value;\n      continue;\n    } else if ((value & 0xfffff800) === 0) {\n      // 2-bytes\n      output[offset++] = ((value >> 6) & 0x1f) | 0xc0;\n    } else {\n      // handle surrogate pair\n      if (value >= 0xd800 && value <= 0xdbff) {\n        // high surrogate\n        if (pos < strLength) {\n          const extra = str.charCodeAt(pos);\n          if ((extra & 0xfc00) === 0xdc00) {\n            ++pos;\n            value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n          }\n        }\n      }\n\n      if ((value & 0xffff0000) === 0) {\n        // 3-byte\n        output[offset++] = ((value >> 12) & 0x0f) | 0xe0;\n        output[offset++] = ((value >> 6) & 0x3f) | 0x80;\n      } else {\n        // 4-byte\n        output[offset++] = ((value >> 18) & 0x07) | 0xf0;\n        output[offset++] = ((value >> 12) & 0x3f) | 0x80;\n        output[offset++] = ((value >> 6) & 0x3f) | 0x80;\n      }\n    }\n\n    output[offset++] = (value & 0x3f) | 0x80;\n  }\n}\n\nconst sharedTextEncoder = TEXT_ENCODING_AVAILABLE ? new TextEncoder() : undefined;\nexport const TEXT_ENCODER_THRESHOLD = !TEXT_ENCODING_AVAILABLE\n  ? UINT32_MAX\n  : typeof process !== \"undefined\" && process?.env?.[\"TEXT_ENCODING\"] !== \"force\"\n  ? 200\n  : 0;\n\nfunction utf8EncodeTEencode(str: string, output: Uint8Array, outputOffset: number): void {\n  output.set(sharedTextEncoder!.encode(str), outputOffset);\n}\n\nfunction utf8EncodeTEencodeInto(str: string, output: Uint8Array, outputOffset: number): void {\n  sharedTextEncoder!.encodeInto(str, output.subarray(outputOffset));\n}\n\nexport const utf8EncodeTE = sharedTextEncoder?.encodeInto ? utf8EncodeTEencodeInto : utf8EncodeTEencode;\n\nconst CHUNK_SIZE = 0x1_000;\n\nexport function utf8DecodeJs(bytes: Uint8Array, inputOffset: number, byteLength: number): string {\n  let offset = inputOffset;\n  const end = offset + byteLength;\n\n  const units: Array<number> = [];\n  let result = \"\";\n  while (offset < end) {\n    const byte1 = bytes[offset++]!;\n    if ((byte1 & 0x80) === 0) {\n      // 1 byte\n      units.push(byte1);\n    } else if ((byte1 & 0xe0) === 0xc0) {\n      // 2 bytes\n      const byte2 = bytes[offset++]! & 0x3f;\n      units.push(((byte1 & 0x1f) << 6) | byte2);\n    } else if ((byte1 & 0xf0) === 0xe0) {\n      // 3 bytes\n      const byte2 = bytes[offset++]! & 0x3f;\n      const byte3 = bytes[offset++]! & 0x3f;\n      units.push(((byte1 & 0x1f) << 12) | (byte2 << 6) | byte3);\n    } else if ((byte1 & 0xf8) === 0xf0) {\n      // 4 bytes\n      const byte2 = bytes[offset++]! & 0x3f;\n      const byte3 = bytes[offset++]! & 0x3f;\n      const byte4 = bytes[offset++]! & 0x3f;\n      let unit = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0c) | (byte3 << 0x06) | byte4;\n      if (unit > 0xffff) {\n        unit -= 0x10000;\n        units.push(((unit >>> 10) & 0x3ff) | 0xd800);\n        unit = 0xdc00 | (unit & 0x3ff);\n      }\n      units.push(unit);\n    } else {\n      units.push(byte1);\n    }\n\n    if (units.length >= CHUNK_SIZE) {\n      result += String.fromCharCode(...units);\n      units.length = 0;\n    }\n  }\n\n  if (units.length > 0) {\n    result += String.fromCharCode(...units);\n  }\n\n  return result;\n}\n\nconst sharedTextDecoder = TEXT_ENCODING_AVAILABLE ? new TextDecoder() : null;\nexport const TEXT_DECODER_THRESHOLD = !TEXT_ENCODING_AVAILABLE\n  ? UINT32_MAX\n  : typeof process !== \"undefined\" && process?.env?.[\"TEXT_DECODER\"] !== \"force\"\n  ? 200\n  : 0;\n\nexport function utf8DecodeTD(bytes: Uint8Array, inputOffset: number, byteLength: number): string {\n  const stringBytes = bytes.subarray(inputOffset, inputOffset + byteLength);\n  return sharedTextDecoder!.decode(stringBytes);\n}\n","/**\n * ExtData is used to handle Extension Types that are not registered to ExtensionCodec.\n */\nexport class ExtData {\n  constructor(readonly type: number, readonly data: Uint8Array) {}\n}\n","export class DecodeError extends Error {\n  constructor(message: string) {\n    super(message);\n\n    // fix the prototype chain in a cross-platform way\n    const proto: typeof DecodeError.prototype = Object.create(DecodeError.prototype);\n    Object.setPrototypeOf(this, proto);\n\n    Object.defineProperty(this, \"name\", {\n      configurable: true,\n      enumerable: false,\n      value: DecodeError.name,\n    });\n  }\n}\n","// https://github.com/msgpack/msgpack/blob/master/spec.md#timestamp-extension-type\nimport { DecodeError } from \"./DecodeError\";\nimport { getInt64, setInt64 } from \"./utils/int\";\n\nexport const EXT_TIMESTAMP = -1;\n\nexport type TimeSpec = {\n  sec: number;\n  nsec: number;\n};\n\nconst TIMESTAMP32_MAX_SEC = 0x100000000 - 1; // 32-bit unsigned int\nconst TIMESTAMP64_MAX_SEC = 0x400000000 - 1; // 34-bit unsigned int\n\nexport function encodeTimeSpecToTimestamp({ sec, nsec }: TimeSpec): Uint8Array {\n  if (sec >= 0 && nsec >= 0 && sec <= TIMESTAMP64_MAX_SEC) {\n    // Here sec >= 0 && nsec >= 0\n    if (nsec === 0 && sec <= TIMESTAMP32_MAX_SEC) {\n      // timestamp 32 = { sec32 (unsigned) }\n      const rv = new Uint8Array(4);\n      const view = new DataView(rv.buffer);\n      view.setUint32(0, sec);\n      return rv;\n    } else {\n      // timestamp 64 = { nsec30 (unsigned), sec34 (unsigned) }\n      const secHigh = sec / 0x100000000;\n      const secLow = sec & 0xffffffff;\n      const rv = new Uint8Array(8);\n      const view = new DataView(rv.buffer);\n      // nsec30 | secHigh2\n      view.setUint32(0, (nsec << 2) | (secHigh & 0x3));\n      // secLow32\n      view.setUint32(4, secLow);\n      return rv;\n    }\n  } else {\n    // timestamp 96 = { nsec32 (unsigned), sec64 (signed) }\n    const rv = new Uint8Array(12);\n    const view = new DataView(rv.buffer);\n    view.setUint32(0, nsec);\n    setInt64(view, 4, sec);\n    return rv;\n  }\n}\n\nexport function encodeDateToTimeSpec(date: Date): TimeSpec {\n  const msec = date.getTime();\n  const sec = Math.floor(msec / 1e3);\n  const nsec = (msec - sec * 1e3) * 1e6;\n\n  // Normalizes { sec, nsec } to ensure nsec is unsigned.\n  const nsecInSec = Math.floor(nsec / 1e9);\n  return {\n    sec: sec + nsecInSec,\n    nsec: nsec - nsecInSec * 1e9,\n  };\n}\n\nexport function encodeTimestampExtension(object: unknown): Uint8Array | null {\n  if (object instanceof Date) {\n    const timeSpec = encodeDateToTimeSpec(object);\n    return encodeTimeSpecToTimestamp(timeSpec);\n  } else {\n    return null;\n  }\n}\n\nexport function decodeTimestampToTimeSpec(data: Uint8Array): TimeSpec {\n  const view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n\n  // data may be 32, 64, or 96 bits\n  switch (data.byteLength) {\n    case 4: {\n      // timestamp 32 = { sec32 }\n      const sec = view.getUint32(0);\n      const nsec = 0;\n      return { sec, nsec };\n    }\n    case 8: {\n      // timestamp 64 = { nsec30, sec34 }\n      const nsec30AndSecHigh2 = view.getUint32(0);\n      const secLow32 = view.getUint32(4);\n      const sec = (nsec30AndSecHigh2 & 0x3) * 0x100000000 + secLow32;\n      const nsec = nsec30AndSecHigh2 >>> 2;\n      return { sec, nsec };\n    }\n    case 12: {\n      // timestamp 96 = { nsec32 (unsigned), sec64 (signed) }\n\n      const sec = getInt64(view, 4);\n      const nsec = view.getUint32(0);\n      return { sec, nsec };\n    }\n    default:\n      throw new DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${data.length}`);\n  }\n}\n\nexport function decodeTimestampExtension(data: Uint8Array): Date {\n  const timeSpec = decodeTimestampToTimeSpec(data);\n  return new Date(timeSpec.sec * 1e3 + timeSpec.nsec / 1e6);\n}\n\nexport const timestampExtension = {\n  type: EXT_TIMESTAMP,\n  encode: encodeTimestampExtension,\n  decode: decodeTimestampExtension,\n};\n","// ExtensionCodec to handle MessagePack extensions\n\nimport { ExtData } from \"./ExtData\";\nimport { timestampExtension } from \"./timestamp\";\n\nexport type ExtensionDecoderType<ContextType> = (\n  data: Uint8Array,\n  extensionType: number,\n  context: ContextType,\n) => unknown;\n\nexport type ExtensionEncoderType<ContextType> = (input: unknown, context: ContextType) => Uint8Array | null;\n\n// immutable interface to ExtensionCodec\nexport type ExtensionCodecType<ContextType> = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  __brand?: ContextType;\n  tryToEncode(object: unknown, context: ContextType): ExtData | null;\n  decode(data: Uint8Array, extType: number, context: ContextType): unknown;\n};\n\nexport class ExtensionCodec<ContextType = undefined> implements ExtensionCodecType<ContextType> {\n  public static readonly defaultCodec: ExtensionCodecType<undefined> = new ExtensionCodec();\n\n  // ensures ExtensionCodecType<X> matches ExtensionCodec<X>\n  // this will make type errors a lot more clear\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  __brand?: ContextType;\n\n  // built-in extensions\n  private readonly builtInEncoders: Array<ExtensionEncoderType<ContextType> | undefined | null> = [];\n  private readonly builtInDecoders: Array<ExtensionDecoderType<ContextType> | undefined | null> = [];\n\n  // custom extensions\n  private readonly encoders: Array<ExtensionEncoderType<ContextType> | undefined | null> = [];\n  private readonly decoders: Array<ExtensionDecoderType<ContextType> | undefined | null> = [];\n\n  public constructor() {\n    this.register(timestampExtension);\n  }\n\n  public register({\n    type,\n    encode,\n    decode,\n  }: {\n    type: number;\n    encode: ExtensionEncoderType<ContextType>;\n    decode: ExtensionDecoderType<ContextType>;\n  }): void {\n    if (type >= 0) {\n      // custom extensions\n      this.encoders[type] = encode;\n      this.decoders[type] = decode;\n    } else {\n      // built-in extensions\n      const index = 1 + type;\n      this.builtInEncoders[index] = encode;\n      this.builtInDecoders[index] = decode;\n    }\n  }\n\n  public tryToEncode(object: unknown, context: ContextType): ExtData | null {\n    // built-in extensions\n    for (let i = 0; i < this.builtInEncoders.length; i++) {\n      const encodeExt = this.builtInEncoders[i];\n      if (encodeExt != null) {\n        const data = encodeExt(object, context);\n        if (data != null) {\n          const type = -1 - i;\n          return new ExtData(type, data);\n        }\n      }\n    }\n\n    // custom extensions\n    for (let i = 0; i < this.encoders.length; i++) {\n      const encodeExt = this.encoders[i];\n      if (encodeExt != null) {\n        const data = encodeExt(object, context);\n        if (data != null) {\n          const type = i;\n          return new ExtData(type, data);\n        }\n      }\n    }\n\n    if (object instanceof ExtData) {\n      // to keep ExtData as is\n      return object;\n    }\n    return null;\n  }\n\n  public decode(data: Uint8Array, type: number, context: ContextType): unknown {\n    const decodeExt = type < 0 ? this.builtInDecoders[-1 - type] : this.decoders[type];\n    if (decodeExt) {\n      return decodeExt(data, type, context);\n    } else {\n      // decode() does not fail, returns ExtData instead.\n      return new ExtData(type, data);\n    }\n  }\n}\n","export function ensureUint8Array(buffer: ArrayLike<number> | Uint8Array | ArrayBufferView | ArrayBuffer): Uint8Array {\n  if (buffer instanceof Uint8Array) {\n    return buffer;\n  } else if (ArrayBuffer.isView(buffer)) {\n    return new Uint8Array(buffer.buffer, buffer.byteOffset, buffer.byteLength);\n  } else if (buffer instanceof ArrayBuffer) {\n    return new Uint8Array(buffer);\n  } else {\n    // ArrayLike<number>\n    return Uint8Array.from(buffer);\n  }\n}\n\nexport function createDataView(buffer: ArrayLike<number> | ArrayBufferView | ArrayBuffer): DataView {\n  if (buffer instanceof ArrayBuffer) {\n    return new DataView(buffer);\n  }\n\n  const bufferView = ensureUint8Array(buffer);\n  return new DataView(bufferView.buffer, bufferView.byteOffset, bufferView.byteLength);\n}\n","import { utf8EncodeJs, utf8Count, TEXT_ENCODER_THRESHOLD, utf8EncodeTE } from \"./utils/utf8\";\nimport { ExtensionCodec, ExtensionCodecType } from \"./ExtensionCodec\";\nimport { setInt64, setUint64 } from \"./utils/int\";\nimport { ensureUint8Array } from \"./utils/typedArrays\";\nimport type { ExtData } from \"./ExtData\";\n\nexport const DEFAULT_MAX_DEPTH = 100;\nexport const DEFAULT_INITIAL_BUFFER_SIZE = 2048;\n\nexport class Encoder<ContextType = undefined> {\n  private pos = 0;\n  private view = new DataView(new ArrayBuffer(this.initialBufferSize));\n  private bytes = new Uint8Array(this.view.buffer);\n\n  public constructor(\n    private readonly extensionCodec: ExtensionCodecType<ContextType> = ExtensionCodec.defaultCodec as any,\n    private readonly context: ContextType = undefined as any,\n    private readonly maxDepth = DEFAULT_MAX_DEPTH,\n    private readonly initialBufferSize = DEFAULT_INITIAL_BUFFER_SIZE,\n    private readonly sortKeys = false,\n    private readonly forceFloat32 = false,\n    private readonly ignoreUndefined = false,\n    private readonly forceIntegerToFloat = false,\n  ) {}\n\n  private reinitializeState() {\n    this.pos = 0;\n  }\n\n  /**\n   * This is almost equivalent to {@link Encoder#encode}, but it returns an reference of the encoder's internal buffer and thus much faster than {@link Encoder#encode}.\n   *\n   * @returns Encodes the object and returns a shared reference the encoder's internal buffer.\n   */\n  public encodeSharedRef(object: unknown): Uint8Array {\n    this.reinitializeState();\n    this.doEncode(object, 1);\n    return this.bytes.subarray(0, this.pos);\n  }\n\n  /**\n   * @returns Encodes the object and returns a copy of the encoder's internal buffer.\n   */\n  public encode(object: unknown): Uint8Array {\n    this.reinitializeState();\n    this.doEncode(object, 1);\n    return this.bytes.slice(0, this.pos);\n  }\n\n  private doEncode(object: unknown, depth: number): void {\n    if (depth > this.maxDepth) {\n      throw new Error(`Too deep objects in depth ${depth}`);\n    }\n\n    if (object == null) {\n      this.encodeNil();\n    } else if (typeof object === \"boolean\") {\n      this.encodeBoolean(object);\n    } else if (typeof object === \"number\") {\n      this.encodeNumber(object);\n    } else if (typeof object === \"string\") {\n      this.encodeString(object);\n    } else {\n      this.encodeObject(object, depth);\n    }\n  }\n\n  private ensureBufferSizeToWrite(sizeToWrite: number) {\n    const requiredSize = this.pos + sizeToWrite;\n\n    if (this.view.byteLength < requiredSize) {\n      this.resizeBuffer(requiredSize * 2);\n    }\n  }\n\n  private resizeBuffer(newSize: number) {\n    const newBuffer = new ArrayBuffer(newSize);\n    const newBytes = new Uint8Array(newBuffer);\n    const newView = new DataView(newBuffer);\n\n    newBytes.set(this.bytes);\n\n    this.view = newView;\n    this.bytes = newBytes;\n  }\n\n  private encodeNil() {\n    this.writeU8(0xc0);\n  }\n\n  private encodeBoolean(object: boolean) {\n    if (object === false) {\n      this.writeU8(0xc2);\n    } else {\n      this.writeU8(0xc3);\n    }\n  }\n  private encodeNumber(object: number) {\n    if (Number.isSafeInteger(object) && !this.forceIntegerToFloat) {\n      if (object >= 0) {\n        if (object < 0x80) {\n          // positive fixint\n          this.writeU8(object);\n        } else if (object < 0x100) {\n          // uint 8\n          this.writeU8(0xcc);\n          this.writeU8(object);\n        } else if (object < 0x10000) {\n          // uint 16\n          this.writeU8(0xcd);\n          this.writeU16(object);\n        } else if (object < 0x100000000) {\n          // uint 32\n          this.writeU8(0xce);\n          this.writeU32(object);\n        } else {\n          // uint 64\n          this.writeU8(0xcf);\n          this.writeU64(object);\n        }\n      } else {\n        if (object >= -0x20) {\n          // negative fixint\n          this.writeU8(0xe0 | (object + 0x20));\n        } else if (object >= -0x80) {\n          // int 8\n          this.writeU8(0xd0);\n          this.writeI8(object);\n        } else if (object >= -0x8000) {\n          // int 16\n          this.writeU8(0xd1);\n          this.writeI16(object);\n        } else if (object >= -0x80000000) {\n          // int 32\n          this.writeU8(0xd2);\n          this.writeI32(object);\n        } else {\n          // int 64\n          this.writeU8(0xd3);\n          this.writeI64(object);\n        }\n      }\n    } else {\n      // non-integer numbers\n      if (this.forceFloat32) {\n        // float 32\n        this.writeU8(0xca);\n        this.writeF32(object);\n      } else {\n        // float 64\n        this.writeU8(0xcb);\n        this.writeF64(object);\n      }\n    }\n  }\n\n  private writeStringHeader(byteLength: number) {\n    if (byteLength < 32) {\n      // fixstr\n      this.writeU8(0xa0 + byteLength);\n    } else if (byteLength < 0x100) {\n      // str 8\n      this.writeU8(0xd9);\n      this.writeU8(byteLength);\n    } else if (byteLength < 0x10000) {\n      // str 16\n      this.writeU8(0xda);\n      this.writeU16(byteLength);\n    } else if (byteLength < 0x100000000) {\n      // str 32\n      this.writeU8(0xdb);\n      this.writeU32(byteLength);\n    } else {\n      throw new Error(`Too long string: ${byteLength} bytes in UTF-8`);\n    }\n  }\n\n  private encodeString(object: string) {\n    const maxHeaderSize = 1 + 4;\n    const strLength = object.length;\n\n    if (strLength > TEXT_ENCODER_THRESHOLD) {\n      const byteLength = utf8Count(object);\n      this.ensureBufferSizeToWrite(maxHeaderSize + byteLength);\n      this.writeStringHeader(byteLength);\n      utf8EncodeTE(object, this.bytes, this.pos);\n      this.pos += byteLength;\n    } else {\n      const byteLength = utf8Count(object);\n      this.ensureBufferSizeToWrite(maxHeaderSize + byteLength);\n      this.writeStringHeader(byteLength);\n      utf8EncodeJs(object, this.bytes, this.pos);\n      this.pos += byteLength;\n    }\n  }\n\n  private encodeObject(object: unknown, depth: number) {\n    // try to encode objects with custom codec first of non-primitives\n    const ext = this.extensionCodec.tryToEncode(object, this.context);\n    if (ext != null) {\n      this.encodeExtension(ext);\n    } else if (Array.isArray(object)) {\n      this.encodeArray(object, depth);\n    } else if (ArrayBuffer.isView(object)) {\n      this.encodeBinary(object);\n    } else if (typeof object === \"object\") {\n      this.encodeMap(object as Record<string, unknown>, depth);\n    } else {\n      // symbol, function and other special object come here unless extensionCodec handles them.\n      throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(object)}`);\n    }\n  }\n\n  private encodeBinary(object: ArrayBufferView) {\n    const size = object.byteLength;\n    if (size < 0x100) {\n      // bin 8\n      this.writeU8(0xc4);\n      this.writeU8(size);\n    } else if (size < 0x10000) {\n      // bin 16\n      this.writeU8(0xc5);\n      this.writeU16(size);\n    } else if (size < 0x100000000) {\n      // bin 32\n      this.writeU8(0xc6);\n      this.writeU32(size);\n    } else {\n      throw new Error(`Too large binary: ${size}`);\n    }\n    const bytes = ensureUint8Array(object);\n    this.writeU8a(bytes);\n  }\n\n  private encodeArray(object: Array<unknown>, depth: number) {\n    const size = object.length;\n    if (size < 16) {\n      // fixarray\n      this.writeU8(0x90 + size);\n    } else if (size < 0x10000) {\n      // array 16\n      this.writeU8(0xdc);\n      this.writeU16(size);\n    } else if (size < 0x100000000) {\n      // array 32\n      this.writeU8(0xdd);\n      this.writeU32(size);\n    } else {\n      throw new Error(`Too large array: ${size}`);\n    }\n    for (const item of object) {\n      this.doEncode(item, depth + 1);\n    }\n  }\n\n  private countWithoutUndefined(object: Record<string, unknown>, keys: ReadonlyArray<string>): number {\n    let count = 0;\n\n    for (const key of keys) {\n      if (object[key] !== undefined) {\n        count++;\n      }\n    }\n\n    return count;\n  }\n\n  private encodeMap(object: Record<string, unknown>, depth: number) {\n    const keys = Object.keys(object);\n    if (this.sortKeys) {\n      keys.sort();\n    }\n\n    const size = this.ignoreUndefined ? this.countWithoutUndefined(object, keys) : keys.length;\n\n    if (size < 16) {\n      // fixmap\n      this.writeU8(0x80 + size);\n    } else if (size < 0x10000) {\n      // map 16\n      this.writeU8(0xde);\n      this.writeU16(size);\n    } else if (size < 0x100000000) {\n      // map 32\n      this.writeU8(0xdf);\n      this.writeU32(size);\n    } else {\n      throw new Error(`Too large map object: ${size}`);\n    }\n\n    for (const key of keys) {\n      const value = object[key];\n\n      if (!(this.ignoreUndefined && value === undefined)) {\n        this.encodeString(key);\n        this.doEncode(value, depth + 1);\n      }\n    }\n  }\n\n  private encodeExtension(ext: ExtData) {\n    const size = ext.data.length;\n    if (size === 1) {\n      // fixext 1\n      this.writeU8(0xd4);\n    } else if (size === 2) {\n      // fixext 2\n      this.writeU8(0xd5);\n    } else if (size === 4) {\n      // fixext 4\n      this.writeU8(0xd6);\n    } else if (size === 8) {\n      // fixext 8\n      this.writeU8(0xd7);\n    } else if (size === 16) {\n      // fixext 16\n      this.writeU8(0xd8);\n    } else if (size < 0x100) {\n      // ext 8\n      this.writeU8(0xc7);\n      this.writeU8(size);\n    } else if (size < 0x10000) {\n      // ext 16\n      this.writeU8(0xc8);\n      this.writeU16(size);\n    } else if (size < 0x100000000) {\n      // ext 32\n      this.writeU8(0xc9);\n      this.writeU32(size);\n    } else {\n      throw new Error(`Too large extension object: ${size}`);\n    }\n    this.writeI8(ext.type);\n    this.writeU8a(ext.data);\n  }\n\n  private writeU8(value: number) {\n    this.ensureBufferSizeToWrite(1);\n\n    this.view.setUint8(this.pos, value);\n    this.pos++;\n  }\n\n  private writeU8a(values: ArrayLike<number>) {\n    const size = values.length;\n    this.ensureBufferSizeToWrite(size);\n\n    this.bytes.set(values, this.pos);\n    this.pos += size;\n  }\n\n  private writeI8(value: number) {\n    this.ensureBufferSizeToWrite(1);\n\n    this.view.setInt8(this.pos, value);\n    this.pos++;\n  }\n\n  private writeU16(value: number) {\n    this.ensureBufferSizeToWrite(2);\n\n    this.view.setUint16(this.pos, value);\n    this.pos += 2;\n  }\n\n  private writeI16(value: number) {\n    this.ensureBufferSizeToWrite(2);\n\n    this.view.setInt16(this.pos, value);\n    this.pos += 2;\n  }\n\n  private writeU32(value: number) {\n    this.ensureBufferSizeToWrite(4);\n\n    this.view.setUint32(this.pos, value);\n    this.pos += 4;\n  }\n\n  private writeI32(value: number) {\n    this.ensureBufferSizeToWrite(4);\n\n    this.view.setInt32(this.pos, value);\n    this.pos += 4;\n  }\n\n  private writeF32(value: number) {\n    this.ensureBufferSizeToWrite(4);\n    this.view.setFloat32(this.pos, value);\n    this.pos += 4;\n  }\n\n  private writeF64(value: number) {\n    this.ensureBufferSizeToWrite(8);\n    this.view.setFloat64(this.pos, value);\n    this.pos += 8;\n  }\n\n  private writeU64(value: number) {\n    this.ensureBufferSizeToWrite(8);\n\n    setUint64(this.view, this.pos, value);\n    this.pos += 8;\n  }\n\n  private writeI64(value: number) {\n    this.ensureBufferSizeToWrite(8);\n\n    setInt64(this.view, this.pos, value);\n    this.pos += 8;\n  }\n}\n","import { Encoder } from \"./Encoder\";\nimport type { ExtensionCodecType } from \"./ExtensionCodec\";\nimport type { ContextOf, SplitUndefined } from \"./context\";\n\nexport type EncodeOptions<ContextType = undefined> = Partial<\n  Readonly<{\n    extensionCodec: ExtensionCodecType<ContextType>;\n\n    /**\n     * The maximum depth in nested objects and arrays.\n     *\n     * Defaults to 100.\n     */\n    maxDepth: number;\n\n    /**\n     * The initial size of the internal buffer.\n     *\n     * Defaults to 2048.\n     */\n    initialBufferSize: number;\n\n    /**\n     * If `true`, the keys of an object is sorted. In other words, the encoded\n     * binary is canonical and thus comparable to another encoded binary.\n     *\n     * Defaults to `false`. If enabled, it spends more time in encoding objects.\n     */\n    sortKeys: boolean;\n    /**\n     * If `true`, non-integer numbers are encoded in float32, not in float64 (the default).\n     *\n     * Only use it if precisions don't matter.\n     *\n     * Defaults to `false`.\n     */\n    forceFloat32: boolean;\n\n    /**\n     * If `true`, an object property with `undefined` value are ignored.\n     * e.g. `{ foo: undefined }` will be encoded as `{}`, as `JSON.stringify()` does.\n     *\n     * Defaults to `false`. If enabled, it spends more time in encoding objects.\n     */\n    ignoreUndefined: boolean;\n\n    /**\n     * If `true`, integer numbers are encoded as floating point numbers,\n     * with the `forceFloat32` option taken into account.\n     *\n     * Defaults to `false`.\n     */\n    forceIntegerToFloat: boolean;\n  }>\n> &\n  ContextOf<ContextType>;\n\nconst defaultEncodeOptions: EncodeOptions = {};\n\n/**\n * It encodes `value` in the MessagePack format and\n * returns a byte buffer.\n *\n * The returned buffer is a slice of a larger `ArrayBuffer`, so you have to use its `#byteOffset` and `#byteLength` in order to convert it to another typed arrays including NodeJS `Buffer`.\n */\nexport function encode<ContextType = undefined>(\n  value: unknown,\n  options: EncodeOptions<SplitUndefined<ContextType>> = defaultEncodeOptions as any,\n): Uint8Array {\n  const encoder = new Encoder(\n    options.extensionCodec,\n    (options as typeof options & { context: any }).context,\n    options.maxDepth,\n    options.initialBufferSize,\n    options.sortKeys,\n    options.forceFloat32,\n    options.ignoreUndefined,\n    options.forceIntegerToFloat,\n  );\n  return encoder.encodeSharedRef(value);\n}\n","export function prettyByte(byte: number): string {\n  return `${byte < 0 ? \"-\" : \"\"}0x${Math.abs(byte).toString(16).padStart(2, \"0\")}`;\n}\n","import { utf8DecodeJs } from \"./utils/utf8\";\n\nconst DEFAULT_MAX_KEY_LENGTH = 16;\nconst DEFAULT_MAX_LENGTH_PER_KEY = 16;\n\nexport interface KeyDecoder {\n  canBeCached(byteLength: number): boolean;\n  decode(bytes: Uint8Array, inputOffset: number, byteLength: number): string;\n}\ninterface KeyCacheRecord {\n  readonly bytes: Uint8Array;\n  readonly str: string;\n}\n\nexport class CachedKeyDecoder implements KeyDecoder {\n  hit = 0;\n  miss = 0;\n  private readonly caches: Array<Array<KeyCacheRecord>>;\n\n  constructor(readonly maxKeyLength = DEFAULT_MAX_KEY_LENGTH, readonly maxLengthPerKey = DEFAULT_MAX_LENGTH_PER_KEY) {\n    // avoid `new Array(N)`, which makes a sparse array,\n    // because a sparse array is typically slower than a non-sparse array.\n    this.caches = [];\n    for (let i = 0; i < this.maxKeyLength; i++) {\n      this.caches.push([]);\n    }\n  }\n\n  public canBeCached(byteLength: number): boolean {\n    return byteLength > 0 && byteLength <= this.maxKeyLength;\n  }\n\n  private find(bytes: Uint8Array, inputOffset: number, byteLength: number): string | null {\n    const records = this.caches[byteLength - 1]!;\n\n    FIND_CHUNK: for (const record of records) {\n      const recordBytes = record.bytes;\n\n      for (let j = 0; j < byteLength; j++) {\n        if (recordBytes[j] !== bytes[inputOffset + j]) {\n          continue FIND_CHUNK;\n        }\n      }\n      return record.str;\n    }\n    return null;\n  }\n\n  private store(bytes: Uint8Array, value: string) {\n    const records = this.caches[bytes.length - 1]!;\n    const record: KeyCacheRecord = { bytes, str: value };\n\n    if (records.length >= this.maxLengthPerKey) {\n      // `records` are full!\n      // Set `record` to an arbitrary position.\n      records[(Math.random() * records.length) | 0] = record;\n    } else {\n      records.push(record);\n    }\n  }\n\n  public decode(bytes: Uint8Array, inputOffset: number, byteLength: number): string {\n    const cachedValue = this.find(bytes, inputOffset, byteLength);\n    if (cachedValue != null) {\n      this.hit++;\n      return cachedValue;\n    }\n    this.miss++;\n\n    const str = utf8DecodeJs(bytes, inputOffset, byteLength);\n    // Ensure to copy a slice of bytes because the byte may be NodeJS Buffer and Buffer#slice() returns a reference to its internal ArrayBuffer.\n    const slicedCopyOfBytes = Uint8Array.prototype.slice.call(bytes, inputOffset, inputOffset + byteLength);\n    this.store(slicedCopyOfBytes, str);\n    return str;\n  }\n}\n","import { prettyByte } from \"./utils/prettyByte\";\nimport { ExtensionCodec, ExtensionCodecType } from \"./ExtensionCodec\";\nimport { getInt64, getUint64, UINT32_MAX } from \"./utils/int\";\nimport { utf8DecodeJs, TEXT_DECODER_THRESHOLD, utf8DecodeTD } from \"./utils/utf8\";\nimport { createDataView, ensureUint8Array } from \"./utils/typedArrays\";\nimport { CachedKeyDecoder, KeyDecoder } from \"./CachedKeyDecoder\";\nimport { DecodeError } from \"./DecodeError\";\n\nconst enum State {\n  ARRAY,\n  MAP_KEY,\n  MAP_VALUE,\n}\n\ntype MapKeyType = string | number;\n\nconst isValidMapKeyType = (key: unknown): key is MapKeyType => {\n  const keyType = typeof key;\n\n  return keyType === \"string\" || keyType === \"number\";\n};\n\ntype StackMapState = {\n  type: State.MAP_KEY | State.MAP_VALUE;\n  size: number;\n  key: MapKeyType | null;\n  readCount: number;\n  map: Record<string, unknown>;\n};\n\ntype StackArrayState = {\n  type: State.ARRAY;\n  size: number;\n  array: Array<unknown>;\n  position: number;\n};\n\ntype StackState = StackArrayState | StackMapState;\n\nconst HEAD_BYTE_REQUIRED = -1;\n\nconst EMPTY_VIEW = new DataView(new ArrayBuffer(0));\nconst EMPTY_BYTES = new Uint8Array(EMPTY_VIEW.buffer);\n\n// IE11: Hack to support IE11.\n// IE11: Drop this hack and just use RangeError when IE11 is obsolete.\nexport const DataViewIndexOutOfBoundsError: typeof Error = (() => {\n  try {\n    // IE11: The spec says it should throw RangeError,\n    // IE11: but in IE11 it throws TypeError.\n    EMPTY_VIEW.getInt8(0);\n  } catch (e: any) {\n    return e.constructor;\n  }\n  throw new Error(\"never reached\");\n})();\n\nconst MORE_DATA = new DataViewIndexOutOfBoundsError(\"Insufficient data\");\n\nconst sharedCachedKeyDecoder = new CachedKeyDecoder();\n\nexport class Decoder<ContextType = undefined> {\n  private totalPos = 0;\n  private pos = 0;\n\n  private view = EMPTY_VIEW;\n  private bytes = EMPTY_BYTES;\n  private headByte = HEAD_BYTE_REQUIRED;\n  private readonly stack: Array<StackState> = [];\n\n  public constructor(\n    private readonly extensionCodec: ExtensionCodecType<ContextType> = ExtensionCodec.defaultCodec as any,\n    private readonly context: ContextType = undefined as any,\n    private readonly maxStrLength = UINT32_MAX,\n    private readonly maxBinLength = UINT32_MAX,\n    private readonly maxArrayLength = UINT32_MAX,\n    private readonly maxMapLength = UINT32_MAX,\n    private readonly maxExtLength = UINT32_MAX,\n    private readonly keyDecoder: KeyDecoder | null = sharedCachedKeyDecoder,\n  ) {}\n\n  private reinitializeState() {\n    this.totalPos = 0;\n    this.headByte = HEAD_BYTE_REQUIRED;\n    this.stack.length = 0;\n\n    // view, bytes, and pos will be re-initialized in setBuffer()\n  }\n\n  private setBuffer(buffer: ArrayLike<number> | BufferSource): void {\n    this.bytes = ensureUint8Array(buffer);\n    this.view = createDataView(this.bytes);\n    this.pos = 0;\n  }\n\n  private appendBuffer(buffer: ArrayLike<number> | BufferSource) {\n    if (this.headByte === HEAD_BYTE_REQUIRED && !this.hasRemaining(1)) {\n      this.setBuffer(buffer);\n    } else {\n      const remainingData = this.bytes.subarray(this.pos);\n      const newData = ensureUint8Array(buffer);\n\n      // concat remainingData + newData\n      const newBuffer = new Uint8Array(remainingData.length + newData.length);\n      newBuffer.set(remainingData);\n      newBuffer.set(newData, remainingData.length);\n      this.setBuffer(newBuffer);\n    }\n  }\n\n  private hasRemaining(size: number) {\n    return this.view.byteLength - this.pos >= size;\n  }\n\n  private createExtraByteError(posToShow: number): Error {\n    const { view, pos } = this;\n    return new RangeError(`Extra ${view.byteLength - pos} of ${view.byteLength} byte(s) found at buffer[${posToShow}]`);\n  }\n\n  /**\n   * @throws {@link DecodeError}\n   * @throws {@link RangeError}\n   */\n  public decode(buffer: ArrayLike<number> | BufferSource): unknown {\n    this.reinitializeState();\n    this.setBuffer(buffer);\n\n    const object = this.doDecodeSync();\n    if (this.hasRemaining(1)) {\n      throw this.createExtraByteError(this.pos);\n    }\n    return object;\n  }\n\n  public *decodeMulti(buffer: ArrayLike<number> | BufferSource): Generator<unknown, void, unknown> {\n    this.reinitializeState();\n    this.setBuffer(buffer);\n\n    while (this.hasRemaining(1)) {\n      yield this.doDecodeSync();\n    }\n  }\n\n  public async decodeAsync(stream: AsyncIterable<ArrayLike<number> | BufferSource>): Promise<unknown> {\n    let decoded = false;\n    let object: unknown;\n    for await (const buffer of stream) {\n      if (decoded) {\n        throw this.createExtraByteError(this.totalPos);\n      }\n\n      this.appendBuffer(buffer);\n\n      try {\n        object = this.doDecodeSync();\n        decoded = true;\n      } catch (e) {\n        if (!(e instanceof DataViewIndexOutOfBoundsError)) {\n          throw e; // rethrow\n        }\n        // fallthrough\n      }\n      this.totalPos += this.pos;\n    }\n\n    if (decoded) {\n      if (this.hasRemaining(1)) {\n        throw this.createExtraByteError(this.totalPos);\n      }\n      return object;\n    }\n\n    const { headByte, pos, totalPos } = this;\n    throw new RangeError(\n      `Insufficient data in parsing ${prettyByte(headByte)} at ${totalPos} (${pos} in the current buffer)`,\n    );\n  }\n\n  public decodeArrayStream(\n    stream: AsyncIterable<ArrayLike<number> | BufferSource>,\n  ): AsyncGenerator<unknown, void, unknown> {\n    return this.decodeMultiAsync(stream, true);\n  }\n\n  public decodeStream(stream: AsyncIterable<ArrayLike<number> | BufferSource>): AsyncGenerator<unknown, void, unknown> {\n    return this.decodeMultiAsync(stream, false);\n  }\n\n  private async *decodeMultiAsync(stream: AsyncIterable<ArrayLike<number> | BufferSource>, isArray: boolean) {\n    let isArrayHeaderRequired = isArray;\n    let arrayItemsLeft = -1;\n\n    for await (const buffer of stream) {\n      if (isArray && arrayItemsLeft === 0) {\n        throw this.createExtraByteError(this.totalPos);\n      }\n\n      this.appendBuffer(buffer);\n\n      if (isArrayHeaderRequired) {\n        arrayItemsLeft = this.readArraySize();\n        isArrayHeaderRequired = false;\n        this.complete();\n      }\n\n      try {\n        while (true) {\n          yield this.doDecodeSync();\n          if (--arrayItemsLeft === 0) {\n            break;\n          }\n        }\n      } catch (e) {\n        if (!(e instanceof DataViewIndexOutOfBoundsError)) {\n          throw e; // rethrow\n        }\n        // fallthrough\n      }\n      this.totalPos += this.pos;\n    }\n  }\n\n  private doDecodeSync(): unknown {\n    DECODE: while (true) {\n      const headByte = this.readHeadByte();\n      let object: unknown;\n\n      if (headByte >= 0xe0) {\n        // negative fixint (111x xxxx) 0xe0 - 0xff\n        object = headByte - 0x100;\n      } else if (headByte < 0xc0) {\n        if (headByte < 0x80) {\n          // positive fixint (0xxx xxxx) 0x00 - 0x7f\n          object = headByte;\n        } else if (headByte < 0x90) {\n          // fixmap (1000 xxxx) 0x80 - 0x8f\n          const size = headByte - 0x80;\n          if (size !== 0) {\n            this.pushMapState(size);\n            this.complete();\n            continue DECODE;\n          } else {\n            object = {};\n          }\n        } else if (headByte < 0xa0) {\n          // fixarray (1001 xxxx) 0x90 - 0x9f\n          const size = headByte - 0x90;\n          if (size !== 0) {\n            this.pushArrayState(size);\n            this.complete();\n            continue DECODE;\n          } else {\n            object = [];\n          }\n        } else {\n          // fixstr (101x xxxx) 0xa0 - 0xbf\n          const byteLength = headByte - 0xa0;\n          object = this.decodeUtf8String(byteLength, 0);\n        }\n      } else if (headByte === 0xc0) {\n        // nil\n        object = null;\n      } else if (headByte === 0xc2) {\n        // false\n        object = false;\n      } else if (headByte === 0xc3) {\n        // true\n        object = true;\n      } else if (headByte === 0xca) {\n        // float 32\n        object = this.readF32();\n      } else if (headByte === 0xcb) {\n        // float 64\n        object = this.readF64();\n      } else if (headByte === 0xcc) {\n        // uint 8\n        object = this.readU8();\n      } else if (headByte === 0xcd) {\n        // uint 16\n        object = this.readU16();\n      } else if (headByte === 0xce) {\n        // uint 32\n        object = this.readU32();\n      } else if (headByte === 0xcf) {\n        // uint 64\n        object = this.readU64();\n      } else if (headByte === 0xd0) {\n        // int 8\n        object = this.readI8();\n      } else if (headByte === 0xd1) {\n        // int 16\n        object = this.readI16();\n      } else if (headByte === 0xd2) {\n        // int 32\n        object = this.readI32();\n      } else if (headByte === 0xd3) {\n        // int 64\n        object = this.readI64();\n      } else if (headByte === 0xd9) {\n        // str 8\n        const byteLength = this.lookU8();\n        object = this.decodeUtf8String(byteLength, 1);\n      } else if (headByte === 0xda) {\n        // str 16\n        const byteLength = this.lookU16();\n        object = this.decodeUtf8String(byteLength, 2);\n      } else if (headByte === 0xdb) {\n        // str 32\n        const byteLength = this.lookU32();\n        object = this.decodeUtf8String(byteLength, 4);\n      } else if (headByte === 0xdc) {\n        // array 16\n        const size = this.readU16();\n        if (size !== 0) {\n          this.pushArrayState(size);\n          this.complete();\n          continue DECODE;\n        } else {\n          object = [];\n        }\n      } else if (headByte === 0xdd) {\n        // array 32\n        const size = this.readU32();\n        if (size !== 0) {\n          this.pushArrayState(size);\n          this.complete();\n          continue DECODE;\n        } else {\n          object = [];\n        }\n      } else if (headByte === 0xde) {\n        // map 16\n        const size = this.readU16();\n        if (size !== 0) {\n          this.pushMapState(size);\n          this.complete();\n          continue DECODE;\n        } else {\n          object = {};\n        }\n      } else if (headByte === 0xdf) {\n        // map 32\n        const size = this.readU32();\n        if (size !== 0) {\n          this.pushMapState(size);\n          this.complete();\n          continue DECODE;\n        } else {\n          object = {};\n        }\n      } else if (headByte === 0xc4) {\n        // bin 8\n        const size = this.lookU8();\n        object = this.decodeBinary(size, 1);\n      } else if (headByte === 0xc5) {\n        // bin 16\n        const size = this.lookU16();\n        object = this.decodeBinary(size, 2);\n      } else if (headByte === 0xc6) {\n        // bin 32\n        const size = this.lookU32();\n        object = this.decodeBinary(size, 4);\n      } else if (headByte === 0xd4) {\n        // fixext 1\n        object = this.decodeExtension(1, 0);\n      } else if (headByte === 0xd5) {\n        // fixext 2\n        object = this.decodeExtension(2, 0);\n      } else if (headByte === 0xd6) {\n        // fixext 4\n        object = this.decodeExtension(4, 0);\n      } else if (headByte === 0xd7) {\n        // fixext 8\n        object = this.decodeExtension(8, 0);\n      } else if (headByte === 0xd8) {\n        // fixext 16\n        object = this.decodeExtension(16, 0);\n      } else if (headByte === 0xc7) {\n        // ext 8\n        const size = this.lookU8();\n        object = this.decodeExtension(size, 1);\n      } else if (headByte === 0xc8) {\n        // ext 16\n        const size = this.lookU16();\n        object = this.decodeExtension(size, 2);\n      } else if (headByte === 0xc9) {\n        // ext 32\n        const size = this.lookU32();\n        object = this.decodeExtension(size, 4);\n      } else {\n        throw new DecodeError(`Unrecognized type byte: ${prettyByte(headByte)}`);\n      }\n\n      this.complete();\n\n      const stack = this.stack;\n      while (stack.length > 0) {\n        // arrays and maps\n        const state = stack[stack.length - 1]!;\n        if (state.type === State.ARRAY) {\n          state.array[state.position] = object;\n          state.position++;\n          if (state.position === state.size) {\n            stack.pop();\n            object = state.array;\n          } else {\n            continue DECODE;\n          }\n        } else if (state.type === State.MAP_KEY) {\n          if (!isValidMapKeyType(object)) {\n            throw new DecodeError(\"The type of key must be string or number but \" + typeof object);\n          }\n          if (object === \"__proto__\") {\n            throw new DecodeError(\"The key __proto__ is not allowed\");\n          }\n\n          state.key = object;\n          state.type = State.MAP_VALUE;\n          continue DECODE;\n        } else {\n          // it must be `state.type === State.MAP_VALUE` here\n\n          state.map[state.key!] = object;\n          state.readCount++;\n\n          if (state.readCount === state.size) {\n            stack.pop();\n            object = state.map;\n          } else {\n            state.key = null;\n            state.type = State.MAP_KEY;\n            continue DECODE;\n          }\n        }\n      }\n\n      return object;\n    }\n  }\n\n  private readHeadByte(): number {\n    if (this.headByte === HEAD_BYTE_REQUIRED) {\n      this.headByte = this.readU8();\n      // console.log(\"headByte\", prettyByte(this.headByte));\n    }\n\n    return this.headByte;\n  }\n\n  private complete(): void {\n    this.headByte = HEAD_BYTE_REQUIRED;\n  }\n\n  private readArraySize(): number {\n    const headByte = this.readHeadByte();\n\n    switch (headByte) {\n      case 0xdc:\n        return this.readU16();\n      case 0xdd:\n        return this.readU32();\n      default: {\n        if (headByte < 0xa0) {\n          return headByte - 0x90;\n        } else {\n          throw new DecodeError(`Unrecognized array type byte: ${prettyByte(headByte)}`);\n        }\n      }\n    }\n  }\n\n  private pushMapState(size: number) {\n    if (size > this.maxMapLength) {\n      throw new DecodeError(`Max length exceeded: map length (${size}) > maxMapLengthLength (${this.maxMapLength})`);\n    }\n\n    this.stack.push({\n      type: State.MAP_KEY,\n      size,\n      key: null,\n      readCount: 0,\n      map: {},\n    });\n  }\n\n  private pushArrayState(size: number) {\n    if (size > this.maxArrayLength) {\n      throw new DecodeError(`Max length exceeded: array length (${size}) > maxArrayLength (${this.maxArrayLength})`);\n    }\n\n    this.stack.push({\n      type: State.ARRAY,\n      size,\n      array: new Array<unknown>(size),\n      position: 0,\n    });\n  }\n\n  private decodeUtf8String(byteLength: number, headerOffset: number): string {\n    if (byteLength > this.maxStrLength) {\n      throw new DecodeError(\n        `Max length exceeded: UTF-8 byte length (${byteLength}) > maxStrLength (${this.maxStrLength})`,\n      );\n    }\n\n    if (this.bytes.byteLength < this.pos + headerOffset + byteLength) {\n      throw MORE_DATA;\n    }\n\n    const offset = this.pos + headerOffset;\n    let object: string;\n    if (this.stateIsMapKey() && this.keyDecoder?.canBeCached(byteLength)) {\n      object = this.keyDecoder.decode(this.bytes, offset, byteLength);\n    } else if (byteLength > TEXT_DECODER_THRESHOLD) {\n      object = utf8DecodeTD(this.bytes, offset, byteLength);\n    } else {\n      object = utf8DecodeJs(this.bytes, offset, byteLength);\n    }\n    this.pos += headerOffset + byteLength;\n    return object;\n  }\n\n  private stateIsMapKey(): boolean {\n    if (this.stack.length > 0) {\n      const state = this.stack[this.stack.length - 1]!;\n      return state.type === State.MAP_KEY;\n    }\n    return false;\n  }\n\n  private decodeBinary(byteLength: number, headOffset: number): Uint8Array {\n    if (byteLength > this.maxBinLength) {\n      throw new DecodeError(`Max length exceeded: bin length (${byteLength}) > maxBinLength (${this.maxBinLength})`);\n    }\n\n    if (!this.hasRemaining(byteLength + headOffset)) {\n      throw MORE_DATA;\n    }\n\n    const offset = this.pos + headOffset;\n    const object = this.bytes.subarray(offset, offset + byteLength);\n    this.pos += headOffset + byteLength;\n    return object;\n  }\n\n  private decodeExtension(size: number, headOffset: number): unknown {\n    if (size > this.maxExtLength) {\n      throw new DecodeError(`Max length exceeded: ext length (${size}) > maxExtLength (${this.maxExtLength})`);\n    }\n\n    const extType = this.view.getInt8(this.pos + headOffset);\n    const data = this.decodeBinary(size, headOffset + 1 /* extType */);\n    return this.extensionCodec.decode(data, extType, this.context);\n  }\n\n  private lookU8() {\n    return this.view.getUint8(this.pos);\n  }\n\n  private lookU16() {\n    return this.view.getUint16(this.pos);\n  }\n\n  private lookU32() {\n    return this.view.getUint32(this.pos);\n  }\n\n  private readU8(): number {\n    const value = this.view.getUint8(this.pos);\n    this.pos++;\n    return value;\n  }\n\n  private readI8(): number {\n    const value = this.view.getInt8(this.pos);\n    this.pos++;\n    return value;\n  }\n\n  private readU16(): number {\n    const value = this.view.getUint16(this.pos);\n    this.pos += 2;\n    return value;\n  }\n\n  private readI16(): number {\n    const value = this.view.getInt16(this.pos);\n    this.pos += 2;\n    return value;\n  }\n\n  private readU32(): number {\n    const value = this.view.getUint32(this.pos);\n    this.pos += 4;\n    return value;\n  }\n\n  private readI32(): number {\n    const value = this.view.getInt32(this.pos);\n    this.pos += 4;\n    return value;\n  }\n\n  private readU64(): number {\n    const value = getUint64(this.view, this.pos);\n    this.pos += 8;\n    return value;\n  }\n\n  private readI64(): number {\n    const value = getInt64(this.view, this.pos);\n    this.pos += 8;\n    return value;\n  }\n\n  private readF32() {\n    const value = this.view.getFloat32(this.pos);\n    this.pos += 4;\n    return value;\n  }\n\n  private readF64() {\n    const value = this.view.getFloat64(this.pos);\n    this.pos += 8;\n    return value;\n  }\n}\n","import { Decoder } from \"./Decoder\";\nimport type { ExtensionCodecType } from \"./ExtensionCodec\";\nimport type { ContextOf, SplitUndefined } from \"./context\";\n\nexport type DecodeOptions<ContextType = undefined> = Readonly<\n  Partial<{\n    extensionCodec: ExtensionCodecType<ContextType>;\n\n    /**\n     * Maximum string length.\n     *\n     * Defaults to 4_294_967_295 (UINT32_MAX).\n     */\n    maxStrLength: number;\n    /**\n     * Maximum binary length.\n     *\n     * Defaults to 4_294_967_295 (UINT32_MAX).\n     */\n    maxBinLength: number;\n    /**\n     * Maximum array length.\n     *\n     * Defaults to 4_294_967_295 (UINT32_MAX).\n     */\n    maxArrayLength: number;\n    /**\n     * Maximum map length.\n     *\n     * Defaults to 4_294_967_295 (UINT32_MAX).\n     */\n    maxMapLength: number;\n    /**\n     * Maximum extension length.\n     *\n     * Defaults to 4_294_967_295 (UINT32_MAX).\n     */\n    maxExtLength: number;\n  }>\n> &\n  ContextOf<ContextType>;\n\nexport const defaultDecodeOptions: DecodeOptions = {};\n\n/**\n * It decodes a single MessagePack object in a buffer.\n *\n * This is a synchronous decoding function.\n * See other variants for asynchronous decoding: {@link decodeAsync()}, {@link decodeStream()}, or {@link decodeArrayStream()}.\n *\n * @throws {@link RangeError} if the buffer is incomplete, including the case where the buffer is empty.\n * @throws {@link DecodeError} if the buffer contains invalid data.\n */\nexport function decode<ContextType = undefined>(\n  buffer: ArrayLike<number> | BufferSource,\n  options: DecodeOptions<SplitUndefined<ContextType>> = defaultDecodeOptions as any,\n): unknown {\n  const decoder = new Decoder(\n    options.extensionCodec,\n    (options as typeof options & { context: any }).context,\n    options.maxStrLength,\n    options.maxBinLength,\n    options.maxArrayLength,\n    options.maxMapLength,\n    options.maxExtLength,\n  );\n  return decoder.decode(buffer);\n}\n\n/**\n * It decodes multiple MessagePack objects in a buffer.\n * This is corresponding to {@link decodeMultiStream()}.\n *\n * @throws {@link RangeError} if the buffer is incomplete, including the case where the buffer is empty.\n * @throws {@link DecodeError} if the buffer contains invalid data.\n */\nexport function decodeMulti<ContextType = undefined>(\n  buffer: ArrayLike<number> | BufferSource,\n  options: DecodeOptions<SplitUndefined<ContextType>> = defaultDecodeOptions as any,\n): Generator<unknown, void, unknown> {\n  const decoder = new Decoder(\n    options.extensionCodec,\n    (options as typeof options & { context: any }).context,\n    options.maxStrLength,\n    options.maxBinLength,\n    options.maxArrayLength,\n    options.maxMapLength,\n    options.maxExtLength,\n  );\n  return decoder.decodeMulti(buffer);\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// REF: https://raft.github.io/raft.pdf\n\nimport * as msgpack from '@msgpack/msgpack';\n\n// Encapsulation of a node address and a function to send a message to it.\nclass RaftNode {\n\t#address;\n\t#send;\n\tconstructor(address, send) {\n\t\tthis.#address = address;\n\t\tthis.#send = send;\n\t}\n\tget address() { return this.#address; }\n\tsend(data) { this.#send(data); }\n}\n\n// Encapsulation of a message used in the Raft protocol.  This implementation\n// provides two serialization options: JSON object, and JSON array.\nclass RaftMessage {\n\t#state;\n\t#leader;\n\t#term;\n\t#address;\n\t#type;\n\t#granted;\n\tconstructor(state, leader, term, address, type, granted) {\n\t\tthis.#state = state;\n\t\tthis.#leader = leader;\n\t\tthis.#term = term;\n\t\tthis.#address = address;\n\t\tthis.#type = type;\n\t\tthis.#granted = granted;\n\t}\n\tget state() { return this.#state; }\n\tget leader() { return this.#leader; }\n\tget term() { return this.#term; }\n\tget address() { return this.#address; }\n\tget type() { return this.#type; }\n\tget granted() { return this.#granted; }\n\ttoJSON() {\n\t\treturn {\n\t\t\tstate: this.#state,\n\t\t\tleader: this.#leader,\n\t\t\tterm: this.#term,\n\t\t\taddress: this.#address,\n\t\t\ttype: this.#type,\n\t\t\tgranted: this.#granted,\n\t\t};\n\t}\n\tstatic fromJSON(json) {\n\t\tconst msg = new RaftMessage(json.state, json.leader, json.term, json.address, json.type, json.granted);\n\t\treturn msg;\n\t}\n\ttoArray() {\n\t\treturn [\n\t\t\tthis.#state,\n\t\t\tthis.#leader,\n\t\t\tthis.#term,\n\t\t\tthis.#address,\n\t\t\tthis.#type,\n\t\t\tthis.#granted,\n\t\t]\n\t}\n\tstatic from(array) {\n\t\treturn new RaftMessage(array[0], array[1], array[2], array[3], array[4], array[5]);\n\t}\n\ttoBuffer() {\n\t\treturn msgpack.encode(this.toArray());\n\t}\n\tstatic fromBuffer(buffer) {\n\t\tconst array = msgpack.decode(buffer);\n\t\treturn RaftMessage.from(array);\n\t}\n}\n\nexport class Raft extends EventTarget {\n\t// §5.1: At any given time, in one of three states: leader, follower,\n\t// or candidate.\n\tstatic LEADER = 1;\n\tstatic CANDIDATE = 2;\n\tstatic FOLLOWER = 3;\n\tstatic states = {\n\t\t1: \"LEADER\",\n\t\t2: \"CANDIDATE\",\n\t\t3: \"FOLLOWER\",\n\t};\n\n\tstatic RPC_REQUEST_VOTE = \"poll\";  // Initiated by candidates during elections.\n\tstatic RPC_VOTE = \"vote\";\n\tstatic RPC_APPEND_ENTRY = \"append\";  // Initiated by leaders as heartbeat.\n\n\t#address;\n\t#electionMinTimeout;\n\t#electionMaxTimeout;\n\t#heatbeatInterval;\n\n\t#heartbeatExpiration = undefined;\n\t#electionExpiration = undefined;\n\n\t#votesFor = undefined;\n\t#votesGranted = 0;\n\n\t#nodes = [];\n\n\t// §5.2: When nodes start up, they begin as followers.\n\t#state = Raft.FOLLOWER;\n\t#leader = undefined;\n\t#currentTerm = 0;\n\n\tconstructor(settings) {\n\t\tsuper();\n\t\tthis.#address = settings.address;\n\t\tthis.#electionMinTimeout = settings.electionMinTimeout;\n\t\tthis.#electionMaxTimeout = settings.electionMaxTimeout;\n\t\tthis.#heatbeatInterval = settings.heartbeatInterval;\n\n\t\t// §5.2: If a follower receives no communication over a period of time\n\t\t// called the election timeout, then it assumes there is no viable\n\t\t// leader and begins an election to choose a new leader.\n\t\tthis.#electionExpiration = performance.now() + this.#electionTimeout();\n\t}\n\n\tget leader() { return this.#state === Raft.LEADER; }\n\n\t// §5.2: A candidate wins an election if it receives votes from a\n\t// majority of the servers in the full cluster for the same term.\n\t#resetVotes() {\n\t\tthis.#votesFor = undefined;\n\t\tthis.#votesGranted = 0;\n\t}\n\n\tonRaftMessage(data, sendReply) {\n//\t\tconsole.log(`RAFT: onRaftMessage(${data})`);\n\t\tconst msg = RaftMessage.fromBuffer(data);\n\t\t// §5.1:  Current terms are exchanged whenever servers\n\t\t// communicate\n\t\tif(msg.term > this.#currentTerm) {\n\t\t\t// §5.1: If a candidate or leader discovers that its\n\t\t\t// term is out of date, it immediately reverts to\n\t\t\t// follower state.\n\t\t\tif(this.#state !== Raft.FOLLOWER) {\n\t\t\t\tthis.#state = Raft.FOLLOWER;\n\t\t\t}\n\t\t\tthis.#heartbeatExpiration = undefined;\n\t\t\tthis.#electionExpiration = performance.now() + this.#electionTimeout();\n\t\t\tif(this.#leader !== msg.leader) {\n\t\t\t\tthis.#leader = msg.leader;\n\t\t\t}\n\t\t\tthis.#currentTerm = msg.term;\n\t\t\tthis.#resetVotes();\n\t\t} else if(msg.term < this.#currentTerm) {\n\t\t\t// §5.1: If a server receives a request with a stale\n\t\t\t// term number, it rejects the request\n\t\t\treturn;\n\t\t}\n\n\t\tswitch(this.#state) {\n\t\tcase Raft.FOLLOWER:\n\t\t\tswitch(msg.type) {\n\t\t\tcase Raft.RPC_REQUEST_VOTE:\n\t\t\t\tthis.#onRequestVote(msg, sendReply);\n\t\t\t\tbreak;\n\t\t\tcase Raft.RPC_APPEND_ENTRY:\n\t\t\t\t// §5.2: Leaders send periodic heartbeats to\n\t\t\t\t// all followers in order to maintain their\n\t\t\t\t// authority.\n\t\t\t\tthis.#electionExpiration = performance.now() + this.#electionTimeout();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Raft.CANDIDATE:\n\t\t\tswitch(msg.type) {\n\t\t\tcase Raft.RPC_VOTE:\n\t\t\t\tthis.#onVote(msg);\n\t\t\t\tbreak;\n\t\t\tcase Raft.RPC_APPEND_ENTRY:\n\t\t\t\t// §5.2: If the leader’s term is at least\n\t\t\t\t// as large as the candidate’s current term,\n\t\t\t\t// then the candidate recognizes the leader as\n\t\t\t\t// legitimate and returns to follower state.\n\t\t\t\tthis.#leader = msg.leader;\n\t\t\t\tthis.#state = Raft.FOLLOWER;\n\t\t\t\tthis.#heartbeatExpiration = undefined;\n\t\t\t\tthis.#electionExpiration = performance.now() + this.#electionTimeout();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// §5.2: Each node will vote for at most one candidate in a\n\t// given term, on a first-come-first-served basis.\n\t#onRequestVote(msg, sendReply) {\n\t\tif(typeof this.#votesFor !== \"undefined\"\n\t\t\t&& msg.address !== this.#votesFor)\n\t\t{\n\t\t\tconst msg = new RaftMessage(this.#state, this.#leader, this.#currentTerm, this.#address, Raft.RPC_VOTE, false);\n\t\t\tsendReply(msg.toBuffer());\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#leader = msg.address;\n\t\tif(this.#currentTerm !== msg.term) {\n\t\t\tthis.#currentTerm = msg.term;\n\t\t\tthis.#resetVotes();\n\t\t}\n\t\tconst reply = new RaftMessage(this.#state, this.#leader, this.#currentTerm, this.#address, Raft.RPC_VOTE, true);\n\t\tsendReply(reply.toBuffer());\n\t\tthis.#electionExpiration = performance.now() + this.#electionTimeout();\n\t}\n\n\t#onVote(msg) {\n\t\tif(this.#state !== Raft.CANDIDATE) {\n\t\t\treturn;\n\t\t}\n\t\tif(msg.granted) {\n\t\t\tthis.#votesGranted++;\n\t\t}\n\t\t// §5.2: A candidate wins an election if it receives votes from\n\t\t// a majority of the servers in the full cluster for the same\n\t\t// term.\n\t\tif(this.#hasQuorum(this.#votesGranted)) {\n\t\t\t// §5.2: Once a candidate wins an election, it becomes\n\t\t\t// leader.\n\t\t\tthis.#becomeLeader();\n\t\t}\n\t}\n\n\t#becomeLeader() {\n\t\tthis.#state = Raft.LEADER;\n\t\tthis.#leader = this.#address;\n\t\tthis.#heartbeatExpiration = performance.now() + this.#heatbeatInterval;\n\t\tthis.#electionExpiration = undefined;\n\t\t// §5.2: Send heartbeat messages to all of the other servers to\n\t\t// establish its authority and prevent new elections.\n\t\tconst reply = new RaftMessage(this.#state, this.#leader, this.#currentTerm, this.#address, Raft.RPC_APPEND_ENTRY);\n\t\tthis.#sendRaftMessage(Raft.FOLLOWER, reply);\n\t}\n\n\t#hasQuorum(vote_count) {\n\t\treturn vote_count >= this.#majorityCount();\n\t}\n\n\t#majorityCount() {\n\t\treturn Math.ceil(this.#nodes.length / 2) + 1;\n\t}\n\n\tupdate(timestamp) {\n\t\tif(timestamp >= this.#heartbeatExpiration) {\n\t\t\tthis.#onHeartbeatExpiration();\n\t\t}\n\t\tif(timestamp >= this.#electionExpiration) {\n\t\t\tthis.#onElectionExpiration();\n\t\t}\n\t}\n\n\t// §5.2: Leaders send periodic heartbeats to all followers in\n\t// order to maintain their authority.\n\t#onHeartbeatExpiration() {\n\t\tif(this.#state !== Raft.LEADER) {\n\t\t\tthis.#heartbeatExpiration = undefined;\n\t\t\treturn;\n\t\t}\n\t\tconst msg = new RaftMessage(this.#state, this.#leader, this.#currentTerm, this.#address, Raft.RPC_APPEND_ENTRY);\n\t\tthis.#sendRaftMessage(Raft.FOLLOWER, msg);\n\t\tthis.#heartbeatExpiration = performance.now() + this.#heatbeatInterval;\n\t}\n\n\t// §5.2: If a follower receives no communication over a period of time\n\t// called the election timeout, then it assumes there is no viable\n\t// leader and begins an election to choose a new leader.\n\t#onElectionExpiration() {\n\t\tif(this.#state === Raft.LEADER) {\n\t\t\tthis.#electionExpiration = undefined;\n\t\t\treturn;\n\t\t}\n\t\tthis.#startElection();\n\t}\n\n\t#sendRaftMessage(target, msg) {\n//\t\tconsole.log(`#sendRaftMessage(${Raft.states[target]}, ${msg.toString()})`);\n\t\tconst data = msg.toBuffer();\n\t\tswitch(target) {\n\t\tcase Raft.FOLLOWER:\n\t\t\tfor(const node of this.#nodes) {\n\t\t\t\tif(node.address === this.#leader) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnode.send(data);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// §5.2: Raft uses randomized election timeouts to ensure that\n\t// split votes are rare and that they are resolved quickly.\n\t#electionTimeout() {\n\t\treturn Math.random() * (this.#electionMaxTimeout - this.#electionMinTimeout + 1) + this.#electionMinTimeout;\n\t}\n\n\t// §5.2: To begin an election, a follower increments its current\n\t// term and transitions to candidate state.\n\t#startElection() {\n//\t\tconsole.log(\"#startElection\");\n\t\tif(this.#state !== Raft.CANDIDATE) {\n\t\t\tthis.#state = Raft.CANDIDATE;\n\t\t}\n\t\tthis.#heartbeatExpiration = undefined;\n\t\tthis.#electionExpiration = performance.now() + this.#electionTimeout();\n\t\tthis.#leader = undefined;\n\t\tthis.#currentTerm++;\n\n\t\t// §5.2: Vote for self.\n\t\tthis.#votesFor = this.#address;\n\t\tthis.#votesGranted = 1;\n\n\t\t// §5.2: Issues RequestVote RPCs in parallel to each of\n\t\t// the other nodes in the cluster.\n\t\tconst msg = new RaftMessage(this.#state, this.#leader, this.#currentTerm, this.#address, Raft.RPC_REQUEST_VOTE);\n\t\tthis.#sendRaftMessage(Raft.FOLLOWER, msg);\n\t}\n\n\tjoin(address, send) {\n\t\tconsole.log(`RAFT: join(${address})`);\n\t\tif(address === this.#address) {\n\t\t\treturn;\n\t\t}\n\t\tconst pos = this.#nodes.findIndex(node => node.address === address);\n\t\tif(pos !== -1) {\n\t\t\treturn;\n\t\t}\n\t\tthis.#nodes.push(new RaftNode(address, send));\n\t\tthis.dispatchEvent(new CustomEvent('join', {\n\t\t\tdetail: {\n\t\t\t\taddress,\n\t\t\t}\n\t\t}));\n\t}\n\n\tleave(address) {\n\t\tconsole.log(`RAFT: leave(${address})`);\n\t\tconst pos = this.#nodes.findIndex(node => node.address === address);\n\t\tif(pos === -1) {\n\t\t\treturn;\n\t\t}\n\t\tthis.#nodes.splice(pos, 1);\n\t\tthis.dispatchEvent(new CustomEvent('leave', {\n\t\t\tdetail: {\n\t\t\t\taddress,\n\t\t\t}\n\t\t}));\n\t}\n\n\tclose() {\n\t\tconsole.log(`RAFT: close)`);\n\t\tif(this.#state === 0) {\n\t\t\treturn;\n\t\t}\n\t\tthis.#state = 0;\n\t\tthis.dispatchEvent(new CustomEvent('closing'));\n\t\tfor(const node of this.#nodes) {\n\t\t\tthis.leave(node.address);\n\t\t}\n\t\tthis.dispatchEvent(new CustomEvent('closed'));\n\t\tthis.#heartbeatExpiration = undefined;\n\t\tthis.#electionExpiration = undefined;\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport { RTCMesh } from '@dsbunny/rtcmesh';\nimport { Raft } from '@dsbunny/raft';\nimport { Cluster } from './cluster.js';\n\nconst MAX_BACKOFF_TIMEOUT = 18 * 1000;\nconst MIN_BACKOFF_TIMEOUT = 3 * 1000;\nconst CONNECT_TIMEOUT = 30 * 1000;\n\nconst ELECTION_MIN_TIMEOUT = 1500;\nconst ELECTION_MAX_TIMEOUT = 3000;\nconst HEARTBEAT_INTERVAL = 500;\n\n// a random integer between two values, inclusive\nfunction backoff_timeout() {\n        return Math.floor(Math.random() * (MAX_BACKOFF_TIMEOUT - MIN_BACKOFF_TIMEOUT + 1)) + MIN_BACKOFF_TIMEOUT;\n}\n\nclass Peer {\n\tprotected _id: string;\n\tprotected _channel: RTCDataChannel | undefined;\n\n\tconstructor(id: string) {\n\t\tthis._id = id;\n\t\tthis._channel = undefined;\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\tget readyState() {\n\t\tif(typeof this._channel === \"undefined\") {\n\t\t\treturn \"new\";\n\t\t}\n\t\treturn this._channel.readyState;\n\t}\n\tset channel(channel: RTCDataChannel) {\n\t\tthis._channel = channel;\n\t}\n\n\tsend(data: string) {\n\t\tif(this.readyState !== \"open\") {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tthis._channel?.send(data);\n\t\t} catch(e) {\n\t\t\tconsole.warn(e);\n\t\t}\n\t}\n}\n\nexport class RaftCluster implements Cluster {\n\tprotected _ws_onmessage_bound: (event: any) => void;\n\tprotected _ws_onerror_bound: (event: any) => void;\n\tprotected _ws_onclose_bound: (event: any) => void;\n\tprotected _rtc: RTCMesh;\n\tprotected _signaling_servers: any[];\n\tprotected _signaling_server_index = -1;\n\tprotected _ws: WebSocket | undefined;\n\tprotected _ws_reconnect_timeout_id: any;\n\tprotected _ws_connect_timeout_id: any;\n\tprotected _raft: Raft;\n\tprotected _peers = new Map();\n\n\tconstructor(readonly decl: any) {\n\t\tthis._signaling_servers = decl.signalingServers;\n\t\tthis._ws_onmessage_bound = (event: any) => this._ws_onmessage(event);\n\t\tthis._ws_onerror_bound = (event: any) => this._ws_onerror(event);\n\t\tthis._ws_onclose_bound = (event: any) => this._ws_onclose(event);\n\t\tthis._rtc = new RTCMesh(decl);\n\t\tthis._rtc.addEventListener('offer', (event: any) => {\n\t\t\tconsole.log(event);\n\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\"cmd\": \"offer\",\n\t\t\t\t\"target\": event.detail.id,\n\t\t\t\t\"sdp\": event.detail.sdp,\n\t\t\t}));\n\t\t});\n\t\tthis._rtc.addEventListener('answer', (event: any) => {\n\t\t\tconsole.log(event);\n\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\"cmd\": \"answer\",\n\t\t\t\t\"target\": event.detail.id,\n\t\t\t\t\"sdp\": event.detail.sdp,\n\t\t\t}));\n\t\t});\n\t\tthis._rtc.addEventListener('icecandidate', (event: any) => {\n\t\t\tconsole.log(event);\n\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\"cmd\": \"icecandidate\",\n\t\t\t\t\"target\": event.detail.id,\n\t\t\t\t\"candidate\": event.detail.candidate,\n\t\t\t}));\n\t\t});\n\t\tthis._rtc.addEventListener('disconnected', (event: any) => {\n\t\t\tconsole.warn('RTC disconnected', event);\n\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\"cmd\": \"disconnected\",\n\t\t\t\t\"target\": event.detail.id,\n\t\t\t\t\"candidate\": event.detail.candidate,\n\t\t\t}));\n\t\t});\n\t\tthis._rtc.addEventListener('failed', (event: any) => {\n\t\t\tconsole.warn('RTC failed', event);\n\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\"cmd\": \"failed\",\n\t\t\t\t\"target\": event.detail.id,\n\t\t\t}));\n\t\t});\n\t\tthis._raft = new Raft({\n\t\t\taddress: this._rtc.id,\n\t\t\telectionMinTimeout: ELECTION_MIN_TIMEOUT,\n\t\t\telectionMaxTimeout: ELECTION_MAX_TIMEOUT,\n\t\t\theartbeatInterval: HEARTBEAT_INTERVAL,\n\t\t});\n\t\tfor(const id of this._rtc.peers) {\n\t\t\tif(id === this._rtc.id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst peer = new Peer(id);\n\t\t\tthis._raft.join(id, data => peer.send(data));\n\t\t\tthis._peers.set(id, peer);\n\t\t}\n\t\tthis._rtc.addEventListener('addchannel', (event: any) => {\n\t\t\tconsole.log('RTC addchannel', event);\n\t\t\tconst peer = this._peers.get(event.detail.id);\n\t\t\tif(typeof peer === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst channel = this._rtc.user_channel(peer.id);\n\t\t\tchannel?.addEventListener('message', (event: any) => {\n\t\t\t\tthis._raft.onRaftMessage(event.data, (data: string) => peer.send(data));\n\t\t\t});\n\t\t\tpeer.channel = channel;\n\t\t});\n\t\t// §5.5: Follower and candidate crashes\n\t\t// Avoid direct failure by removing node from list, node recovery will rejoin\n\t\t// the list and update with the next hearbeat or election.\n\t\tthis._rtc.addEventListener('removechannel', (event: any) => {\n\t\t\tconsole.log('RTC removechannel', event);\n\t\t\tconst peer = this._peers.get(event.detail.id);\n\t\t\tif(typeof peer === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpeer.channel = undefined;\n\t\t});\n\t}\n\n\tget leader() { return this._raft.leader; }\n\n\tjoin() {\n\t\tconsole.log('Raft Cluster: join');\n\t\tthis._try_connect();\n\t}\n\n\tleave() {\n\t\tconsole.log('Raft Cluster: leave');\n\t}\n\n\tupdate(timestamp: number) {\n\t\tthis._raft.update(timestamp);\n\t}\n\n\tbroadcast(data: string) {\n\t\tif(this._raft.leader) {\n\t\t\tthis._rtc.broadcast(data);\n\t\t}\n\t}\n\n\taddEventListener(type: string, listener: any) {\n\t\tthis._rtc.addEventListener(type, listener);\n\t}\n\n\tremoveEventListener(type: string, listener: any) {\n\t\tthis._rtc.removeEventListener(type, listener);\n\t}\n\n\tprotected _ws_close() {\n\t\tif(typeof this._ws_connect_timeout_id !== \"undefined\") {\n\t\t\tclearTimeout(this._ws_connect_timeout_id);\n\t\t\tthis._ws_connect_timeout_id = undefined;\n\t\t}\n\t\tthis._ws?.removeEventListener('message', this._ws_onmessage_bound);\n\t\tthis._ws?.removeEventListener('error', this._ws_onerror_bound);\n\t\tthis._ws?.removeEventListener('close', this._ws_onclose_bound);\n\t\tif(this._ws?.readyState !== WebSocket.CLOSED) {\n\t\t\tthis._ws?.close(); // can raise onerror\n\t\t}\n\t\tthis._ws = undefined;\n\t}\n\n\tprotected _ws_onclose(event: Event) {\n\t\tconsole.log('WS closed.', event);\n\t\tthis._ws_close();\n\t\tthis._schedule_reconnect();\n\t}\n\n\t// The error event is fired when a connection with a WebSocket has been closed due to an error.\n\tprotected _ws_onerror(event: Event) {\n\t\tconsole.log('WS error.', event);\n\t\tthis._ws_close();\n\t\tthis._schedule_reconnect();\n\t}\n\n\tprotected _abort_connect() {\n\t\tconsole.warn(\"WS connect timeout, aborting.\");\n\t\tthis._ws_close();\n\t\tthis._schedule_reconnect();\n\t}\n\n\tprotected _ws_onmessage(event: any) {\n\t\tconsole.log(event);\n\t\tconst json = JSON.parse(event.data);\n\t\tswitch(json.cmd) {\n\t\tcase 'offer':\n\t\t\tthis._rtc.createAnswer(json.id, json.sdp);\n\t\t\tbreak;\n\t\tcase 'negotiationneeded':\n\t\t\tthis._rtc.createOffer(json.id);\n\t\t\tbreak;\n\t\tcase 'answer':\n\t\t\tthis._rtc.addAnswer(json.id, json.sdp);\n\t\t\tbreak;\n\t\tcase 'disconnected':\n\t\tcase 'failed':\n\t\t\tthis._rtc.close(json.id)\n\t\t\t\t.catch((e: any) => {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\t\t\"cmd\": \"negotiationneeded\",\n\t\t\t\t\t\t\"target\": json.id,\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\tbreak;\n\t\tcase 'icecandidate':\n\t\t\tthis._rtc.addIceCandidate(json.id, json.candidate);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t};\n\t}\n\n\tprotected _signaling_server() {\n\t\tthis._signaling_server_index = (this._signaling_server_index + 1) % this._signaling_servers.length;\n\t\treturn this._signaling_servers[this._signaling_server_index];\n\t}\n\n\tprotected _try_connect() {\n\t\tif(typeof this._ws_reconnect_timeout_id !== \"undefined\") {\n\t\t\tclearTimeout(this._ws_reconnect_timeout_id);\n\t\t\tthis._ws_reconnect_timeout_id = undefined;\n\t\t}\n\t\ttry {\n\t\t\tconst signaling_server = this._signaling_server();\n\t\t\tconsole.log(`WS connecting to ${signaling_server.url}`);\n\t\t\tthis._ws = new WebSocket(`${signaling_server.url}?group=${this._rtc.label}&id=${this._rtc.id}`);\n\t\t} catch(e: any) {\n\t\t\tconsole.warn(e);\n\t\t\tthis._ws = undefined;\n\t\t\treturn;\n\t\t}\n\t\tthis._ws_connect_timeout_id = setTimeout(this._abort_connect, CONNECT_TIMEOUT);\n\t\tthis._ws.addEventListener('open', () => {\n\t\t\tconsole.log(\"WS connected.\");\n\t\t\tif(typeof this._ws_connect_timeout_id !== \"undefined\") {\n\t\t\t\tclearTimeout(this._ws_connect_timeout_id);\n\t\t\t\tthis._ws_connect_timeout_id = undefined;\n\t\t\t}\n\t\t\tfor(const peer of this._rtc.peers) {\n\t\t\t\tif(peer === this._rtc.id) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst readyState = this._rtc.readyState(peer);\n\t\t\t\tswitch(readyState) {\n\t\t\t\tcase \"open\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"connecting\":\n\t\t\t\tcase \"closing\":\n\t\t\t\t\tconsole.log(`WEBRTC ${peer} readyState ${readyState}`);\n\t\t\t\t\tthis._rtc.close(peer)\n\t\t\t\t\t\t.catch((e: any) => {\n\t\t\t\t\t\t\tconsole.warn(e);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\t\t\t\t\"cmd\": \"negotiationneeded\",\n\t\t\t\t\t\t\t\t\"target\": peer,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(`WEBRTC ${peer} readyState ${readyState}`);\n\t\t\t\t\tthis._ws?.send(JSON.stringify({\n\t\t\t\t\t\t\"cmd\": \"negotiationneeded\",\n\t\t\t\t\t\t\"target\": peer,\n\t\t\t\t\t}));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._ws.addEventListener('message', this._ws_onmessage_bound);\n\t\tthis._ws.addEventListener('error', this._ws_onerror_bound);\n\t\tthis._ws.addEventListener('close', this._ws_onclose_bound);\n\t}\n\n\tprotected _schedule_reconnect() {\n\t\tconst delay = backoff_timeout();\n\t\tconsole.warn(\"WS reconnection in\", delay/1000, \"s\");\n\t\tthis._ws_reconnect_timeout_id = setTimeout(() => {\n\t\t\tthis._try_connect();\n\t\t}, delay);\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport * as Comlink from 'comlink';\nimport EventTarget from '@ungap/event-target';\nimport { Prefetch } from './prefetch.js';\nimport { AssetDecl } from './media.js';\nimport { PrefetchWorker } from '../workers/prefetch.worker.js';\n\nexport class ServiceWorkerPrefetch extends EventTarget implements Prefetch {\n\tprotected _activated = false;\n\tprotected _serviceWorker: ServiceWorker | undefined;\n\tprotected _prefetch: Comlink.Remote<PrefetchWorker> | undefined;\n\n\tconstructor() {\n\t\tsuper();\n\t\tif('serviceWorker' in navigator) {\n\t\t\t(async () => {\n\t\t\t\tawait this._registerServiceWorker();\n\t\t\t})();\n\t\t} else {\n\t\t\tconsole.error(\"PREFETCH: ServiceWorker not supported.\");\n\t\t}\n\t}\n\n\tprotected async _registerServiceWorker() {\n\t\tconsole.log(\"PREFETCH: Registering service worker ...\");\n\t\tif(navigator.serviceWorker.controller) {\n\t\t\tconsole.log(`PREFETCH: Currently controlled by:`, navigator.serviceWorker.controller);\n\t\t} else {\n\t\t\tconsole.log('PREFETCH: Not currently controlled by a service worker.');\n\t\t}\n\t\tnavigator.serviceWorker.addEventListener('controllerchange', () => {\n\t\t\tconsole.log(`PREFETCH: Now controlled by:`, navigator.serviceWorker.controller);\n\t\t});\n\t\t// Note href not URL.\n\t\tconst href = new URL('./prefetch.bundle.js', import.meta.url).href;\n\t\tconst serviceWorkerOptions: RegistrationOptions = {\n\t\t\tscope: '/',\n\t\t\ttype: 'module',\n\t\t};\n\t\tconst registration = await navigator.serviceWorker.register(href, serviceWorkerOptions);\n\t\tconsole.log(`PREFETCH: Service worker registration successful with scope: ${registration.scope}.`);\n      \t\tregistration.addEventListener('updatefound', () => {\n        \t\tconsole.log(\"PREFETCH: Service worker updating ...\");\n      \t\t});\n\t\tif(registration.installing) {\n\t\t\tthis._serviceWorker = registration.installing;\n\t\t\tconsole.log(\"PREFETCH: Service worker installing ...\");\n\t\t} else if(registration.waiting) {\n\t\t\tthis._serviceWorker = registration.waiting;\n\t\t\tconsole.log(\"PREFETCH: Service worker waiting ...\");\n\t\t} else if(registration.active) {\n\t\t\tthis._serviceWorker = registration.active;\n\t\t\tconsole.log(\"PREFETCH: Service worker active.\");\nconsole.log(navigator.serviceWorker);\n\t\t\tthis._onActivatedWorker();\n\t\t}\n\t\tif(typeof this._serviceWorker !== \"undefined\") {\n\t\t\tthis._serviceWorker.addEventListener('statechange', (e: Event) => {\nconsole.log(e);\n\t\t\t\tif(e.target === null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(!(e.target instanceof ServiceWorker)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconsole.log(`PREFETCH: Service worker state change: ${e.target.state}.`);\n\t\t\t});\n\t\t\tnavigator.serviceWorker.startMessages();\n\t\t}\n\t}\n\n\tasync acquireSources(scope: string, sources: AssetDecl[]) {\n\t\tconsole.log(`PREFETCH: setSources ${scope} ${JSON.stringify(sources)}`);\n\t\tif(!this._activated) {\n\t\t\tconsole.warn(`PREFETCH: Not activated.`);\n\t\t\treturn;\n\t\t}\n\t\tif(typeof this._prefetch === \"undefined\") {\n\t\t\tconsole.warn(`PREFETCH: Comlink not available.`);\n\t\t\treturn;\n\t\t}\n\t\tawait this._prefetch.setSources(scope, sources);\n\t}\n\n\tasync releaseSources(_scope: string): Promise<void> {\n\t\t// No-op, browser engine manages expiration LRU or similar.\n\t}\n\n\t// Simple pass-through.\n\tgetCachedPath(origin: string): string {\n\t\treturn origin;\n\t}\n\n\tprotected _onActivatedWorker() {\n\t\tconsole.log(`PREFETCH: _onActivatedWorker`);\n\t\tif(this._activated) {\n\t\t\treturn;\n\t\t}\n\t\tif(typeof this._serviceWorker === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\t\tthis._activated = true;\n\t\tconsole.log(\"PREFETCH: Service worker activated.\");\n\t\tconst channel = new MessageChannel();\n  \t\tthis._serviceWorker.postMessage(channel.port2, [channel.port2]);\n\t\tthis._prefetch = Comlink.wrap<PrefetchWorker>(channel.port1);\n  \t\tchannel.port1.start();\n\t}\n}\n","window.requestIdleCallback =\n    window.requestIdleCallback ||\n    function(cb) {\n        var start = Date.now();\n        return setTimeout(function() {\n            cb({\n                didTimeout: false,\n                timeRemaining: function() {\n                    return Math.max(0, 50 - (Date.now() - start));\n                },\n            });\n        }, 1);\n    };\n\nwindow.cancelIdleCallback =\n    window.cancelIdleCallback ||\n    function(id) {\n        clearTimeout(id);\n    };\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport * as Comlink from 'comlink';\nimport { LitElement, css, html } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\nimport { Renderer } from '../lib/renderer.js';\nimport { NullRenderer } from '../lib/null-renderer.js';\nimport { WebRenderer } from '../lib/web-renderer.js';\nimport { Cluster } from '../lib/cluster.js';\nimport { RaftCluster } from '../lib/raft-cluster.js';\nimport { SchedulerState } from '../lib/scheduler.js';\nimport { Prefetch } from '../lib/prefetch.js';\nimport { HashDecl } from '../lib/media.js';\nimport { ServiceWorkerPrefetch } from '../lib/service-worker-prefetch.js';\n\nimport 'requestidlecallback-polyfill';\n\n@customElement('web-play-list')\nexport class WebPlaylistElement extends LitElement {\n\n\t@property({ type: String, reflect: true })\n\tsrc = \"\";\n\n\t@property({ attribute: 'src-id', type: String, reflect: true })\n\tsrc_id = \"\";\n\n\t@property({ attribute: 'src-size', type: Number, reflect: true })\n\tsrc_size = 0;\n\n\t@property({ attribute: 'src-hash', type: Object, reflect: true })\n\tsrc_hash: HashDecl | undefined = undefined;\n\n\t@property({ attribute: 'src-integrity', type: String, reflect: true })\n\tsrc_integrity = \"\";\n\n\t@property({ attribute: 'src-md5', type: String, reflect: true })\n\tsrc_md5 = \"\";\n\n\t@property({ type: Array, reflect: false })\n\tviews: { left: number, top: number, x: number, y: number, width: number, height: number }[] = [];\n\n\t@property({ type: Number, reflect: false })\n\twidth = 0;\n\n\t@property({ type: Number, reflect: false })\n\theight = 0;\n\n\t@property({ type: Boolean, reflect: true })\n\tautoplay = false;\n\n\t@query('main')\n\t_main!: HTMLElement;  // \"!\" to force TS compatibility.\n\n\t@query('section')\n\t_section!: HTMLElement;  // \"!\" to force TS compatibility.\n\n\tstatic override styles = css`\n\t\t:host {\n\t\t\tdisplay: block;\n\t\t\tcontain: strict;\n\t\t\toverflow: clip;\n\t\t\tfont-size: 0;\n\t\t}\n\t\t:host > section {\n\t\t\tdisplay: none;\n\t\t}\n\t\t:host > main {\n\t\t\tposition: relative;\n\t\t\tmargin-left: 600px;\n\t\t}\n\t\t:host > main > * {\n\t\t\tvisibility: hidden;\n\t\t\tdisplay: block;\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t}\n\t\t:host > main > .map1 {\n\t\t\tvisibility: visible;\n\t\t\twill-change: opacity;\n\t\t\tz-index: 2;\n\t\t}\n\t\t:host > main > .map2 {\n\t\t\tvisibility: visible;\n\t\t\tz-index: 1;\n\t\t}\n\n\t\t:host > main > article {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}\n\t`;\n\n\toverride render() {\n\t\treturn html`\n\t\t\t<style>\n\t\t\t\t:host {\n\t\t\t\t\twidth: ${this.width}px;\n\t\t\t\t\theight: ${this.height}px;\n\t\t\t\t}\n\t\t\t</style>\n\t\t\t<slot></slot><main></main><section></section>\n\t\t`;\n\t}\n\n\tprotected _worker = this._createWorker();\n\tprotected _scheduler = Comlink.wrap(this._worker) as unknown as any;\n\tprotected _renderer: Renderer = new NullRenderer();\n\tprotected _channel = new MessageChannel();\n\tprotected _raf_id: ReturnType<Window[\"requestAnimationFrame\"]> | undefined;\n\tprotected _ric_id: ReturnType<Window[\"requestIdleCallback\"]> | undefined;\n\tprotected _cluster: Cluster | undefined = undefined;\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t// Helpers to access private fields in devtools.\n\tget debugScheduler() { return this._scheduler; }\n\tget debugRenderer() { return this._renderer; }\n\tget debugCluster() { return this._cluster; }\n\n\tprotected _createWorker(): Worker {\n\t\treturn new Worker(new URL('../dist/scheduler.bundle.js', import.meta.url).pathname, {\n\t\t\ttype: 'module',\n\t\t\tcredentials: 'omit',\n\t\t\tname: 'Scheduler',  // Shown in debugger.\n\t\t});\n\t}\n\n\t// https://lit.dev/docs/components/lifecycle/#connectedcallback\n\toverride connectedCallback() {\n\t\tsuper.connectedCallback();\n\t\tconsole.log(\"PLAYLIST: connectedCallback\");\n\t}\n\n\t// https://lit.dev/docs/components/lifecycle/#disconnectedcallback\n\t// Invoked when a component is removed from the document's DOM.\n\t// Closest ECMAScript equivalent to a destructor, however should have\n\t// a matching connectedCallback() if the element is added back to the\n\t// DOM.\n\toverride disconnectedCallback() {\n\t\tsuper.disconnectedCallback();\n\t\tconsole.log(\"PLAYLIST: disconnectedCallback\");\n\t\tif(typeof this._raf_id !== \"undefined\") {\n\t\t\twindow.cancelAnimationFrame(this._raf_id);\n\t\t\tthis._raf_id = undefined;\n\t\t}\n\t\tif(typeof this._ric_id !== \"undefined\") {\n                        window.cancelIdleCallback(this._ric_id);\n                        this._ric_id = undefined;\n                }\n\t\tthis._scheduler[Comlink.releaseProxy]();\n\t\tthis._worker.terminate();\n\t\tthis._renderer.close();\n\t}\n\n\tprotected _createRenderer(\n\t\tprefetchFactory: { new(): Prefetch } = ServiceWorkerPrefetch,\n\t): Renderer {\n\t\tif(this._section === null) {\n\t\t\tthrow new Error(\"cannot find <section> element to attach to.\");\n\t\t}\n\t\tif(this._main === null) {\n\t\t\tthrow new Error(\"cannot find <main> element to attach to.\");\n\t\t}\n\n\t\tconst renderer = new WebRenderer(prefetchFactory);\n\t\trenderer.init();\n\n\t\tthis._connectSchedulerToRenderer(this._scheduler, renderer);\n\t\tthis._connectRaftCluster(this._scheduler, renderer);\n\n\t\trenderer.setAssetTarget(this._main);\n\t\trenderer.setRenderTarget(this._main);\n\n\t\treturn renderer;\n\t}\n\n\t// https://lit.dev/docs/components/lifecycle/#firstupdated\n\t// Called after the component's DOM has been updated the first time,\n\t// immediately before updated() is called.\n\t// Earliest opportunity to read properties and access the render root.\n\toverride firstUpdated(changedProperties: Map<string, any>) {\n\t\tconsole.log(\"PLAYLIST: firstUpdated\");\n\t\tconsole.log(\"PLAYLIST\", changedProperties);\n\t\ttry {\n\t\t\tthis._renderer = this._createRenderer();\n\t\t} catch(e: any) {\n\t\t\tif(typeof e === \"object\") {\n\t\t\t\tfor (const [key, value] of Object.entries(e)) {\n\t\t\t\t\tconsole.error(`PLAYLIST: e: ${key}: ${value}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconsole.error(`PLAYLIST: Failed to create renderer: ${e}`);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\t// https://lit.dev/docs/components/lifecycle/#updated\n\t// Called whenever the component’s update finishes and the element's\n\t// DOM has been updated and rendered.\n\toverride updated(changedProperties: Map<string, any>) {\n\t\tconsole.log(\"PLAYLIST: updated\");\n\t\tconsole.log(changedProperties);\n\t\tif(changedProperties.has('src')) {\n\t\t\tif(this.src.length !== 0\n\t\t\t\t&& this.src_id.length !== 0\n\t\t\t\t&& this.src_size !== 0\n\t\t\t\t&& typeof this.src_hash !== \"undefined\"\n\t\t\t\t&& this.src_integrity.length !== 0\n\t\t\t\t&& this.src_md5.length !== 0)\n\t\t\t{\n\t\t\t\tthis._onSrc(\n\t\t\t\t\tthis.src,\n\t\t\t\t\tthis.src_id,\n\t\t\t\t\tthis.src_size,\n\t\t\t\t\tthis.src_hash,\n\t\t\t\t\tthis.src_integrity,\n\t\t\t\t\tthis.src_md5,\n\t\t\t\t);\n\t\t\t\tif(this.autoplay\n\t\t\t\t\t&& this.width !== 0\n\t\t\t\t\t&& this.height !== 0)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(`PLAYLIST: Auto-playing ${this.src} (${this.src_id})`);\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(changedProperties.has('views')) {\n\t\t\tthis._onViews(this.views);\n\t\t}\n\t\tif(changedProperties.has('width')\n\t\t\t|| changedProperties.has('height'))\n\t\t{\n\t\t\tthis._onSize(this.width, this.height);\n\t\t}\n\t}\n\n\tprotected _onSrc(\n\t\tsrc: string,\n\t\tid: string,\n\t\tsize: number,\n\t\thash: HashDecl,\n\t\tintegrity: string,\n\t\tmd5: string,\n\t): void {\n\t\tconsole.log(`PLAYLIST: onSrc: ${src} (${id})`);\n\t\t(async () => {\n\t\t\tconst url = new URL(this.src, window.location.href);\n\t\t\tawait this._scheduler.setSource(\n\t\t\t\turl.toString(),\n\t\t\t\tid,\n\t\t\t\tsize,\n\t\t\t\thash,\n\t\t\t\tintegrity,\n\t\t\t\tmd5,\n\t\t\t);\n\t\t})();\n\t}\n\n\tprotected _onViews(\n\t\tviews: { left: number, top: number, x: number, y: number, width: number, height: number }[],\n\t): void {\n\t\tconsole.log(`PLAYLIST: onViews: ${JSON.stringify(views)}`);\n\t\tthis._renderer.setViews(views);\n\t}\n\n\tprotected _onSize(\n\t\twidth: number,\n\t\theight: number,\n\t): void {\n\t\tconsole.log(`PLAYLIST: onSize: ${width} ${height}`);\n\t\tthis._renderer.setSize(width, height);\n\t}\n\n\t// Explicitly start playback if autoplay is false.\n\tasync play(): Promise<void> {\n\t\tthis._prepareNextFrame();\n\t\tthis._prepareIdleCallback();\n\t\tawait this._scheduler.play();\n\t}\n\n\t// Connect the scheduler to the renderer.\n\tprotected _connectSchedulerToRenderer(\n\t\tscheduler: any,\n\t\trenderer: Renderer,\n\t): void {\n\t\t(async () => {\n\t\t\tawait scheduler.setStatePort(\n\t\t\t\tComlink.transfer(this._channel.port2, [this._channel.port2])\n\t\t\t);\n\t\t\trenderer.setSchedulerMessagePort(this._channel.port1);\n\t\t})();\n\t}\n\n\t// Connect the scheduler to the cluster.\n\tprotected _connectRaftCluster(\n\t\tscheduler: any,\n\t\trenderer: Renderer,\n\t): void {\n\t\t(async () => {\n\t\t\tconst message_listener = (event: any) => {\n\t\t\t\tif(this._cluster?.leader) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst value = JSON.parse(event.detail);\n\t\t\t\trenderer.setStateUnhooked(value);\n\t\t\t};\n\t\t\tconst set_state = (state: SchedulerState) => {\n\t\t\t\tif(!this._cluster?.leader) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._cluster?.broadcast(JSON.stringify(state));\n\t\t\t\trenderer.setStateUnhooked(state);\n\t\t\t};\n\t\t\tconst join = (decl: any) => {\n\t\t\t\tthis._cluster = new RaftCluster(decl);\n\t\t\t\tthis._cluster.join();\n\t\t\t\tthis._cluster.addEventListener('message', message_listener);\n\t\t\t\trenderer.setSetStateHook(set_state);\n\t\t\t};\n\t\t\tconst leave = () => {\n\t\t\t\tif(this._cluster instanceof RaftCluster) {\n\t\t\t\t\trenderer.clearSetStateHook();\n\t\t\t\t\tthis._cluster.removeEventListener('message', message_listener);\n\t\t\t\t\tthis._cluster.leave();\n\t\t\t\t}\n\t\t\t\tthis._cluster = undefined;\n\t\t\t};\n\t\t\tawait scheduler.exposeNetwork(Comlink.proxy(join), Comlink.proxy(leave));\n\t\t})();\n\t}\n\n\t// REF: https://en.wikipedia.org/wiki/FreeSync\n\t// Render at native frame rate, which may be variable, e.g. NVIDIA\n\t// G-SYNC, or FreeSync.\n\tprotected _renderOneFrame(timestamp: DOMHighResTimeStamp): void {\n\t\tthis._raf_id = undefined;\n\t\tthis._renderer.render(timestamp);\n\t\tthis._prepareNextFrame();\n\t}\n\n\tprotected _prepareNextFrame(): void {\n\t\tif(typeof this._raf_id !== \"undefined\") {\n\t\t\twindow.cancelAnimationFrame(this._raf_id);\n\t\t\tthis._raf_id = undefined;\n\t\t}\n\t\tthis._raf_id = window.requestAnimationFrame((timestamp: DOMHighResTimeStamp) => this._renderOneFrame(timestamp));\n\t}\n\n\t// REF: https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback\n\t// Called during a browser's idle periods, i.e. background or low\n\t// priority work.\n\tprotected _idle(deadline: IdleDeadline): void {\n\t\tthis._ric_id = undefined;\n\t\tif(deadline.timeRemaining() > 0) {\n\t\t\tthis._renderer.idle();\n\n\t\t\t// Step the cluster state engine, if enabled.\n\t\t\tif(this._cluster instanceof RaftCluster) {\n\t\t\t\tconst timestamp = performance.now();\n\t\t\t\tthis._cluster.update(timestamp);\n\t\t\t}\n\t\t}\n\t\tthis._prepareIdleCallback();\n\t}\n\n\t// REF: https://en.wikipedia.org/wiki/Nyquist_frequency\n\t// Maximum interval set to half the Raft heartbeat.\n\tprotected _prepareIdleCallback(): void {\n\t\tif(typeof this._ric_id !== \"undefined\") {\n\t\t\twindow.cancelIdleCallback(this._ric_id);\n\t\t\tthis._ric_id = undefined;\n\t\t}\n\t\tthis._ric_id = window.requestIdleCallback((deadline: IdleDeadline) => this._idle(deadline),\n\t\t\t{ timeout: 250 });\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport { Prefetch } from './prefetch';\nimport { AssetDecl } from './media';\n\nconst fs = require('fs');\nconst AssetPool = require(\"@brightsign/assetpool\");\nconst AssetPoolFiles = require(\"@brightsign/assetpoolfiles\");\nconst AssetFetcher = require(\"@brightsign/assetfetcher\");\n\nconst BRIGHTSIGN_STORAGE_PATH = \"/storage/sd/\";\nconst BRIGHTSIGN_POOL_PATH = `${BRIGHTSIGN_STORAGE_PATH}/p`;\n\ninterface BrightSignAsset {\n\tname: string;\n\tlink: string;\n}\n\nexport class BrightSignPrefetch extends EventTarget implements Prefetch {\n\t#map = new Map<string, string>();\n\t#pool: typeof AssetPool;\n\t#files: typeof AssetPoolFiles | undefined;\n\t#is_configured = false;\n\n\tconstructor() {\n\t\tsuper();\n\t\ttry {\n\t\t\tfs.mkdirSync(BRIGHTSIGN_POOL_PATH);\n\t\t\tconsole.log(`PREFETCH: Created BrightSign AssetPool(${BRIGHTSIGN_POOL_PATH})`);\n\t\t} catch(e: any) {\n\t\t\t// Error: EEXIST: file already exists, mkdir '/storage/sd//p'\n\t\t\t// {\"errno\":-17,\"syscall\":\"mkdir\",\"code\":\"EEXIST\",\"path\":\"/storage/sd//p\"}\n\t\t\tif(e.code !== 'EEXIST') {\n\t\t\t\tconsole.warn(e);\n\t\t\t\tconsole.warn(JSON.stringify(e));\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\tconsole.log(`PREFETCH: Using BrightSign AssetPool(${BRIGHTSIGN_POOL_PATH})`);\n\t\t}\n\t\tthis.#pool = new AssetPool(BRIGHTSIGN_POOL_PATH);\n\t}\n\n\t// Use space as available reserving 128MB free.\n\tasync #configurePool() {\n\t\tawait this.#pool.reserveStorage(128 * 1024 * 1024);\n\t\tthis.#is_configured = true;\n\t}\n\n\tasync #fetchAssets(pool: typeof AssetPool, assets: any[]) {\n//\t\tconsole.log(`PREFETCH: #fetchAssets: ${JSON.stringify(assets.map(asset => asset.name))}`);\n\t\tconsole.log(`PREFETCH: #fetchAssets ...`);\n                const fetcher = new AssetFetcher(pool);\n                fetcher.addEventListener(\"fileevent\", (event: any) => {\n                        // This is called each time the fetcher has finished trying to\n                        // download an asset, whether successful or not. It is not\n                        // called for any assets that are already in the pool.\n                        console.log(`PREFETCH: ${event.fileName}: complete: ${event.responseCode.toString()} ${event.error}`);\n                });\n                function progressString(event: any) {\n                        if(typeof event.currentFileTotal === \"undefined\") {\n                                // If the size of the asset was not specified in the asset collection, then the total size may not be reported\n                                // during the fetch.\n                                return `${event.currentFileTransferred.toString()} of unknown`;\n                        } else {\n\t\t\t\tconst percent = (100 * event.currentFileTransferred / event.currentFileTotal).toFixed(0);\n                                return `${event.currentFileTransferred.toString()} of ${event.currentFileTotal.toString()} ${percent}%`;\n                        }\n                }\n                fetcher.addEventListener(\"progressevent\", (event: any) => {\n                        // This is called at approximately the progress interval\n                        // specified in the options to indicate how far through the\n                        // download\n                        console.log(`PREFETCH: ${event.fileName}: progress: ${progressString(event)}`);\n                });\n                const fetchOptions = {\n                        // receive asset progress events about every five seconds.\n                        progressInterval: 5,\n                        // try to download each asset three times before giving up.\n                        fileRetryCount: 3,\n                        // Give up if we fail to download at least 1024 bytes in each\n                        // ten second period.\n                        minimumTransferRate: { bytesPerSecond: 1024, periodInSeconds: 10 },\n                };\n                try {\n                        await fetcher.start(assets, fetchOptions);\n                } catch(e: any) {\n                        console.log(`PREFETCH: Fetcher failed: ${e.message}`);\n                        throw(e);\n                }\n\t\tconsole.log(`PREFETCH: #fetchAssets done.`);\n\t}\n\n\t// Protect API to limit space reclamation without time priority.\n\tasync acquireSources(scope: string, sources: AssetDecl[]) {\n\t\tconsole.log(`PREFETCH: acquireSources ${scope} ${JSON.stringify(sources)}`);\n\t\tif(!this.#is_configured) {\n\t\t\tawait this.#configurePool();\n\t\t}\n\t\tconst assets = sources.map(source => {\n\t\t\treturn {\n\t\t\t\tname: source.id,\n\t\t\t\tsize: source.size,\n\t\t\t\thash: source.hash,\n\t\t\t\tlink: source.href,\n\t\t\t\tchange_hint: source.integrity,\n\t\t\t} as BrightSignAsset;\n\t\t});\n\t\tconsole.log(`PREFETCH: Protecting assets ...`);\n\t\tawait this.#pool.protectAssets(scope, assets);\n\t\tconsole.log(`PREFETCH: Protecting assets done.`);\n\t\tawait this.#fetchAssets(this.#pool, assets);\n\t\tif(!await this.#pool.areAssetsReady(assets)) {\n                        throw new Error(\"Assets not ready\");\n                }\n                this.#files = new AssetPoolFiles(this.#pool, assets);\n\t\tfor(const asset of assets) {\n\t\t\tconst local = await this.#getPath(asset.name);\n\t\t\tthis.#map.set(asset.link, local);\n\t\t\tconsole.info(`${local} -> ${asset.link}`);\n\t\t}\n\t\tconsole.log(`PREFETCH: acquireSources done.`);\n\t}\n\n\tasync releaseSources(scope: string) {\n\t\tawait this.#pool.unprotectAssets(scope);\n\t}\n\n\t// Translate origin URLs to local assets on persistent storage.\n\tasync #getPath(origin: string): Promise<string> {\n\t\tconst file_path = await this.#files.getPath(origin);\n\t\treturn file_path.replace(BRIGHTSIGN_STORAGE_PATH, \"file:///sd:/\");\n\t}\n\n\tgetCachedPath(origin: string): string {\n\t\treturn this.#map.get(origin) || \"\";\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport { customElement } from 'lit/decorators.js';\nimport { Renderer } from '../lib/renderer.js';\nimport { WebPlaylistElement } from './web-play-list.js';\nimport { BrightSignPrefetch } from '../lib/brightsign-prefetch.js';\n\n@customElement('brightsign-play-list')\nexport class BrightSignPlaylistElement extends WebPlaylistElement {\n\n\t// Override the renderer to use BrightSign compatible asset prefetcher.\n\tprotected override _createRenderer(): Renderer {\n\t\treturn super._createRenderer(BrightSignPrefetch);\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nconst shader = (strings: TemplateStringsArray, ...values: string[]) => {\n        const shaderText = values.reduce((acc, v, idx) => acc + v + strings[idx + 1], strings[0]);\n        return shaderText?.replace(/^\\s+#/, '#');\n};\n\nexport default shader;\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport * as THREE from 'three';\nimport { AppBaseParams, AppManifestSchema, AppParams, WebGLApp, WebGLAppConstructor } from '@dsbunny/app';\nimport { MediaDecl } from './media.js';\n\nexport abstract class AbstractThreeAsset extends EventTarget {\n\ttexture: THREE.Texture | null = null;\n\n\tprotected _src: string;\n\tprotected _params: AppBaseParams;\n\t// Per `HTMLMediaElement`.\n\tprotected _duration: number;\n\tprotected _ended = false;\n\tprotected _error: any = null;\n\tprotected _networkState: number = HTMLMediaElement.NETWORK_NO_SOURCE;\n\tprotected _paused = true;\n\tprotected _readyState: number = HTMLMediaElement.HAVE_NOTHING;\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: any,\n\t\tduration: number,\n\t\tpublic readonly collection: ThreeCollection,\n\t) {\n\t\tsuper();\n\t\tconst url = new URL(src, self.location.href);\n\t\tthis._src = url.href;\n\t\tif(this._src.length !== 0) {\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_EMPTY;\n\t\t}\n\t\tthis._params = params;\n\t\tthis._duration = duration;\n\t}\n\n\tabstract close(): void;\n\tabstract paint(now: DOMHighResTimeStamp, remaining: number) : void;\n\n\tget params() { return this._params; }\n\t// Per `HTMLMediaElement`.\n\tget currentSrc() { return this._src; }\n\tget currentTime() { return 0; }\n\tget duration() { return this._duration; }\n\tget ended() { return this._ended; }\n\tget error() { return this._error; }\n\tget networkState() { return this._networkState; }\n\tget paused() { return this._paused; }\n\tget readyState() { return this._readyState; }\n\tget src() { return this._src; }\n\tget srcObject(): MediaProvider | null { return null; }\n\tabstract load(): void;\n\tabstract pause(): void;\n\tabstract play(): Promise<void>;\n\t// Per `HTMLVideoElement`.\n\tget height() { return 0; }\n\tget width() { return 0; }\n}\n\n// super must be used to call functions only, operation is undefined when\n// accessing variables that are not hidden behind getters and setters.\nexport class ThreeImageAsset extends AbstractThreeAsset {\n\tprotected _startTime: DOMHighResTimeStamp | number = NaN;\n\tprotected _lastTimeUpdate: DOMHighResTimeStamp = 0;\n\tprotected _currentTime: DOMHighResTimeStamp = 0;\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t\tcollection: ThreeImageCollection,\n\t) {\n\t\tsuper(src, params, duration, collection);\n\t}\n\n\tget image(): HTMLImageElement | null {\n\t\treturn this.texture?.image as HTMLImageElement || null;\n\t}\n\n\toverride close(): void {\n\t\tif(this.texture === null || this.image === null) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(`unload image ... \"${this.src}\"`);\n\t\tthis.pause();\n\t\tconst collection = this.collection as ThreeImageCollection;\n\t\tcollection.release(this.image);\n\t\tthis.texture.dispose();\n\t\tthis.texture = null;\n\t\tthis._readyState = HTMLMediaElement.HAVE_NOTHING;\n\t\tthis._networkState = HTMLMediaElement.NETWORK_EMPTY;\n\t\tthis._currentTime = 0;\n\t\tthis._startTime = NaN;\n\t\tthis._lastTimeUpdate = 0;\n\t\tthis._ended = false;\n\t\tthis._error = null;\n\t}\n\n\t// FIXME: delta for paused.\n\toverride paint(now: DOMHighResTimeStamp, _remaining: number): void {\n\t\tif(this.paused || this.ended) return;\n\t\tconst elapsed = (now - this._startTime) / 1000;\n\t\tthis._currentTime += elapsed;\n\t\tif(this._currentTime > this._duration) {\n\t\t\tthis._setEndedState();\n\t\t} else {\n\t\t\tif(Math.floor(this._currentTime) > this._lastTimeUpdate) {\n\t\t\t\tthis._lastTimeUpdate = this._currentTime;\n\t\t\t\tthis.dispatchEvent(new Event('timeupdate'));\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _setEndedState(): void {\n\t\tthis._currentTime = this._duration;\n\t\tthis._ended = true;\n\t\tthis._startTime = NaN;\n\t\tthis.dispatchEvent(new Event('ended'));\n\t}\n\n\toverride get params() { return super.params; }\n\t// Per HTMLMediaElement.\n\toverride get currentSrc() { return super.currentSrc; }\n\toverride get currentTime() { return this._currentTime; }\n\toverride get duration() { return super.duration; }\n\toverride get ended() { return super.ended; }\n\toverride get error() { return super.error; }\n\toverride get networkState() { return super.networkState; }\n\toverride get paused() { return super.paused; }\n\toverride get readyState() { return super.readyState; }\n\toverride get src() { return super.src; }\n\toverride get srcObject() { return null; }\n\n\toverride load(): void {\n\t\t(async () => {\n\t\t\tconst collection = this.collection as ThreeImageCollection;\n\t\t\tconst img = collection.acquire();\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_LOADING;\n\t\t\ttry {\n\t\t\t\tconsole.log(`load image ... \"${this.src}\"`);\n\t\t\t\timg.crossOrigin = 'anonymous';\n\t\t\t\timg.setAttribute('src', this.src);\n\t\t\t\tawait img.decode();\n\t\t\t\tthis.texture = new THREE.Texture(img);\n\t\t\t\tthis.texture.needsUpdate = true;\n\t\t\t\tthis._readyState = HTMLMediaElement.HAVE_ENOUGH_DATA\n\t\t\t\tsuper.dispatchEvent(new Event('canplay'));\n\t\t\t} catch(encodingError: unknown) {\n\t\t\t\tconsole.warn(`Failed to load image: \"${this.src}\" Error: ${encodingError}`);\n\t\t\t\tthis._error = encodingError;\n\t\t\t\tthis._networkState = HTMLMediaElement.NETWORK_IDLE;\n\t\t\t\tcollection.release(img);\n\t\t\t\tsuper.dispatchEvent(new Event('error'));\n\t\t\t}\n\t\t})();\n\t}\n\n\toverride pause(): void {\n\t\tif(this._paused) return;\n\t\tthis._paused = true;\n\t}\n\n\toverride async play(): Promise<void> {\n\t\tthis._paused = false;\n\t\tif(this._ended) {\n\t\t\tthis._ended = false;\n\t\t\tthis._currentTime = 0;\n\t\t}\n\t\tif(isNaN(this._startTime)) {\n\t\t\tthis._startTime = performance.now() - this._currentTime;\n\t\t}\n\t}\n\n\t// Per `HTMLVideoElement`.\n\toverride get height() {\n\t\tif(this.image === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.image.height;\n\t}\n\toverride get width() {\n\t\tif(this.image === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.image.width;\n\t}\n}\n\nexport class ThreeVideoAsset extends AbstractThreeAsset {\n\tprotected _redispatchEvent = (event: string | Event) => {\n\t\tsuper.dispatchEvent(new Event(event instanceof Event ? event.type : event));\n\t};\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t\tcollection: ThreeVideoCollection,\n\t) {\n\t\tsuper(src, params, duration, collection);\n\t}\n\n\tget video(): HTMLVideoElement | null {\n\t\treturn this.texture?.image as HTMLVideoElement || null;\n\t}\n\n\toverride close(): void {\n\t\tif(this.texture === null || this.video === null) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(`unload video ... \"${this.src}\"`);\n\t\tthis.pause();\n\t\tconst collection = this.collection as ThreeVideoCollection;\n\t\tconst video = this.video!;\n\t\tvideo.oncanplay = null;\n\t\tvideo.onended = null;\n\t\tvideo.onerror = null;\n\t\tvideo.onloadeddata = null;\n\t\tvideo.removeAttribute('src');\n\t\tcollection.release(video);\n\t\tthis.texture.dispose();\n\t\tthis.texture = null;\n\t}\n\n\toverride paint(_now: DOMHighResTimeStamp, _remaining: number): void {}\n\n\toverride get params() { return super.params; }\n\t// Per `HTMLMediaElement`.\n\toverride get currentSrc() {\n\t\tif(this.video === null) {\n\t\t\treturn super.currentSrc;\n\t\t}\n\t\treturn this.video.currentSrc;\n\t}\n\toverride get currentTime() {\n\t\tif(this.video === null) {\n\t\t\treturn super.currentTime;\n\t\t}\n\t\treturn this.video.currentTime;\n\t}\n\toverride get duration() {\n\t\tif(this.video === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.video.duration;\n\t}\n\toverride get ended() {\n\t\tif(this.video === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.video.ended;\n\t}\n\toverride get error() {\n\t\tif(this.video === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.video.error;\n\t}\n\toverride get networkState() {\n\t\tif(this.video === null) {\n\t\t\treturn HTMLMediaElement.NETWORK_EMPTY;\n\t\t}\n\t\treturn this.video.networkState;\n\t}\n\toverride get paused() {\n\t\tif(this.video === null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.video.paused;\n\t}\n\toverride get readyState() {\n\t\tif(this.video === null) {\n\t\t\treturn HTMLMediaElement.HAVE_NOTHING;\n\t\t}\n\t\treturn this.video.readyState;\n\t}\n\toverride get src() { return super.src; }\n\toverride get srcObject() {\n\t\tif(this.video === null) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.video.srcObject;\n\t}\n\n\toverride load(): void {\n\t\tconst collection = this.collection as ThreeVideoCollection;\n\t\tconst video = collection.acquire();\n\t\tvideo.oncanplay = this._redispatchEvent;\n\t\tvideo.onended = this._redispatchEvent;\n\t\tvideo.onerror = this._redispatchEvent;\n\t\t// Avoid \"WebGL: INVALID_VALUE: texImage2D: no video\".\n\t\tvideo.onloadeddata = (event: Event) => {\n\t\t\tconsole.log(`create video texture ... \"${this.src}\"`);\n\t\t\tthis.texture = new THREE.VideoTexture(video);\n\t\t\tthis.texture.needsUpdate = true;\n\t\t\tthis._redispatchEvent(event);\n\t\t};\n\t\ttry {\n\t\t\tconsole.log(`load video ... \"${this.src}\"`);\n\t\t\tvideo.crossOrigin = 'anonymous';\n\t\t\tvideo.setAttribute('src', this.src);\n\t\t\tvideo.load();\n\t\t} catch(encodingError: unknown) {\n\t\t\tcollection.release(video);\n\t\t\tthrow encodingError;\n\t\t}\n\t}\n\n\toverride pause(): void {\n\t\tif(this.video === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.video.pause();\n\t}\n\n\toverride async play(): Promise<void> {\n\t\tif(this.video === null) {\n\t\t\treturn;\n\t\t}\n\t\tawait this.video.play();\n\t}\n\n\t// Per `HTMLVideoElement`.\n\toverride get height() {\n\t\tif(this.video === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.video.height;\n\t}\n\toverride get width() {\n\t\tif(this.video === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this.video.width;\n\t}\n}\n\nexport class ThreeAppAsset extends AbstractThreeAsset {\n\tprotected _app: WebGLApp | null = null;\n\tprotected _fbo: THREE.WebGLRenderTarget | null = null;\n\tprotected _redispatchEvent = (event: string | Event) => {\n\t\tsuper.dispatchEvent(new Event(event instanceof Event ? event.type : event));\n\t};\n\n\tconstructor(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t\tcollection: ThreeAppCollection,\n\t) {\n\t\tsuper(src, params, duration, collection);\n\t}\n\n\toverride close(): void {\n\t\tif(this.texture === null) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(`unload app ... \"${this.src}\"`);\n\t\tthis.pause();\n\t\tconst collection = this.collection as ThreeAppCollection;\n\t\tif(this._app !== null) {\n\t\t\tthis._app.close();\n\t\t\tthis._app.removeEventListener('canplay', this._redispatchEvent);\n\t\t\tthis._app.removeEventListener('ended', this._redispatchEvent);\n\t\t\tthis._app.removeEventListener('error', this._redispatchEvent);\n\t\t\tthis._app = null;\n\t\t}\n\t\tif(this._fbo !== null) {\n\t\t\tcollection.release(this._fbo);\n\t\t\tthis._fbo = null;\n\t\t}\n\t\tthis.texture.dispose();\n\t\tthis.texture = null;\n\t}\n\n\toverride paint(now: DOMHighResTimeStamp, remaining: number): void {\n\t\tif(this.paused || this.ended) return;\n\t\tif(this._app === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis._app.animate(now, remaining);\n\t}\n\n\toverride get params() { return super.params; }\n\t// Per `HTMLMediaElement`.\n\toverride get currentSrc() {\n\t\tif(this._app === null) {\n\t\t\treturn super.currentSrc;\n\t\t}\n\t\treturn this._app.currentSrc;\n\t}\n\toverride get currentTime() {\n\t\tif(this._app === null) {\n\t\t\treturn super.currentTime;\n\t\t}\n\t\treturn this._app.currentTime;\n\t}\n\toverride get duration() {\n\t\tif(this._app === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this._app.duration;\n\t}\n\toverride get ended() {\n\t\tif(this._app === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._app.ended;\n\t}\n\toverride get error() {\n\t\tif(this._app === null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._app.error;\n\t}\n\toverride get networkState() {\n\t\tif(this._app === null) {\n\t\t\treturn HTMLMediaElement.NETWORK_EMPTY;\n\t\t}\n\t\treturn this._app.networkState;\n\t}\n\toverride get paused() {\n\t\tif(this._app === null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this._app.paused;\n\t}\n\toverride get readyState() {\n\t\tif(this._app === null) {\n\t\t\treturn HTMLMediaElement.HAVE_NOTHING;\n\t\t}\n\t\treturn this._app.readyState;\n\t}\n\toverride get src() { return super.src; }\n\toverride get srcObject() { return super.srcObject; }\n\n\toverride load(): void {\n\t\t(async () => {\n\t\t\tconst collection = this.collection as ThreeAppCollection;\n\t\t\tconst fbo = this._fbo = collection.acquire();\n\t\t\ttry {\n\t\t\t\tconsole.log(`import module ... \"${this.src}\"`);\n\t\t\t\tconst manifest = await collection.importModule(this.src);\n\t\t\t\tconsole.log(`create WebGLApp ... \"${this.src}\"`);\n\t\t\t\tconst params = {\n\t\t\t\t\t...this.params,\n\t\t\t\t\tsrc: this.src,\n\t\t\t\t\tduration: super.duration,  // WARNING: `super` not `this`.\n\t\t\t\t}\n\t\t\t\tconst app = this._app = manifest.WebGLApp!.create(\n\t\t\t\t\tfbo,\n\t\t\t\t\tcollection.renderer,\n\t\t\t\t\tparams,\n\t\t\t\t);\n\t\t\t\tapp.addEventListener('canplay', this._redispatchEvent);\n\t\t\t\tapp.addEventListener('ended', this._redispatchEvent);\n\t\t\t\tapp.addEventListener('error', this._redispatchEvent);\n\t\t\t\tthis.texture = fbo.texture;\n\t\t\t\tconsole.log(`init \"${manifest.name}\" with params:`, params);\n\t\t\t\tapp.load();\n\t\t\t} catch(initError: unknown) {\n\t\t\t\tconsole.warn(`Failed to load app: \"${this.src}\"`, initError);\n\t\t\t\tcollection.release(fbo);\n\t\t\t\tsuper.dispatchEvent(new Event('error'));\n\t\t\t}\n\t\t})();\n\t}\n\n\toverride pause(): void {\n\t\tif(this._app === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis._app.pause();\n\t}\n\n\toverride async play(): Promise<void> {\n\t\tif(this._app === null) {\n\t\t\treturn;\n\t\t}\n\t\tawait this._app.play();\n\t}\n\n\t// Per `HTMLVideoElement`.\n\toverride get height() {\n\t\tif(this._app === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this._app.height;\n\t}\n\toverride get width() {\n\t\tif(this._app === null) {\n\t\t\treturn NaN;\n\t\t}\n\t\treturn this._app.width;\n\t}\n}\n\nabstract class ThreeCollection {\n\tconstructor(readonly renderRoot: (HTMLElement | ShadowRoot)) {}\n\tabstract acquire(): HTMLImageElement | HTMLVideoElement | THREE.WebGLRenderTarget;\n\tabstract createThreeAsset(src: string, params: AppBaseParams, duration: number): ThreeImageAsset | ThreeVideoAsset | ThreeAppAsset;\n\tabstract release(asset: HTMLImageElement | HTMLVideoElement | THREE.WebGLRenderTarget): void;\n\tabstract clear(): void;\n}\n\nclass ThreeImageCollection extends ThreeCollection {\n\tprotected _images: HTMLImageElement[] = [];\n\n\tconstructor(renderRoot: (HTMLElement | ShadowRoot)) {\n\t\tsuper(renderRoot);\n\t}\n\n\t// TSC forces pop() to return undefined even if length is checked.\n\toverride acquire(): HTMLImageElement {\n\t\tlet img = this._images.pop();\n\t\tif(typeof img === \"undefined\") {\n\t\t\timg = new Image();\n\t\t}\n\t\treturn img;\n\t}\n\n\toverride createThreeAsset(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t): ThreeImageAsset {\n\t\treturn new ThreeImageAsset(src, params, duration, this);\n\t}\n\n\toverride release(img: HTMLImageElement): void {\n\t\timg.removeAttribute('src');\n\t\tthis._images.push(img);\n\t}\n\n\toverride clear(): void {\n\t\tthis._images = [];\n\t}\n}\n\nclass ThreeVideoCollection extends ThreeCollection {\n\tprotected _videos: HTMLVideoElement[] = [];\n\n\tconstructor(renderRoot: (HTMLElement | ShadowRoot)) {\n\t\tsuper(renderRoot);\n\t}\n\n\toverride acquire(): HTMLVideoElement {\n\t\tlet video = this._videos.pop();\n\t\tif(typeof video === \"undefined\") {\n\t\t\tvideo = document.createElement('video');\n\t\t\tvideo.autoplay = false;\n\t\t\tvideo.crossOrigin = 'anonymous';\n\t\t\tvideo.muted = true;\n\t\t\tvideo.playsInline = true;\n\t\t\tvideo.preload = 'auto';  // The video will be played soon.\n\t\t\t// Video must be within DOM to playback.\n\t\t\tthis.renderRoot.appendChild(video);\n\t\t}\n\t\treturn video;\n\t}\n\n\toverride createThreeAsset(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\t_duration: number,\n\t): ThreeVideoAsset {\n\t\treturn new ThreeVideoAsset(src, params, NaN, this);\n\t}\n\n\toverride release(video: HTMLVideoElement): void {\n\t\tif(!video.paused) {\n\t\t\tvideo.pause();\n\t\t}\n\t\tvideo.removeAttribute('src');\n\t\tthis._videos.push(video);\n\t}\n\n\toverride clear(): void {\n\t\tfor(const video of this._videos) {\n\t\t\tthis.renderRoot.removeChild(video);\n\t\t}\n\t\tthis._videos = [];\n\t}\n}\n\nclass ThreeAppCollection extends ThreeCollection {\n\tprotected _manifests = new Map<string, AppManifestSchema>();\n\tprotected _fbos: THREE.WebGLRenderTarget[] = [];\n\n\tconstructor(\n\t\trenderRoot: (HTMLElement | ShadowRoot),\n\t\tpublic readonly renderer: THREE.WebGLRenderer,\n\t) {\n\t\tsuper(renderRoot);\n\t}\n\n\toverride acquire(): THREE.WebGLRenderTarget {\n\t\tlet fbo = this._fbos.pop();\n\t\tif(typeof fbo === \"undefined\") {\n\t\t\tconst width = 1024;  // * this.renderer.getPixelRatio();\n\t\t\tconst height = 1024;  // * this.renderer.getPixelRatio();\n\t\t\tfbo = new THREE.WebGLRenderTarget(width, height, {\n\t\t\t\tminFilter: THREE.NearestFilter,\n\t\t\t\tmagFilter: THREE.NearestFilter,\n\t\t\t\tdepthBuffer: false,\n\t\t\t\tstencilBuffer: false,\n\t\t\t});\n\t\t}\n\t\treturn fbo;\n\t}\n\n\tasync importModule(src: string): Promise<AppManifestSchema> {\n\t\tlet manifest = this._manifests.get(src);\n\t\tif(typeof manifest === 'undefined') {\n\t\t\tconsole.log(`import app manifest ... \"${src}\"`);\n\t\t\tconst module = await import(src);\n\t\t\tconsole.log(`validate app manifest ... \"${src}\"`);\n\t\t\tconst result = AppManifestSchema.safeParse(module.default);\n\t\t\tconsole.log(`app manifest validation result: ${result.success} ... \"${src}\"`);\n\t\t\tif(!result.success) {\n\t\t\t\tthrow new Error(`Invalid app manifest: \"${src}\"`);\n\t\t\t}\n\t\t\tif(!result.data.WebGLApp) {\n\t\t\t\tthrow new Error(`WebGLApp constructor not found in manifest: \"${src}\"`);\n\t\t\t}\n\t\t\tmanifest = result.data;\n\t\t\tthis._manifests.set(src, manifest);\n\t\t}\n\t\treturn manifest;\n\t}\n\n\toverride createThreeAsset(\n\t\tsrc: string,\n\t\tparams: AppBaseParams,\n\t\tduration: number,\n\t): ThreeAppAsset {\n\t\treturn new ThreeAppAsset(src, params, duration, this);\n\t}\n\n\toverride release(fbo: THREE.WebGLRenderTarget): void {\n\t\tthis._fbos.push(fbo);\n\t}\n\n\toverride clear(): void {\n\t\tfor(const fbo of this._fbos) {\n\t\t\tfbo.dispose();\n\t\t}\n\t\tthis._fbos = [];\n\t\tthis._manifests.clear();\n\t}\n}\n\nexport class ThreeAssetManager {\n\tprotected _renderTarget: HTMLElement | undefined;\n\tprotected _renderer: THREE.WebGLRenderer | undefined;\n\tprotected _collection: Map<string, ThreeCollection> = new Map();\n\n\tsetAssetTarget(renderTarget: HTMLElement): void {\n\t\tthis._renderTarget = renderTarget;\n\t}\n\n\tsetRenderer(renderer: THREE.WebGLRenderer): void {\n\t\tthis._renderer = renderer;\n\t}\n\n\tprotected _createCollection(\n\t\trenderTarget: HTMLElement,\n\t\trenderer: THREE.WebGLRenderer,\n\t): Map<string, ThreeCollection> {\n\t\t// TypeScript assumes iterator of first type.\n\t\tconst collection = new Map([\n\t\t\t['HTMLImageElement', new ThreeImageCollection(renderTarget) as ThreeCollection],\n\t\t\t['HTMLVideoElement', new ThreeVideoCollection(renderTarget) as ThreeCollection],\n\t\t\t['CustomElement', new ThreeAppCollection(renderTarget, renderer) as ThreeCollection],\n\t\t]);\n\t\treturn collection;\n\t}\n\n\t// decl: { type, href }\n\t// Returns: asset.\n\tcreateThreeAsset(decl: MediaDecl): AbstractThreeAsset {\n\t\tconsole.log(`createThreeAsset: ${decl['@type']} ${decl.href} (${decl.duration}s)`);\n\t\tif(this._collection.size === 0) {\n\t\t\tif(typeof this._renderTarget === \"undefined\") {\n\t\t\t\tthrow new Error(\"undefined render target.\");\n\t\t\t}\n\t\t\tif(typeof this._renderer === \"undefined\") {\n\t\t\t\tthrow new Error(\"undefined renderer.\");\n\t\t\t}\n\t\t\tthis._collection = this._createCollection(this._renderTarget, this._renderer);\n\t\t}\n\t\tconst collection = this._collection.get(decl['@type']);\n\t\tif(typeof collection === \"undefined\") {\n\t\t\tthrow new Error('Undefined collection.');\n\t\t}\n\t\treturn collection.createThreeAsset(\n\t\t\tdecl.href,\n\t\t\tdecl.params,\n\t\t\tdecl.duration,\n\t\t);\n\t}\n\n\tclear(): void {\n\t\tfor(const value of this._collection.values()) {\n\t\t\tvalue.clear();\n\t\t}\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n\nimport { AbstractThreeAsset } from '../lib/three-media.js';\n\nexport class WebGLRendererAsset {\n\tis_loading = false;\n\thas_texture = false;\n\tend_time = NaN;\n\tprotected _ref_count = 0;\n\n\tconstructor(\n\t\treadonly id: string,\n\t\tpublic webgl_asset: AbstractThreeAsset,\n\t) {}\n\n\tget paused() { return this.webgl_asset.paused; }\n\tget ended() { return this.webgl_asset.ended; }\n\tget error() { return this.webgl_asset.error; }\n\tget readyState() { return this.webgl_asset.readyState; }\n\tget networkState() { return this.webgl_asset.networkState; }\n\tget texture() { return this.webgl_asset.texture; }\n\tget currentSrc() { return this.webgl_asset.currentSrc; }\n\tget currentTime() { return this.webgl_asset.currentTime; }\n\n\tload(): void {\n\t\tif(this.readyState !== HTMLMediaElement.HAVE_NOTHING) {\n\t\t\treturn;\n\t\t}\n\t\tif(this.networkState !== HTMLMediaElement.NETWORK_EMPTY) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tthis.webgl_asset.load();\n\t\t} catch(error: any) {\n\t\t\tconsole.error(`WEGBL-ASSET: ${error}`);\n\t\t}\n\t}\n\n\tasync play() {\n\t\tawait this.webgl_asset.play();\n\t}\n\n\tpaint(now: number, remaining: number) {\n\t\tthis.webgl_asset.paint(now, remaining);\n\t}\n\n\tpause() {\n\t\tthis.webgl_asset.pause();\n\t}\n\n\tclose(): void {\n\t\tthis.webgl_asset.close();\n\t}\n\n\tget ref_count() { return this._ref_count; }\n\n\tref() {\n\t\tthis._ref_count++;\n\t}\n\n\tunref() {\n\t\tthis._ref_count--;\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport * as Comlink from 'comlink';\nimport * as THREE from 'three';\nimport shader from '../lib/shader.js';\nimport { View, Renderer } from '../lib/renderer.js';\nimport {\n\tSchedulerState,\n\tSchedulerAssetDeclWithRemainingTime,\n\tSchedulerAssetTransition,\n} from '../lib/scheduler.js';\nimport { AssetDecl, MediaDecl } from './media.js';\nimport { ThreeAppAsset, ThreeAssetManager } from './three-media.js';\nimport { Prefetch } from './prefetch.js';\nimport { ServiceWorkerPrefetch } from './service-worker-prefetch.js';\nimport { WebGLRendererAsset } from './webgl-renderer-asset.js';\n\nconst DEBUG_SHOW_DETAIL = true;\n\n// REF: http://jsfiddle.net/unLSJ/\nfunction replacer(_match: any, pIndent: any, pKey: any, pVal: any, pEnd: any): any {\n\tconst key = '<span class=json-key>';\n\tconst val = '<span class=json-value>';\n\tconst str = '<span class=json-string>';\n\tlet r = pIndent || '';\n\tif(pKey) {\n\t   \tr = r + key + pKey.replace(/[\": ]/g, '') + '</span>: ';\n\t}\n\tif(pVal) {\n\t \tr = r + (pVal[0] == '\"' ? str : val) + pVal + '</span>';\n\t}\n\treturn r + (pEnd || '');\n}\n\nfunction prettyPrint(obj: any): string {\n\tconst jsonLine = /^( *)(\"[\\w]+\": )?(\"[^\"]*\"|[\\w.+-]*)?([,[{])?$/mg;\n\treturn JSON.stringify(obj, null, 3)\n\t   \t.replace(/&/g, '&amp;').replace(/\\\\\"/g, '&quot;')\n\t   \t.replace(/</g, '&lt;').replace(/>/g, '&gt;')\n\t   \t.replace(jsonLine, replacer);\n}\n\nfunction minimize(value: SchedulerState): any {\n\tconst obj = {\n\t\tcurrentTime: value.currentTime,\n\t\teventSeries: value.eventSeries,\n\t\tmediaList: value.mediaList,\n\t\tmediaCurrent: value.mediaCurrent && {\n\t\t\thref: value.mediaCurrent.decl.href,\n\t\t\tduration: value.mediaCurrent.decl.duration,\n\t\t\tremainingTimeMs: value.mediaCurrent.remainingTimeMs,\n\t\t},\n\t\tmediaNext: value.mediaNext && {\n\t\t\thref: value.mediaNext.decl.href,\n\t\t\tduration: value.mediaNext.decl.duration,\n\t\t\tremainingTimeMs: value.mediaNext.remainingTimeMs,\n\t\t},\n\t\ttransition: value.transition && {\n\t\t\tpercent: value.transition.percent,\n\t\t},\n\t};\n\treturn obj;\n}\n\nexport class WebGLRenderer extends EventTarget implements Renderer {\n\tstatic vertexShader = shader`\n\t\tprecision mediump float;\n\t\tin vec2 uv;\n\t\tin vec4 position;\n\t\tuniform mat4 projectionMatrix;\n\t\tuniform mat4 modelViewMatrix;\n\t\tout vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * position;\n\t\t}\n\t`;\n\n\tstatic fragmentShader = shader`\n\t\tprecision mediump float;\n\t\tuniform sampler2D map1;\n\t\tuniform sampler2D map2;\n\t\tuniform sampler2D displacement;\n\t\tuniform float pct;\n\t\tin vec2 vUv;\n\t\tout vec4 OutputColor;\n\n\t\t#define PI radians(180.0)\n\n\t\tvoid main() {\n\t\t\tvec4 displacementColor = texture(displacement, vUv);\n\t\t\tfloat effectFactor = 1.0;\n\t\t\tvec2 uv1 = vec2(vUv.x + pct * (displacementColor.r * effectFactor), vUv.y);\n\t\t\tvec2 uv2 = vec2(vUv.x - (1.0 - pct) * (displacementColor.r * effectFactor), vUv.y);\n\t\t\tOutputColor = mix(texture(map1, uv1), texture(map2, uv2), pct);\n\t\t}\n\t`;\n\n\tprotected _asset_manager = new ThreeAssetManager();\n\tprotected _renderer: THREE.WebGLRenderer | undefined;\n\tprotected _camera: THREE.OrthographicCamera | undefined;\n\tprotected _scene = new THREE.Scene();\n\tprotected _views: View[] = [];\n\tprotected _displacement_url = \"\";\n\tprotected _transition_percent = 0;\n\tprotected _transition_percent_speed = 0;\n\tprotected _displacement_texture = new THREE.Texture();\n\tprotected _empty_texture = new THREE.Texture();\n\tprotected _network_loading_count = 0;\n\tprotected _current_renderer_asset: WebGLRendererAsset | null = null;\n\tprotected _next_renderer_asset: WebGLRendererAsset | null = null;\n\tprotected _shader = new THREE.RawShaderMaterial({\n\t\tside: THREE.DoubleSide,\n\t\ttransparent: true,\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\tuniforms: {\n\t\t\tmap1: { value: this._empty_texture },\n\t\t\tmap2: { value: this._empty_texture },\n\t\t\tdisplacement: { value: this._empty_texture },\n\t\t\tpct: { value: this._transition_percent }\n\t\t},\n\t\tvertexShader: WebGLRenderer.vertexShader,\n\t\tfragmentShader: WebGLRenderer.fragmentShader,\n\t\tglslVersion: THREE.GLSL3,\n\t});\n\tprotected _map1_renderer_asset: WebGLRendererAsset | null = null;\n\tprotected _map2_renderer_asset: WebGLRendererAsset | null = null;\n\tprotected _renderer_asset_cache: Map<string, WebGLRendererAsset> = new Map();\n\tprotected _renderer_asset_trash: Map<string, WebGLRendererAsset> = new Map();\n\tprotected _set_state_hook: any;\n\tprotected _asset_prefetch: Prefetch;\n\t// Per HTMLMediaElement.\n\tprotected _ended = false;\n\tprotected _error = null;\n\tprotected _networkState: number = HTMLMediaElement.NETWORK_EMPTY;\n\tprotected _paused = true;\n\tprotected _readyState: number = HTMLMediaElement.HAVE_NOTHING;\n\n\tprotected _debug = document.createElement('div');\n\n\tconstructor(prefetchFactory: { new(): Prefetch }) {\n\t\tsuper();\n\t\tthis._asset_prefetch = new prefetchFactory();\n\t\tif(DEBUG_SHOW_DETAIL) {\n\t\t\tthis._debug.className = 'debug';\n\t\t\tdocument.body.appendChild(this._debug);\n\t\t}\n\t}\n\n\tget ended() { return this._ended; }\n\tget error() { return this._error; }\n\tget networkState() { return this._networkState; }\n\tget paused() { return this._paused; }\n\tget readyState() { return this._readyState; }\n\n\t// Called after placement in DOM.\n\tinit() {\n\t\tconsole.groupCollapsed(\"WEBGL-RENDERER: init\");\n\t\tthis._initThreeJSRenderer();\n\t\tconst mesh = this._createMesh(this._shader, this._empty_texture);\n\t\tthis._scene.add(mesh);\n\t\tif(typeof this._renderer === \"undefined\") {\n\t\t\tthrow new Error(\"undefined renderer.\");\n\t\t}\n\t\tthis._asset_manager.setRenderer(this._renderer);\n\t\tconsole.groupEnd();\n\t}\n\n\tclose() {\n\t\tconsole.log(\"WEBGL-RENDERER: close\");\n\t\tfor(const asset of this._renderer_asset_cache.values()) {\n\t\t\tasset.pause();\n\t\t\tasset.close();\n\t\t}\n\t\tthis._renderer_asset_cache.clear();\n\t}\n\n\tsetSetStateHook(cb: any): void {\n\t\tthis._set_state_hook = cb;\n\t}\n\n\tclearSetStateHook(): void {\n\t\tthis._set_state_hook = undefined;\n\t}\n\n\tsetSchedulerMessagePort(scheduler: MessagePort): void {\n\t\tconsole.log(\"WEBGL-RENDERER: setSchedulerMessagePort\", scheduler);\n\t\tComlink.expose({\n\t\t\tsetState: (value: SchedulerState) => this.setState(value),\n\t\t\tsetSources: async (scope: string, decls: MediaDecl[]) => {\n\t\t\t\treturn await this.setSources(scope, decls.map(decl => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'@type': decl['@type'],\n\t\t\t\t\t\tid: decl.id,\n\t\t\t\t\t\thref: decl.href,\n\t\t\t\t\t\tsize: decl.size,\n\t\t\t\t\t\thash: decl.hash,\n\t\t\t\t\t\tmd5: decl.md5,\n\t\t\t\t\t\tintegrity: decl.integrity,\n\t\t\t\t\t} as AssetDecl;\n\t\t\t\t}));\n\t\t\t},\n\t\t}, scheduler);\n\t}\n\n\t// Called by Scheduler or via Cluster as a follower.  This API receives\n\t// the near and immediate scheduling state to render the current and\n\t// next media asset, including the transition between the two.\n\tasync setState(value: SchedulerState): Promise<void> {\n\t\t// In a cluster we need to forward the state to all nodes\n\t\t// before we can process.\n\t\tif(typeof this._set_state_hook !== \"undefined\") {\n\t\t\tthis._set_state_hook(value);\n\t\t\treturn;\n\t\t}\n\t\tawait this.setStateUnhooked(value);\n\t}\n\n\tprotected _lastDebug = \"\";\n\tasync setStateUnhooked(value: SchedulerState): Promise<void> {\n\t\tif(DEBUG_SHOW_DETAIL) {\n\t\t\tconst html = prettyPrint(minimize(value));\n\t\t\tif(html !== this._lastDebug) {\n\t\t\t\tthis._debug.innerHTML = this._lastDebug = html;\n\t\t\t}\n\t\t}\n\t\tawait this._onSchedulerCurrent(value.mediaCurrent);\n\t\tthis._onSchedulerNext(value.mediaNext);\n\t\tawait this._onSchedulerTransition(value.transition);\n\t}\n\n\tsetAssetTarget(assetTarget: HTMLElement): void {\n\t\tconsole.log(\"WEBGL-RENDERER: setAssetTarget\", assetTarget);\n\t\tthis._asset_manager.setAssetTarget(assetTarget);\n\t}\n\n\tsetRenderTarget(renderTarget: HTMLElement): void {\n\t\tconsole.log(\"WEBGL-RENDERER: setRenderTarget\", renderTarget);\n\t\tif(typeof this._renderer === \"undefined\") {\n\t\t\tthrow new Error(\"ThreeJS renderer not defined.\");\n\t\t}\n\t\trenderTarget.appendChild(this._renderer.domElement);\n\t}\n\n\tsetPixelRatio(value: number): void {\n\t\tconsole.log(\"WEBGL-RENDERER: setPixelRatio\", value);\n\t\tif(typeof this._renderer === \"undefined\") {\n\t\t\tthrow new Error(\"ThreeJS renderer not defined.\");\n\t\t}\n\t\tthis._renderer.setPixelRatio(value);\n\t}\n\n\tsetSize(width: number, height: number): void {\n\t\tconsole.log(\"WEBGL-RENDERER: setSize\", width, height);\n\t\tif(typeof this._renderer === \"undefined\") {\n\t\t\tthrow new Error(\"ThreeJS renderer not defined.\");\n\t\t}\n\t\tthis._renderer.setSize(width, height);\n\t\tconst near = 0.1;\n\t\tconst far = 10000;\n\t\tconst z = 2000;\n\t\tthis._camera = this._createThreeJSCamera(width, height, near, far, z);\n\t}\n\n\tsetViews(views: View[]): void {\n\t\tconsole.log(\"WEBGL-RENDERER: setViews\", views);\n\t\tthis._views = views;\n\t}\n\n\tasync setSources(scope: string, sources: AssetDecl[]): Promise<void> {\n\t\tconsole.log(\"WEBGL-RENDERER: setSources\", scope, sources);\n\t\tawait this._asset_prefetch.acquireSources(scope, sources);\n\t}\n\n\tprotected _createMesh(material: THREE.Material, displacement_texture: THREE.Texture): THREE.Mesh {\n\t\tconsole.log(\"WEBGL-RENDERER: _createMesh\", material, displacement_texture);\n\t\t// FIXME: Tied to image resolution.\n\t\tconst media_width = 1000;\n\t\tconst media_height = 1000;\n\t\tconst mesh = this._meshFrom(\n\t\t\tmaterial,\n\t\t\t0, media_width,\n\t\t\t0, media_height,\n\t\t\tmedia_width, media_height\n\t\t);\n\t\tthis._shader.uniforms.displacement.value = displacement_texture;\n\t\tconsole.log('WEBGL-RENDERER: Created new mesh', mesh);\n\t\treturn mesh;\n\t}\n\n\tprotected _initTexture(texture: THREE.Texture | undefined): void {\n\t\tconsole.log(\"WEBGL-RENDERER: _initTexture\", texture);\n\t\tif(texture instanceof THREE.Texture) {\n\t\t\t// Force GPU upload.\n\t\t\tthis._renderer?.initTexture(texture);\n\t\t}\n\t}\n\n\tprotected _isEmptyTexture(texture: THREE.Texture): boolean {\n\t\treturn texture.uuid === this._empty_texture.uuid;\n\t}\n\n\t// on requestAnimationFrame() callback.\n\tprotected _previousTimestamp = 0;\n\trender(timestamp: DOMHighResTimeStamp): void {\n//\t\tconsole.log('update', timestamp);\n\t\tconst elapsed = timestamp - this._previousTimestamp;\n\t\tthis._previousTimestamp = timestamp;\n\t\tif(typeof this._renderer === \"undefined\") {\n\t\t\tthrow new Error(\"ThreeJS renderer not defined.\");\n\t\t}\n\t\tif(typeof this._camera === \"undefined\") {\n\t\t\tthrow new Error(\"ThreeJS camera not defined.\");\n\t\t}\n\t\tif(this._canPaintCurrent()) {\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"current asset is null.\");\n\t\t\t}\n\t\t\tconst remaining = this._current_renderer_asset.end_time - timestamp;\n\t\t\ttry {\n\t\t\t\tthis._paintCurrent(timestamp, remaining);\n\t\t\t} catch(ex) {\n\t\t\t\tconsole.error(ex);\n\t\t\t\tconsole.error(this._current_renderer_asset);\n\t\t\t}\n\t\t} else if(this._hasWaitingDuration()) {\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"current asset is null.\");\n\t\t\t}\n\t\t\tconst remaining = this._current_renderer_asset.end_time - timestamp;\n\t\t\tthis._paintWaitingDuration(timestamp, remaining);\n\t\t} else {\n\t\t\tthis._paintWaiting(timestamp);\n\t\t}\n\t\tif(this._canPaintNext()) {\n\t\t\tif(this._next_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"next asset is null.\");\n\t\t\t}\n\t\t\tconst remaining = this._next_renderer_asset.end_time - timestamp;\n\t\t\ttry {\n\t\t\t\tthis._paintNext(timestamp, remaining);\n\t\t\t} catch(ex) {\n\t\t\t\tconsole.error(ex);\n\t\t\t\tconsole.error(this._next_renderer_asset);\n\t\t\t}\n\t\t}\n\t\tthis._interpolateTransition(elapsed);\n\t\tthis._renderer.setScissorTest(true);\n\t\tconst size = this._renderer.getSize(new THREE.Vector2());\n\t\tfor(const view of this._views) {\n\t\t\tthis._renderer.setViewport(view.x, view.y, view.width, view.height);\n\t\t\tthis._renderer.setScissor(view.x, view.y, view.width, view.height);\n\t\t\tthis._camera.setViewOffset(size.width, size.height,\n\t\t\t\tview.left, view.top, view.width, view.height);\n\t\t\tthis._renderer.render(this._scene, this._camera);\n\t\t}\n\t\tthis._renderer.setScissorTest(false);\n\t}\n\n\t// on requestIdleCallback() callback.\n\tidle(): void {\n\t\tthis._emptyAssetTrash();\n\t}\n\n\tprotected _setTransitionPercent(\n\t\tpercent: number,\n\t): void {\n\t\tthis._shader.uniforms.pct.value = this._transition_percent = percent;\n\t}\n\n\tprotected _interpolateTransition(elapsed: number): void {\n\t\tlet needs_update = false;\n\t\tif(this._transition_percent_speed !== 0) {\n\t\t\tthis._transition_percent += (this._transition_percent_speed * elapsed) / 1000;\n\t\t\tif(this._transition_percent > 1) {\n\t\t\t\tthis._transition_percent = 1;\n\t\t\t\tthis._transition_percent_speed = 0;\n\t\t\t}\n\t\t\tthis._setTransitionPercent(this._transition_percent);\n\t\t\tneeds_update = true;\n\t\t}\n\t\tif(needs_update) {\n\t\t\tthis._shader.uniformsNeedUpdate = true;\n\t\t}\n\t}\n\n\tprotected _initThreeJSRenderer() {\n\t\tconsole.log(\"WEBGL-RENDERER: _initThreeJSRenderer\");\n\t\tthis._renderer = this._createThreeJSRenderer();\n\t}\n\n\tprotected _createThreeJSRenderer() {\n\t\tconsole.log(\"WEBGL-RENDERER: _createThreeJSRenderer\");\n\t\tconst canvas = document.createElement('canvas');\n\t\tconst context = canvas.getContext(\"webgl2\", {\n\t\t\talpha: true,\n\t\t\tantialias: true,  // Significant performance cost with WebGLRenderTarget.\n\t\t\tdesynchronized: false,\n\t\t\tpowerPreference: 'high-performance',\n\t\t});\n\t\tif(context === null) {\n\t\t\tthrow new Error('Failed to obtain canvas context.');\n\t\t}\n\t\tconst renderer = new THREE.WebGLRenderer({ canvas, context });\n\t\treturn renderer;\n\t}\n\n\tprotected _createThreeJSCamera(width: number, height: number, near: number, far: number, z: number): THREE.OrthographicCamera {\n\t\tconsole.log(\"WEBGL-RENDERER: _createThreeJSCamera\", width, height, near, far, z);\n\t\tconst camera = new THREE.OrthographicCamera(\n\t\t\twidth / -2, width / 2,\n\t\t\theight / 2, height / -2, near, far\n\t\t);\n\t\tcamera.position.z = z;\n\t\treturn camera;\n\t}\n\n\tprotected async _fetchImage(url: string): Promise<HTMLImageElement> {\n\t\tconsole.log(\"WEBGL-RENDERER: _fetchImage\", url);\n\t\tconst img = await new Promise<HTMLImageElement>((resolve, reject) => {\n\t\t\tconst img = new Image();\n\t\t\timg.src = url;\n\t\t\timg.decode()\n\t\t\t.then(() => {\n\t\t\t\tresolve(img);\n\t\t\t})\n\t\t\t.catch(encodingError => {\n\t\t\t\treject(encodingError);\n\t\t\t});\n\t\t});\nconsole.info(\"WEBGL-RENDERER: loaded displacement map\", img.src);\n\t\treturn img;\n\t}\n\n//\tprotected _onSchedulerError(err: Error): void {\n//\t\tconsole.error(err);\n//\t}\n\n\t// This media asset.\n\tprotected async _onSchedulerCurrent(current: SchedulerAssetDeclWithRemainingTime | null): Promise<void> {\n\t\tif(current !== null) {\n\t\t\tif(!this._isMediaReady(current.decl)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this._current_renderer_asset === null)\n\t\t\t{\n//console.info(current.decl.href, current.remainingTimeMs);\n\t\t\t\tthis._current_renderer_asset = await this._updateCurrent(current.decl);\n\t\t\t\tthis._current_renderer_asset.end_time = (typeof current.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(current.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._current_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEBGL-RENDERER: current\", this._current_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(current.decl.id !== this._current_renderer_asset.id)\n\t\t\t{\n//console.info(current.decl.href, current.remainingTimeMs);\n\t\t\t\tthis._closeCurrent();\n\t\t\t\tif(this._next_renderer_asset !== null\n\t\t\t\t\t&& current.decl.id === this._next_renderer_asset.id)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(\"WEBGL-RENDERER: current <- next\");\n\t\t\t\t\tthis._current_renderer_asset = await this._updateCurrentFromNext();\n\t\t\t\t} else {\n\t\t\t\t\tthis._current_renderer_asset = await this._updateCurrent(current.decl);\n\t\t\t\t}\n\t\t\t\tthis._current_renderer_asset.end_time = (typeof current.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(current.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._current_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEBGL-RENDERER: current\", this._current_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(this._current_renderer_asset !== null)\n\t\t\t{\n\t\t\t\tthis._current_renderer_asset = await this._updateCurrent(current.decl);\n\t\t\t\tthis._current_renderer_asset.end_time = (typeof current.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(current.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t}\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"current asset is null.\");\n\t\t\t}\n\t\t} else if(this._current_renderer_asset !== null) {\n\t\t\tthis._closeCurrent();\n\t\t\tconsole.log(`WEBGL-RENDERER: current null`);\n\t\t}\n\t}\n\n\tprotected _onSchedulerNext(next: SchedulerAssetDeclWithRemainingTime | null): void {\n\t\t// Next media asset.\n\t\tif(next !== null) {\n\t\t\tif(!this._isMediaReady(next.decl)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this._next_renderer_asset === null) {\n\t\t\t\tthis._next_renderer_asset = this._updateNext(next.decl);\n\t\t\t\tthis._next_renderer_asset.end_time = (typeof next.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(next.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._next_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEBGL-RENDERER: next\", this._next_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(next.decl.id !== this._next_renderer_asset.id) {\n\t\t\t\tthis._closeNext();\n\t\t\t\tthis._next_renderer_asset = this._updateNext(next.decl);\n\t\t\t\tthis._next_renderer_asset.end_time = (typeof next.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(next.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t\tthis._next_renderer_asset.ref();\n\t\t\t\tconsole.log(\"WEBGL-RENDERER: next\", this._next_renderer_asset.currentSrc);\n\t\t\t}\n\t\t\telse if(this._next_renderer_asset !== null)\n\t\t\t{\n\t\t\t\tthis._next_renderer_asset = this._updateNext(next.decl);\n\t\t\t\tthis._next_renderer_asset.end_time = (typeof next.remainingTimeMs === \"number\") ?\n\t\t\t\t\t(next.remainingTimeMs + performance.now()) : Number.MAX_SAFE_INTEGER;\n\t\t\t}\n\t\t\tif(this._next_renderer_asset === null) {\n\t\t\t\tthrow new Error(\"next asset is null.\");\n\t\t\t}\n\t\t} else if(this._next_renderer_asset !== null) {\n\t\t\tthis._closeNext();\n\t\t\tconsole.log(`WEBGL-RENDERER: next null`);\n\t\t}\n\t}\n\n\tprotected async _onSchedulerTransition(transition: SchedulerAssetTransition | null): Promise<void> {\n\t\t// Resources for transitions, explicitly details textures to\n\t\t// avoid confusion when crossing boundary between two assets.\n\t\tlet needs_update = false;\n\t\tif(transition !== null) {\n\t\t\tconst from_asset = this._renderer_asset_cache.get(transition.from.decl.id);\n\t\t\tif(typeof from_asset !== \"undefined\"\n\t\t\t\t&& from_asset.texture !== null\n\t\t\t\t&& from_asset.texture.uuid !== this._map1_renderer_asset?.texture?.uuid)\n\t\t\t{\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tthis._shader.uniforms.map1.value = from_asset.texture;\n//\t\t\t\tconsole.log('set map1', transition.from.decl.href);\n\t\t\t\tfrom_asset.ref();\n\t\t\t\tthis._setMap1Asset(from_asset);\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tconst to_asset = this._renderer_asset_cache.get(transition.to.decl.id);\n\t\t\tif(typeof to_asset !== \"undefined\"\n\t\t\t\t&& to_asset.texture !== null\n\t\t\t\t&& to_asset.texture.uuid !== this._map2_renderer_asset?.texture?.uuid)\n\t\t\t{\n\t\t\t\tif(this._map2_renderer_asset instanceof WebGLRendererAsset) {\n\t\t\t\t\tthis._map2_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tthis._shader.uniforms.map2.value = to_asset.texture;\n//\t\t\t\tconsole.log('set map2', transition.to.decl.href);\n\t\t\t\tto_asset.ref();\n\t\t\t\tthis._setMap2Asset(to_asset);\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tif(transition.url !== this._displacement_url) {\n\t\t\t\tthis._displacement_url = transition.url;\n//\t\t\t\tconsole.log('set displacement', this.#displacement_url);\n\t\t\t\tawait this._updateDisplacementMap(transition.url);\n\t\t\t\tthis._shader.uniforms.displacement.value = this._displacement_texture;\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tif(transition.percent !== this._transition_percent) {\n\t\t\t\tthis._setTransitionPercent(transition.percent);\n//\t\t\t\tconsole.log('set pct', transition.percent);\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tif(transition.percentSpeed !== this._transition_percent_speed) {\n\t\t\t\tthis._transition_percent_speed = transition.percentSpeed;\n\t\t\t}\n\t\t} else {  // Transition finished, follow settings per \"current\".\n\t\t\tif(this._current_renderer_asset === null) {\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t\tthis._setMap1Asset(null);\n\t\t\t\t\tneeds_update = true;\n\t\t\t\t}\n\t\t\t} else if(this._current_renderer_asset.texture !== null\n\t\t\t\t&& this._current_renderer_asset.texture.uuid !== this._map1_renderer_asset?.texture?.uuid)\n\t\t\t{\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tthis._shader.uniforms.map1.value = this._current_renderer_asset.texture;\n//\t\t\t\tconsole.log('set map1', this.#current_asset.currentSrc);\n\t\t\t\tthis._current_renderer_asset.ref();\n\t\t\t\tthis._setMap1Asset(this._current_renderer_asset);\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tif(this._map2_renderer_asset !== null) {\n\t\t\t\tthis._map2_renderer_asset.unref();\n\t\t\t\tthis._setMap2Asset(null);\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tif(this._transition_percent !== 0) {\n\t\t\t\tthis._setTransitionPercent(0);\n\t\t\t\tneeds_update = true;\n\t\t\t}\n\t\t\tif(this._transition_percent_speed !== 0) {\n\t\t\t\tthis._transition_percent_speed = 0;\n\t\t\t}\n\t\t}\n\t\tif(needs_update) {\n\t\t\tthis._shader.uniformsNeedUpdate = true;\n\t\t}\n\t}\n\n\tprotected _networkLoadingRef(): void {\n\t\tif(this._network_loading_count === 0) {\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_LOADING;\n\t\t}\n\t\tthis._network_loading_count++;\n\t}\n\n\tprotected _networkLoadingUnref(): void {\n\t\tthis._network_loading_count--;\n\t\tif(this._network_loading_count === 0) {\n\t\t\tthis._networkState = HTMLMediaElement.NETWORK_IDLE;\n\t\t}\n\t}\n\n\tprotected _emptyAssetTrash(): void {\n\t\tconst remove_list: string[] = [];\n\t\tfor(const [id, asset] of this._renderer_asset_trash) {\n\t\t\tif(asset.ref_count !== 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tasset.close();\n\t\t\tremove_list.push(id);\n\t\t}\n\t\tfor(const id of remove_list) {\n\t\t\tconsole.log(\"WEBGL-RENDERER: Destroying\", id)\n\t\t\tthis._renderer_asset_cache.delete(id);\n\t\t\tthis._renderer_asset_trash.delete(id);\n\t\t}\n\t}\n\n\tprotected _setMap1Asset(asset: WebGLRendererAsset | null): void {\n\t\tthis._map1_renderer_asset = asset;\n\t\tthis._shader.uniforms.map1.value = !!asset ? asset.texture : this._empty_texture;\n\t}\n\n\tprotected _setMap2Asset(asset: WebGLRendererAsset | null): void {\n\t\tthis._map2_renderer_asset = asset;\n\t\tthis._shader.uniforms.map2.value = !!asset ? asset.texture : this._empty_texture;\n\t}\n\n\t// Assumes new decl.\n\tprotected async _updateCurrent(decl: MediaDecl): Promise<WebGLRendererAsset> {\n\t\tconst asset = this._resolveMediaAsset(decl);\n\t\tif(!asset.has_texture\n\t\t\t&& asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)\n\t\t{\n\t\t\tthis._initTexture(asset.texture!);\n\t\t\tasset.has_texture = true;\n\t\t\tawait asset.play();\n\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t}\n\t\t\tif(this._map2_renderer_asset !== null) {\n\t\t\t\tthis._map2_renderer_asset.unref();\n\t\t\t}\n\t\t\tasset.ref();\n\t\t\tthis._setMap1Asset(asset);\n\t\t\tthis._setMap2Asset(null);\n\t\t\tthis._setTransitionPercent(0);\n\t\t\tthis._shader.uniformsNeedUpdate = true;\n\t\t\tthis._readyState = HTMLMediaElement.HAVE_CURRENT_DATA;\n\t\t}\n\t\treturn asset;\n\t}\n\n\t// Keep reference next to current.\n\tprotected async _updateCurrentFromNext(): Promise<WebGLRendererAsset> {\n\t\tif(this._current_renderer_asset !== null) {\n\t\t\tthrow new Error(\"current asset must be closed before calling.\");\n\t\t}\n\t\tif(this._next_renderer_asset === null) {\n\t\t\tthrow new Error(\"next asset must be defined before calling.\");\n\t\t}\n\t\tconst asset = this._next_renderer_asset;\n\t\tthis._next_renderer_asset = null;\n\t\tif(asset !== null\n\t\t\t&& asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)\n\t\t{\n\t\t\tawait asset.play();\n\t\t\tif(this._map2_renderer_asset === null) {\n\t\t\t\tif(this._map1_renderer_asset !== null) {\n\t\t\t\t\tthis._map1_renderer_asset.unref();\n\t\t\t\t}\n\t\t\t\tthis._setMap1Asset(asset);\n\t\t\t\tthis._setTransitionPercent(0);\n\t\t\t\tthis._shader.uniformsNeedUpdate = true;\n\t\t\t}\n\t\t\tthis._readyState = HTMLMediaElement.HAVE_CURRENT_DATA;\n\t\t} else {\n\t\t\tconsole.warn(\"WEBGL-RENDERER: current asset not ready.\");\n\t\t\tthis._readyState = HTMLMediaElement.HAVE_METADATA;\n\t\t}\n\t\treturn asset;\n\t}\n\n\tprotected _canPaintCurrent(): boolean {\n\t\treturn this._current_renderer_asset !== null\n\t\t\t&& this._current_renderer_asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA;\n\t}\n\n\tprotected _paintCurrent(timestamp: DOMHighResTimeStamp, remaining: number): void {\n\t\tif(this._current_renderer_asset === null) {\n\t\t\tthrow new Error(\"undefined current asset.\");\n\t\t}\n\t\tthis._current_renderer_asset.paint(timestamp, remaining);\n\t\t// Very slow loading asset, force playback, avoid seeking as already broken.\n//\t\tif(this.#current_asset.paused) {\n//\t\t\t(async() => {\n//\t\t\t\tif(this.#current_asset !== null\n//\t\t\t\t\t&& this.#current_asset.paused\n//\t\t\t\t\t&& !this.#current_asset.ended\n//\t\t\t\t\t&& this.#current_asset.readyState >= HTMLMediaElement.HAVE_FUTURE_DATA)\n//\t\t\t\t{\n//\t\t\t\t\tawait this.#current_asset.play();\n//\t\t\t\t}\n//\t\t\t})();\n//\t\t}\n\t}\n\n\tprotected _closeCurrent(): void {\n\t\tif(this._current_renderer_asset === null) {\n\t\t\treturn;\n\t\t}\n\t\tthis._current_renderer_asset.pause();\n\t\tthis._current_renderer_asset.unref();\n\t\tthis._renderer_asset_trash.set(this._current_renderer_asset.id, this._current_renderer_asset);\n\t\tthis._current_renderer_asset = null;\n\t}\n\n\tprotected _hasWaitingDuration(): boolean {\n\t\treturn false;\n\t}\n\n\tprotected _paintWaiting(_timestamp: DOMHighResTimeStamp): void {}\n\t_paintWaitingDuration(_timestamp: DOMHighResTimeStamp, _remaining: number): void {}\n\n\tprotected _updateNext(decl: MediaDecl): WebGLRendererAsset {\n\t\tconst asset = this._resolveMediaAsset(decl);\n\t\tif(!asset.has_texture\n\t\t\t&& asset.readyState >= HTMLMediaElement.HAVE_FUTURE_DATA)\n\t\t{\n\t\t\tthis._initTexture(asset.texture!);\n\t\t\tasset.has_texture = true;\n\t\t\tif(this.readyState < HTMLMediaElement.HAVE_FUTURE_DATA) {\n\t\t\t\tthis._readyState = HTMLMediaElement.HAVE_FUTURE_DATA;\n\t\t\t}\n\t\t}\n\t\treturn asset;\n\t}\n\n\tprotected _isMediaReady(decl: MediaDecl): boolean {\n\t\tconst path = this._asset_prefetch.getCachedPath(decl.href);\n\t\treturn path !== null;\n\t}\n\n\tprotected _resolveMediaAsset(decl: MediaDecl): WebGLRendererAsset {\n\t\tconst existing_asset = this._renderer_asset_cache.get(decl.id);\n\t\tif(typeof existing_asset !== \"undefined\") {\n\t\t\tif(this._renderer_asset_trash.has(decl.id)) {\n\t\t\t\tthis._renderer_asset_trash.delete(decl.id);\n\t\t\t}\n\t\t\tif(existing_asset.is_loading\n\t\t\t\t&& existing_asset.readyState === HTMLMediaElement.HAVE_ENOUGH_DATA)\n\t\t\t{\n\t\t\t\tthis._networkLoadingUnref();\n\t\t\t\texisting_asset.is_loading = false;\n\t\t\t}\n\t\t\treturn existing_asset;\n\t\t}\n\t\tconst cached_path = this._asset_prefetch.getCachedPath(decl.href);\n\t\tif(cached_path === null) {\n\t\t\tthrow new Error(`Media asset not cached: ${decl.href}`);\n\t\t}\n\t\tconst resolved_decl: MediaDecl = {\n\t\t\t...decl,\n\t\t\thref: cached_path,\n\t\t};\n\t\tconst three_asset = this._asset_manager.createThreeAsset(resolved_decl);\n\t\tconst renderer_asset = new WebGLRendererAsset(decl.id, three_asset);\n\t\tthis._renderer_asset_cache.set(renderer_asset.id, renderer_asset);\n\t\tthis._networkLoadingRef();\n\t\trenderer_asset.is_loading = true;\n\t\trenderer_asset.load();\n\t\treturn renderer_asset;\n\t}\n\n\tprotected _canPaintNext(): boolean {\n\t\treturn this._next_renderer_asset !== null\n\t\t\t&& this._next_renderer_asset.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA;\n\t}\n\n\tprotected _paintNext(timestamp: DOMHighResTimeStamp, remaining: number): void {\n\t\tif(this._next_renderer_asset === null) {\n\t\t\tthrow new Error(\"undefined next asset.\");\n\t\t}\n\t\tthis._next_renderer_asset.paint(timestamp, remaining);\n\t}\n\n\tprotected _closeNext(): void {\n\t\tif(this._next_renderer_asset === null) {\n\t\t\tthrow new Error(\"undefined next asset.\");\n\t\t}\n\t\tthis._next_renderer_asset.unref();\n\t\tthis._renderer_asset_trash.set(this._next_renderer_asset.id, this._next_renderer_asset);\n\t\tthis._next_renderer_asset = null;\n\t}\n\n\t// Assumes new URL.\n\tprotected async _updateDisplacementMap(url: string): Promise<void> {\n\t\tthis._networkLoadingRef();\n\t\tconst img = await this._fetchImage(url);\n\t\tthis._displacement_texture.image = img;\n\t\tthis._displacement_texture.needsUpdate = true;\n\t\tthis._initTexture(this._displacement_texture);\n\t\tthis._networkLoadingUnref();\n\t}\n\n\tprotected _meshFrom(material: THREE.Material, left: number, right: number, top: number, bottom: number, width: number, height: number): THREE.Mesh {\n\t\tconst geometry = new THREE.PlaneGeometry(1, 1, 1, 1);\n\t\tgeometry.setAttribute(\"uv\", new THREE.BufferAttribute(new Float32Array([\n\t\t\tleft/width, 1-(top/height),\n\t\t\tright/width, 1-(top/height),\n\t\t\tleft/width, 1-(bottom/height),\n\t\t\tright/width, 1-(bottom/height),\n\t\t\t0, 0,\n\t\t\t0, 0\n\t\t]), 2));\n\t\tconst mesh = new THREE.Mesh(geometry, material);\n\t\tmesh.scale.set(width, height, 1);\n\t\treturn mesh;\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport { css } from 'lit';\nimport { customElement } from 'lit/decorators.js';\nimport { Renderer } from '../lib/renderer.js';\nimport { WebGLRenderer } from '../lib/webgl-renderer.js';\nimport { WebPlaylistElement } from './web-play-list.js';\nimport { Prefetch } from '../lib/prefetch.js';\nimport { ServiceWorkerPrefetch } from '../lib/service-worker-prefetch.js';\n\n// Convenience configuration to disable HiDPI rendering, which can be slow on\n// some platforms, or produce artifacts on low resolution content.\nconst DEBUG_DISABLE_HIDPI = false;\n\n@customElement('webgl-play-list')\nexport class WebGLPlaylistElement extends WebPlaylistElement {\n\n\tstatic override styles = css`\n\t\t:host {\n\t\t\tdisplay: block;\n\t\t\tcontain: strict;\n\t\t\toverflow: clip;\n\t\t\tfont-size: 0;\n\t\t}\n\t\t:host > section {\n\t\t\tdisplay: none;\n\t\t}\n\t\t:host > main {\n\t\t\tposition: relative;\n\t\t\tmargin-left: 600px;\n\t\t}\n\t\t:host > main > * {\n\t\t\tdisplay: block;\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t}\n\t`;\n\n\t// Override the renderer to use WebGL.\n\tprotected override _createRenderer(\n\t\tprefetchFactory: { new(): Prefetch } = ServiceWorkerPrefetch,\n\t): Renderer {\n\t\tif(this._section === null) {\n\t\t\tthrow new Error(\"cannot find <section> element to attach to.\");\n\t\t}\n\t\tif(this._main === null) {\n\t\t\tthrow new Error(\"cannot find <main> element to attach to.\");\n\t\t}\n\n\t\tconst renderer = new WebGLRenderer(prefetchFactory);\n\t\trenderer.init();\n\n\t\tthis._connectSchedulerToRenderer(this._scheduler, renderer);\n\t\tthis._connectRaftCluster(this._scheduler, renderer);\n\n\t\trenderer.setAssetTarget(this._section);\n\t\trenderer.setRenderTarget(this._main);\n\n\t\t// Override for performance testing.\n\t\trenderer.setPixelRatio(DEBUG_DISABLE_HIDPI ? 1 : window.devicePixelRatio);\n\n\t\treturn renderer;\n\t}\n}\n","// vim: tabstop=8 softtabstop=0 noexpandtab shiftwidth=8 nosmarttab\n// Copyright 2025 Digital Signage Bunny Corp. Use of this source code is\n// governed by an MIT-style license that can be found in the LICENSE file or at\n// https://opensource.org/licenses/MIT.\n\nimport { customElement } from 'lit/decorators.js';\nimport { Renderer } from '../lib/renderer.js';\nimport { WebGLPlaylistElement } from './webgl-play-list.js';\nimport { BrightSignPrefetch } from '../lib/brightsign-prefetch.js';\n\n@customElement('brightsign-webgl-play-list')\nexport class BrightSignWebGLPlaylistElement extends WebGLPlaylistElement {\n\n\t// Override the renderer to use BrightSign compatible asset prefetcher.\n\tprotected override _createRenderer(): Renderer {\n\t\treturn super._createRenderer(BrightSignPrefetch);\n\t}\n}\n"],"names":["customElement","tagName","classOrTarget","context","undefined","addInitializer","customElements","define","global","globalThis","supportsAdoptingStyleSheets","ShadowRoot","ShadyCSS","nativeShadow","Document","prototype","CSSStyleSheet","constructionToken","Symbol","cssTagCache","WeakMap","CSSResult","constructor","cssText","strings","safeToken","this","Error","_strings","styleSheet","_styleSheet","cacheable","length","get","replaceSync","set","toString","unsafeCSS","value","String","adoptStyles","renderRoot","styles","adoptedStyleSheets","map","s","style","document","createElement","nonce","setAttribute","textContent","appendChild","getCompatibleStyle","sheet","rule","cssRules","cssResultFromStyleSheet","is","defineProperty","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","Object","trustedTypes","emptyStringForBooleanAttribute","emptyScript","polyfillSupport","reactiveElementPolyfillSupport","JSCompiler_renameProperty","prop","_obj","defaultConverter","toAttribute","type","Boolean","Array","JSON","stringify","fromAttribute","fromValue","Number","parse","e","notEqual","old","defaultPropertyDeclaration","attribute","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","ReactiveElement","HTMLElement","initializer","__prepare","_initializers","push","observedAttributes","finalize","__attributeToPropertyMap","keys","createProperty","name","options","state","hasOwnProperty","create","wrapped","elementProperties","noAccessor","key","descriptor","getPropertyDescriptor","v","oldValue","call","requestUpdate","configurable","enumerable","getPropertyOptions","superCtor","Map","finalized","props","properties","propKeys","p","attr","__attributeNameForProperty","elementStyles","finalizeStyles","isArray","Set","flat","Infinity","reverse","unshift","toLowerCase","super","__instanceProperties","isUpdatePending","hasUpdated","__reflectingProperty","__initialize","__updatePromise","Promise","res","enableUpdating","_$changedProperties","__saveInstanceProperties","forEach","i","addController","controller","__controllers","add","isConnected","hostConnected","removeController","delete","instanceProperties","size","createRenderRoot","shadowRoot","attachShadow","shadowRootOptions","connectedCallback","c","_requestedUpdate","disconnectedCallback","hostDisconnected","attributeChangedCallback","_old","_$attributeToProperty","__propertyToAttribute","attrValue","removeAttribute","ctor","propName","__defaultValues","newValue","hasAttribute","_$changeProperty","__enqueueUpdate","initializeValue","has","__reflectingProperties","reject","result","scheduleUpdate","performUpdate","shouldUpdate","changedProperties","willUpdate","hostUpdate","update","__markUpdated","_$didUpdate","_changedProperties","hostUpdated","firstUpdated","updated","updateComplete","getUpdateComplete","mode","reactiveElementVersions","standardProperty","target","kind","init","property","protoOrTarget","nameOrContext","proto","desc","obj","Reflect","query","selector","cache","doQuery","el","querySelector","self","EventTarget","replacer","prettyPrint","minimize","Comlink.expose","msgpack.encode","msgpack.decode","Comlink.wrap","Comlink.releaseProxy","Comlink.transfer","Comlink.proxy","__decorate"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,9,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,31]}